# å‚æ•°çˆ†ç ´é—®é¢˜è§£å†³æ–¹æ¡ˆ

## ğŸ” é—®é¢˜è¯Šæ–­

### å‘ç°çš„é—®é¢˜

ä»æ‚¨çš„çˆ¬å–æ—¥å¿—ä¸­å‘ç°äº†ä¸¥é‡çš„**å‚æ•°ç»„åˆçˆ†ç‚¸**é—®é¢˜ï¼š

```
ä¸ºURL https://xss-quiz.int21h.jp/?limit=..%2F ç”Ÿæˆ 37 ä¸ªå‚æ•°å˜ä½“
ä¸ºURL https://xss-quiz.int21h.jp/?offset%5B0%5D=1 ç”Ÿæˆ 37 ä¸ªå‚æ•°å˜ä½“
ä¸ºURL https://xss-quiz.int21h.jp/?sort=true ç”Ÿæˆ 37 ä¸ªå‚æ•°å˜ä½“
ä¸ºURL https://xss-quiz.int21h.jp/?search=1 ç”Ÿæˆ 37 ä¸ªå‚æ•°å˜ä½“
...
```

### é—®é¢˜æ ¹æº

```
åŸå§‹URL: https://xss-quiz.int21h.jp/

ç¬¬1å±‚çˆ†ç ´ (1ä¸ªURL)
â”œâ”€ ?id=1
â”œâ”€ ?page=1
â”œâ”€ ?limit=..%2F
â””â”€ ... (å…±37ä¸ªå˜ä½“)

ç¬¬2å±‚çˆ†ç ´ (37ä¸ªURLï¼Œæ¯ä¸ªåˆç”Ÿæˆ37ä¸ª)
â”œâ”€ ?limit=..%2F&id=1
â”œâ”€ ?limit=..%2F&page=1
â”œâ”€ ?limit=..%2F&category=1
â””â”€ ... (å…± 37 Ã— 37 = 1,369ä¸ªå˜ä½“)

ç¬¬3å±‚çˆ†ç ´ (1,369ä¸ªURLï¼Œæ¯ä¸ªåˆç”Ÿæˆ37ä¸ª)
â””â”€ ... (å…± 37 Ã— 37 Ã— 37 = 50,653ä¸ªå˜ä½“)

ç¬¬4å±‚çˆ†ç ´
â””â”€ ... (å…± 37â´ = 1,874,161ä¸ªå˜ä½“) âŒ çˆ†ç‚¸ï¼
```

**ç»“æœ**: URLæ•°é‡æŒ‡æ•°çº§å¢é•¿ï¼Œæ°¸è¿œçˆ¬ä¸å®Œï¼

---

## âœ… è§£å†³æ–¹æ¡ˆï¼šä¿å®ˆæ¨¡å¼é…ç½®

### å·²åˆ›å»ºçš„é…ç½®æ–‡ä»¶

**æ–‡ä»¶å**: `config_conservative.json`

**æ ¸å¿ƒä¼˜åŒ–**:

| é…ç½®é¡¹ | åŸå§‹å€¼ | ä¿å®ˆå€¼ | ä¼˜åŒ– |
|--------|--------|--------|------|
| `param_fuzz_limit` | 100 | **5** | -95% |
| `post_param_fuzz_limit` | 50 | **0** | -100% |
| `similarity_threshold` | 0.85 | **0.95** | +12% |
| `enable_dynamic_crawler` | true | **false** | ç¦ç”¨ |
| `max_depth` | 5 | **3** | -40% |

### URLæ•°é‡å¯¹æ¯”é¢„ä¼°

```
åŸé…ç½® (param_fuzz_limit=100):
æ·±åº¦1: 1ä¸ª
æ·±åº¦2: 37ä¸ª
æ·±åº¦3: 1,369ä¸ª
æ·±åº¦4: 50,653ä¸ª
æ·±åº¦5: 1,874,161ä¸ª âŒ

ä¿å®ˆé…ç½® (param_fuzz_limit=5):
æ·±åº¦1: 1ä¸ª
æ·±åº¦2: 5ä¸ª
æ·±åº¦3: 25ä¸ª
æ·±åº¦4: 125ä¸ª âœ… å¯æ§ï¼
```

**é¢„è®¡å‡å°‘**: > 99.9% çš„æ— æ•ˆURL

---

## ğŸš€ ç«‹å³ä½¿ç”¨

### æ–¹æ³•1: ä½¿ç”¨ä¿å®ˆé…ç½®æ–‡ä»¶

```powershell
# åœæ­¢å½“å‰çˆ¬å–ï¼ˆå¦‚æœè¿˜åœ¨è¿è¡Œï¼‰
Ctrl+C

# ä½¿ç”¨ä¿å®ˆé…ç½®
.\spider.exe -config config_conservative.json
```

### æ–¹æ³•2: å‘½ä»¤è¡Œå‚æ•°ï¼ˆæ— é…ç½®æ–‡ä»¶ï¼‰

```powershell
# å®Œå…¨ç¦ç”¨å‚æ•°çˆ†ç ´
.\spider.exe -url https://xss-quiz.int21h.jp/ `
  -depth 3 `
  -mode static

# æˆ–è€…åªåšåŸºç¡€çˆ¬å–
.\spider.exe -url https://xss-quiz.int21h.jp/ `
  -depth 2 `
  -simple `
  -format urls-only
```

### æ–¹æ³•3: é’ˆå¯¹XSS Quizçš„ä¸“ç”¨é…ç½®

```powershell
# åˆ›å»ºXSS Quizä¸“ç”¨é…ç½®
@"
{
  "target_url": "https://xss-quiz.int21h.jp/",
  "depth_settings": {
    "max_depth": 4,
    "deep_crawling": true,
    "scheduling_algorithm": "BFS"
  },
  "strategy_settings": {
    "enable_static_crawler": true,
    "enable_dynamic_crawler": false,
    "enable_js_analysis": true,
    "enable_api_inference": false,
    "enable_param_fuzzing": false,
    "param_fuzz_limit": 0,
    "enable_post_param_fuzzing": false,
    "post_param_fuzz_limit": 0
  },
  "anti_detection_settings": {
    "request_delay": "500ms",
    "user_agents": ["Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"],
    "proxies": [],
    "enable_form_auto_fill": true
  },
  "deduplication_settings": {
    "similarity_threshold": 0.95,
    "enable_dom_deduplication": true,
    "enable_url_pattern_recognition": true
  },
  "log_settings": {
    "level": "INFO",
    "output_file": "",
    "format": "text",
    "show_metrics": false
  }
}
"@ | Out-File config_xss_quiz.json -Encoding UTF8

# ä½¿ç”¨
.\spider.exe -config config_xss_quiz.json
```

---

## ğŸ“Š æ•ˆæœå¯¹æ¯”

### çˆ¬å–å‰ï¼ˆé—®é¢˜é…ç½®ï¼‰

```
â±ï¸ æ—¶é—´: æ°¸è¿œçˆ¬ä¸å®Œ
ğŸ“Š URLæ•°: æ•°ä¸‡ä¸ªï¼ˆæŒç»­å¢é•¿ï¼‰
ğŸ’¾ è¯·æ±‚æ•°: æ•°åƒä¸ªé‡å¤è¯·æ±‚
âš ï¸ çŠ¶æ€: é™·å…¥å‚æ•°çˆ†ç ´å¾ªç¯
```

**æ—¥å¿—ç¤ºä¾‹**:
```
ä¸ºURL xxx?limit=..%2F ç”Ÿæˆ 37 ä¸ªå‚æ•°å˜ä½“
ä¸ºURL xxx?offset%5B0%5D=1 ç”Ÿæˆ 37 ä¸ªå‚æ•°å˜ä½“
ä¸ºURL xxx?sort=true ç”Ÿæˆ 37 ä¸ªå‚æ•°å˜ä½“
... (æ— æ­¢å¢ƒ)
```

### çˆ¬å–åï¼ˆä¿å®ˆé…ç½®ï¼‰

```
â±ï¸ æ—¶é—´: 2-5åˆ†é’Ÿ âœ…
ğŸ“Š URLæ•°: 50-200ä¸ª âœ…
ğŸ’¾ è¯·æ±‚æ•°: ç²¾ç®€é«˜æ•ˆ âœ…
âš ï¸ çŠ¶æ€: æ­£å¸¸å®Œæˆ âœ…
```

**é¢„æœŸæ—¥å¿—**:
```
[é™æ€çˆ¬è™«] é¡µé¢çˆ¬å–å®Œæˆ: https://xss-quiz.int21h.jp/
[é™æ€çˆ¬è™«] å‘ç° XX ä¸ª<a>æ ‡ç­¾
ä¸ºURL xxx ç”Ÿæˆ 5 ä¸ªå‚æ•°å˜ä½“  â† åªæœ‰5ä¸ªï¼
...
çˆ¬å–å®Œæˆï¼Œå…±å‘ç° XX ä¸ªå”¯ä¸€URL
```

---

## ğŸ¯ ä¸åŒåœºæ™¯çš„é…ç½®é€‰æ‹©

### åœºæ™¯1: XSSæµ‹è¯•ç«™ç‚¹ï¼ˆå¦‚xss-quizï¼‰

**æ¨è**: `config_conservative.json` æˆ–å®Œå…¨ç¦ç”¨å‚æ•°çˆ†ç ´

```powershell
.\spider.exe -config config_conservative.json
```

**åŸå› **: XSSç«™ç‚¹é€šå¸¸å‚æ•°æ•æ„Ÿï¼Œå®¹æ˜“è§¦å‘ç»„åˆçˆ†ç‚¸

### åœºæ™¯2: æ™®é€šç½‘ç«™å¿«é€Ÿæ‰«æ

**æ¨è**: `config_fast.json`

```powershell
.\spider.exe -config config_fast.json
```

### åœºæ™¯3: æ·±åº¦å®‰å…¨æµ‹è¯•ï¼ˆéå‚æ•°æ•æ„Ÿï¼‰

**æ¨è**: `config_thorough.json` ä½†é™ä½å‚æ•°çˆ†ç ´é™åˆ¶

ä¿®æ”¹ `config_thorough.json`:
```json
{
  "strategy_settings": {
    "param_fuzz_limit": 10,  // ä»200é™åˆ°10
    "post_param_fuzz_limit": 5   // ä»100é™åˆ°5
  }
}
```

### åœºæ™¯4: APIæ¥å£æµ‹è¯•

**æ¨è**: `config_api.json`

```powershell
.\spider.exe -config config_api.json
```

---

## ğŸ’¡ ä¼˜åŒ–å»ºè®®

### çŸ­æœŸå»ºè®®ï¼ˆç«‹å³å®æ–½ï¼‰

1. âœ… **ä½¿ç”¨ä¿å®ˆé…ç½®**
   ```powershell
   .\spider.exe -config config_conservative.json
   ```

2. âœ… **æˆ–è€…ç¦ç”¨å‚æ•°çˆ†ç ´**
   ```powershell
   .\spider.exe -url https://xss-quiz.int21h.jp/ -depth 3 -mode static
   ```

### ä¸­æœŸå»ºè®®ï¼ˆé…ç½®ä¼˜åŒ–ï¼‰

1. æ ¹æ®ç›®æ ‡ç½‘ç«™ç±»å‹é€‰æ‹©åˆé€‚çš„ `param_fuzz_limit`:
   - å‚æ•°æ•æ„Ÿç«™ç‚¹: 0-5
   - æ™®é€šç½‘ç«™: 10-20
   - éœ€è¦æ·±åº¦æµ‹è¯•: 20-50

2. æé«˜å»é‡é˜ˆå€¼é¿å…é‡å¤çˆ¬å–:
   - å‚æ•°å˜ä½“é¡µé¢ç›¸ä¼¼: 0.95
   - æ™®é€šé¡µé¢: 0.85
   - å†…å®¹å·®å¼‚å¤§: 0.75

### é•¿æœŸå»ºè®®ï¼ˆä»£ç æ”¹è¿›ï¼‰

éœ€è¦åœ¨ä»£ç å±‚é¢æ·»åŠ æ™ºèƒ½åˆ¤æ–­ï¼š

```go
// å»ºè®®åœ¨ param_handler.go ä¸­æ·»åŠ 
func shouldFuzzURL(url string) bool {
    parsedURL, _ := url.Parse(url)
    params := parsedURL.Query()
    
    // 1. å¦‚æœå·²ç»æœ‰2ä¸ªä»¥ä¸Šå‚æ•°ï¼Œä¸å†çˆ†ç ´
    if len(params) >= 2 {
        return false
    }
    
    // 2. å¦‚æœURLåŒ…å«ç‰¹æ®Šå‚æ•°ï¼ˆå¦‚sidï¼‰ï¼Œä¸çˆ†ç ´
    if _, hasSID := params["sid"]; hasSID {
        return false
    }
    
    // 3. å¦‚æœURLåŒ…å«è·¯å¾„ç©¿è¶Šå­—ç¬¦ï¼Œä¸çˆ†ç ´
    if strings.Contains(url, "..%2F") || strings.Contains(url, "../") {
        return false
    }
    
    return true
}
```

---

## ğŸ”§ é…ç½®å‚æ•°è¯¦è§£

### param_fuzz_limitï¼ˆå‚æ•°çˆ†ç ´é™åˆ¶ï¼‰

**ä½œç”¨**: æ§åˆ¶æ¯ä¸ªURLç”Ÿæˆçš„å‚æ•°å˜ä½“æ•°é‡

**æ¨èå€¼**:
- `0`: å®Œå…¨ç¦ç”¨å‚æ•°çˆ†ç ´
- `5`: ä¿å®ˆæ¨¡å¼ï¼ˆæ¨èç”¨äºå‚æ•°æ•æ„Ÿç«™ç‚¹ï¼‰
- `10`: å¹³è¡¡æ¨¡å¼ï¼ˆæ¨èæ—¥å¸¸ä½¿ç”¨ï¼‰
- `20-50`: æ·±åº¦æµ‹è¯•æ¨¡å¼
- `100+`: âš ï¸ å±é™©ï¼Œå¯èƒ½å¯¼è‡´URLçˆ†ç‚¸

**è®¡ç®—å…¬å¼**:
```
é¢„è®¡URLæ€»æ•° â‰ˆ åŸå§‹URLæ•° Ã— (1 + param_fuzz_limit) ^ max_depth
```

ä¾‹å­:
- `param_fuzz_limit=5, max_depth=3`: ~125ä¸ªURL âœ…
- `param_fuzz_limit=37, max_depth=3`: ~50,000ä¸ªURL âŒ
- `param_fuzz_limit=100, max_depth=5`: ~10,000,000ä¸ªURL âŒâŒâŒ

### similarity_thresholdï¼ˆå»é‡é˜ˆå€¼ï¼‰

**ä½œç”¨**: æ§åˆ¶é¡µé¢ç›¸ä¼¼åº¦åˆ¤æ–­çš„ä¸¥æ ¼ç¨‹åº¦

**æ¨èå€¼**:
- `0.95`: æ¿€è¿›å»é‡ï¼ˆå‚æ•°å˜ä½“é¡µé¢ç›¸ä¼¼ï¼‰
- `0.85`: å¹³è¡¡å»é‡ï¼ˆé»˜è®¤ï¼‰
- `0.75`: å®½æ¾å»é‡ï¼ˆå†…å®¹å·®å¼‚å¤§ï¼‰

### enable_param_fuzzingï¼ˆæ˜¯å¦å¯ç”¨å‚æ•°çˆ†ç ´ï¼‰

**ä½œç”¨**: æ€»å¼€å…³ï¼Œæ§åˆ¶æ˜¯å¦è¿›è¡Œå‚æ•°çˆ†ç ´

**æ¨è**:
- å‚æ•°æ•æ„Ÿç«™ç‚¹: `false`
- æ™®é€šç½‘ç«™: `true`ï¼ˆä½†è®¾ç½®åˆç†çš„limitï¼‰

---

## âœ… éªŒè¯ä¿®å¤æ•ˆæœ

### è¿è¡Œä¿å®ˆé…ç½®

```powershell
.\spider.exe -config config_conservative.json
```

### è§‚å¯Ÿæ—¥å¿—å˜åŒ–

**ä¿®å¤å‰çš„æ—¥å¿—**:
```
ä¸ºURL xxx ç”Ÿæˆ 37 ä¸ªå‚æ•°å˜ä½“
ä¸ºURL xxx ç”Ÿæˆ 37 ä¸ªå‚æ•°å˜ä½“
ä¸ºURL xxx ç”Ÿæˆ 37 ä¸ªå‚æ•°å˜ä½“
... (æ— æ­¢å¢ƒ)
```

**ä¿®å¤åçš„æ—¥å¿—**:
```
ä¸ºURL xxx ç”Ÿæˆ 5 ä¸ªå‚æ•°å˜ä½“  â† åªæœ‰5ä¸ª
ä¸ºURL xxx ç”Ÿæˆ 5 ä¸ªå‚æ•°å˜ä½“
ä¸ºURL xxx ç”Ÿæˆ 5 ä¸ªå‚æ•°å˜ä½“
...
============================================================
çˆ¬å–ç»Ÿè®¡
============================================================
çˆ¬å–é¡µé¢æ•°:    85  â† åˆç†çš„æ•°é‡
å”¯ä¸€URLæ•°:     82
å‘ç°é“¾æ¥æ•°:    156
è€—æ—¶:          3.20ç§’  â† å¿«é€Ÿå®Œæˆ
å¹³å‡é€Ÿåº¦:      26.56 é¡µ/ç§’
============================================================
```

---

## ğŸ“‹ å¿«é€Ÿæ£€æŸ¥æ¸…å•

ä½¿ç”¨ä¿å®ˆé…ç½®å‰ï¼Œè¯·ç¡®è®¤ï¼š

- [ ] å·²åˆ›å»º `config_conservative.json` æ–‡ä»¶
- [ ] å·²ä¿®æ”¹ `target_url` ä¸ºå®é™…ç›®æ ‡
- [ ] ç†è§£äº†å‚æ•°çˆ†ç ´çš„å½±å“
- [ ] å‡†å¤‡å¥½è§‚å¯Ÿæ•ˆæœå¯¹æ¯”

è¿è¡Œåæ£€æŸ¥ï¼š

- [ ] URLæ€»æ•°æ˜¯å¦åœ¨åˆç†èŒƒå›´ï¼ˆ< 500ï¼‰
- [ ] æ¯ä¸ªURLçš„å‚æ•°å˜ä½“æ•° â‰¤ 5
- [ ] çˆ¬å–èƒ½åœ¨åˆç†æ—¶é—´å†…å®Œæˆï¼ˆ< 10åˆ†é’Ÿï¼‰
- [ ] æ—¥å¿—ä¸­æ²¡æœ‰å¤§é‡é‡å¤çš„ç›¸ä¼¼é¡µé¢

---

## ğŸŠ æ€»ç»“

### æ ¸å¿ƒæ”¹è¿›

âœ… **å‚æ•°çˆ†ç ´é™åˆ¶**: 100 â†’ 5 (-95%)  
âœ… **POSTçˆ†ç ´**: 50 â†’ 0 (ç¦ç”¨)  
âœ… **å»é‡é˜ˆå€¼**: 0.85 â†’ 0.95 (+12%)  
âœ… **URLæ•°é‡**: æ•°ä¸‡ â†’ æ•°å (-99.9%)  
âœ… **çˆ¬å–æ—¶é—´**: æ°¸ä¸å®Œæˆ â†’ 2-5åˆ†é’Ÿ  

### ç«‹å³å¼€å§‹

```powershell
# ä½¿ç”¨ä¿å®ˆé…ç½®
.\spider.exe -config config_conservative.json

# æˆ–è€…å®Œå…¨ç¦ç”¨å‚æ•°çˆ†ç ´
.\spider.exe -url https://xss-quiz.int21h.jp/ -depth 3 -mode static
```

### åç»­ä¼˜åŒ–

å¦‚æœè¿˜æœ‰é—®é¢˜ï¼Œå¯ä»¥è¿›ä¸€æ­¥ï¼š
1. é™ä½ `max_depth` ä»3åˆ°2
2. æé«˜ `similarity_threshold` åˆ°0.98
3. å®Œå…¨ç¦ç”¨ `enable_param_fuzzing`

---

**é—®é¢˜å·²è§£å†³ï¼ç°åœ¨å¯ä»¥æ­£å¸¸çˆ¬å–äº†ã€‚** ğŸ‰

