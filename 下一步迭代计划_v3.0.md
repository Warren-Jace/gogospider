# Spider-golang ä¸‹ä¸€æ­¥è¿­ä»£è®¡åˆ’ v3.0

## ğŸ“‹ é¡¹ç›®å®šä½

**Spider Ultimate - ä¸“ä¸šçº§Webå®‰å…¨çˆ¬è™«å·¥å…·**

**æ ¸å¿ƒå®šä½**:
- ğŸ¯ å®‰å…¨æµ‹è¯•ä¸“ç”¨çˆ¬è™«
- ğŸ” æ·±åº¦URLå‘ç°å’Œåˆ†æ
- ğŸ›¡ï¸ æ¼æ´æŒ–æ˜è¾…åŠ©å·¥å…·
- ğŸš€ é«˜æ€§èƒ½åˆ†å¸ƒå¼çˆ¬å–

**ç›®æ ‡ç”¨æˆ·**:
- å®‰å…¨ç ”ç©¶äººå‘˜
- æ¸—é€æµ‹è¯•å·¥ç¨‹å¸ˆ
- Bug Bounty çŒäºº
- å®‰å…¨å›¢é˜Ÿ

---

## ğŸ¯ å½“å‰çŠ¶æ€è¯„ä¼°

### âœ… å·²æœ‰ä¼˜åŠ¿

1. **åŠŸèƒ½å®Œæ•´æ€§** (9/10)
   - âœ… é™æ€/åŠ¨æ€åŒå¼•æ“
   - âœ… å‚æ•°çˆ†ç ´ï¼ˆGET/POSTï¼‰
   - âœ… JSåˆ†æå’Œè§£æ··æ·†
   - âœ… æ™ºèƒ½è¡¨å•å¡«å……
   - âœ… AJAXæ‹¦æˆª

2. **æŠ€æœ¯æ ˆæ£€æµ‹** (8/10)
   - âœ… 15+ æ¡†æ¶è¯†åˆ«
   - âœ… æ•æ„Ÿä¿¡æ¯æ£€æµ‹
   - âœ… IPæ³„éœ²æ£€æµ‹

3. **ä»£ç è´¨é‡** (8.5/10)
   - âœ… èµ„æºç®¡ç†å®Œå–„
   - âœ… é”™è¯¯å¤„ç†ç»Ÿä¸€
   - âœ… å¹¶å‘å®‰å…¨

### âš ï¸ å¾…æ”¹è¿›é¡¹

1. **æ—¥å¿—ç³»ç»Ÿ** (6/10)
   - âš ï¸ ä½¿ç”¨ fmt.Printf
   - âš ï¸ æ— æ—¥å¿—çº§åˆ«æ§åˆ¶
   - âš ï¸ éš¾ä»¥è°ƒè¯•

2. **ç›‘æ§æŒ‡æ ‡** (0/10)
   - âŒ æ— å®æ—¶ç»Ÿè®¡
   - âŒ æ— æ€§èƒ½ç›‘æ§
   - âŒ æ— è¿›åº¦å±•ç¤º

3. **æµ‹è¯•è¦†ç›–** (0/10)
   - âŒ å®Œå…¨ç¼ºå¤±
   - âŒ æ— é›†æˆæµ‹è¯•
   - âŒ æ— æ€§èƒ½æµ‹è¯•

4. **æ–‡æ¡£å®Œå–„åº¦** (6/10)
   - âš ï¸ APIæ–‡æ¡£ç¼ºå¤±
   - âš ï¸ ç¤ºä¾‹ä¸è¶³

---

## ğŸ—“ï¸ è¿­ä»£è®¡åˆ’æ€»è§ˆ

### ç‰ˆæœ¬è§„åˆ’

```
å½“å‰ç‰ˆæœ¬: v2.5 (ä¼˜åŒ–ç‰ˆ)
ä¸‹ä¸€ç‰ˆæœ¬: v2.6 (ç¨³å®šç‰ˆ) â†’ v2.8 (å¢å¼ºç‰ˆ) â†’ v3.0 (ä¸“ä¸šç‰ˆ)
```

### æ—¶é—´çº¿

```
v2.6 ç¨³å®šç‰ˆ  â”â”â”â”â” 2å‘¨
v2.7 å¢å¼ºç‰ˆ  â”â”â”â”â”â”â”â”â” 3å‘¨
v2.8 æ€§èƒ½ç‰ˆ  â”â”â”â”â”â” 2å‘¨
v3.0 ä¸“ä¸šç‰ˆ  â”â”â”â”â”â”â”â”â”â”â”â” 4å‘¨
```

---

## ğŸ“¦ v2.6 ç¨³å®šç‰ˆ (2å‘¨)

**ä¸»é¢˜**: æ—¥å¿—ã€ç›‘æ§ã€æµ‹è¯•

### ç›®æ ‡
- æ·»åŠ ç»“æ„åŒ–æ—¥å¿—ç³»ç»Ÿ
- å®ç°å®æ—¶ç›‘æ§æŒ‡æ ‡
- æ·»åŠ æ ¸å¿ƒå•å…ƒæµ‹è¯•
- å®Œå–„æ–‡æ¡£å’Œç¤ºä¾‹

### è¯¦ç»†ä»»åŠ¡

#### 1.1 ç»“æ„åŒ–æ—¥å¿—ç³»ç»Ÿ â° 3å¤©

**ç›®æ ‡**: æ›¿æ¢æ‰€æœ‰ `fmt.Printf`ï¼Œå®ç°åˆ†çº§æ—¥å¿—

**å®ç°**:
```go
// ä½¿ç”¨ log/slog
import "log/slog"

// é…ç½®æ—¥å¿—
logger := slog.New(slog.NewJSONHandler(os.Stdout, &slog.HandlerOptions{
    Level: slog.LevelInfo,
}))

// ä½¿ç”¨ç¤ºä¾‹
logger.Info("å¼€å§‹çˆ¬å–", 
    "url", targetURL, 
    "depth", maxDepth,
    "mode", "smart")

logger.Error("çˆ¬å–å¤±è´¥", 
    "url", targetURL, 
    "error", err,
    "retry_count", 3)
```

**åŠŸèƒ½ç‚¹**:
- âœ… æ”¯æŒ DEBUG/INFO/WARN/ERROR çº§åˆ«
- âœ… JSON æ ¼å¼è¾“å‡ºï¼ˆä¾¿äºæ—¥å¿—åˆ†æï¼‰
- âœ… æ”¯æŒæ—¥å¿—æ–‡ä»¶è½®è½¬
- âœ… å¯é…ç½®æ—¥å¿—çº§åˆ«
- âœ… è¯·æ±‚è¿½è¸ªï¼ˆCorrelation IDï¼‰

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ‰€æœ‰ `fmt.Printf` æ›¿æ¢ä¸º `slog`
- [ ] æ”¯æŒ `-log-level` å‚æ•°
- [ ] æ”¯æŒ `-log-file` å‚æ•°
- [ ] æ—¥å¿—åŒ…å«å®Œæ•´ä¸Šä¸‹æ–‡ä¿¡æ¯

---

#### 1.2 å®æ—¶ç›‘æ§æŒ‡æ ‡ â° 3å¤©

**ç›®æ ‡**: å®æ—¶å±•ç¤ºçˆ¬å–è¿›åº¦å’Œæ€§èƒ½æŒ‡æ ‡

**å®ç°**:
```go
type Metrics struct {
    TotalRequests   int64         // æ€»è¯·æ±‚æ•°
    SuccessRequests int64         // æˆåŠŸæ•°
    FailedRequests  int64         // å¤±è´¥æ•°
    TotalURLs       int64         // å‘ç°URLæ•°
    TotalForms      int64         // å‘ç°è¡¨å•æ•°
    TotalAPIs       int64         // å‘ç°APIæ•°
    
    // æ€§èƒ½æŒ‡æ ‡
    AvgResponseTime time.Duration // å¹³å‡å“åº”æ—¶é—´
    RequestsPerSec  float64       // è¯·æ±‚é€Ÿç‡
    
    // HTTPçŠ¶æ€ç åˆ†å¸ƒ
    StatusCodes     map[int]int64
    
    // é”™è¯¯ç±»å‹åˆ†å¸ƒ
    ErrorTypes      map[string]int64
}

// å®æ—¶è¿›åº¦æ¡
func (s *Spider) ShowProgress() {
    ticker := time.NewTicker(1 * time.Second)
    for {
        select {
        case <-ticker.C:
            metrics := s.GetMetrics()
            fmt.Printf("\r[è¿›åº¦] è¯·æ±‚: %d | æˆåŠŸ: %d | URL: %d | é€Ÿåº¦: %.1f req/s",
                metrics.TotalRequests,
                metrics.SuccessRequests,
                metrics.TotalURLs,
                metrics.RequestsPerSec)
        }
    }
}
```

**åŠŸèƒ½ç‚¹**:
- âœ… å®æ—¶è¿›åº¦æ¡
- âœ… è¯·æ±‚æˆåŠŸç‡ç»Ÿè®¡
- âœ… å“åº”æ—¶é—´åˆ†å¸ƒï¼ˆP50/P95/P99ï¼‰
- âœ… HTTPçŠ¶æ€ç ç»Ÿè®¡
- âœ… é”™è¯¯ç±»å‹ç»Ÿè®¡
- âœ… çˆ¬å–é€Ÿç‡ç›‘æ§

**éªŒæ”¶æ ‡å‡†**:
- [ ] å®æ—¶æ˜¾ç¤ºçˆ¬å–è¿›åº¦
- [ ] ç»Ÿè®¡æ•°æ®å‡†ç¡®
- [ ] æ€§èƒ½å½±å“ < 5%

---

#### 1.3 æ ¸å¿ƒå•å…ƒæµ‹è¯• â° 4å¤©

**ç›®æ ‡**: æµ‹è¯•è¦†ç›–ç‡ > 60%

**æµ‹è¯•æ–‡ä»¶ç»“æ„**:
```
core/
  spider_test.go
  static_crawler_test.go
  dynamic_crawler_test.go
  errors_test.go
  duplicate_handler_test.go
  param_handler_test.go
config/
  config_test.go
```

**ç¤ºä¾‹æµ‹è¯•**:
```go
// core/spider_test.go
func TestSpiderBasicCrawl(t *testing.T) {
    // åˆ›å»ºæµ‹è¯•æœåŠ¡å™¨
    ts := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
        w.Write([]byte(`
            <html>
                <head><title>Test</title></head>
                <body>
                    <a href="/page1">Page 1</a>
                    <a href="/page2">Page 2</a>
                </body>
            </html>
        `))
    }))
    defer ts.Close()
    
    // åˆ›å»ºçˆ¬è™«
    cfg := config.NewDefaultConfig()
    cfg.TargetURL = ts.URL
    cfg.DepthSettings.MaxDepth = 2
    
    spider := NewSpider(cfg)
    defer spider.Close()
    
    // æ‰§è¡Œçˆ¬å–
    err := spider.Start(ts.URL)
    assert.NoError(t, err)
    
    // éªŒè¯ç»“æœ
    results := spider.GetResults()
    assert.Greater(t, len(results), 0)
    
    // éªŒè¯å‘ç°çš„é“¾æ¥
    foundLinks := false
    for _, result := range results {
        if len(result.Links) > 0 {
            foundLinks = true
            break
        }
    }
    assert.True(t, foundLinks, "åº”è¯¥å‘ç°é“¾æ¥")
}

// æµ‹è¯•é”™è¯¯å¤„ç†
func TestSpiderErrorHandling(t *testing.T) {
    cfg := config.NewDefaultConfig()
    cfg.TargetURL = "http://invalid-url-that-does-not-exist.local"
    
    spider := NewSpider(cfg)
    defer spider.Close()
    
    err := spider.Start(cfg.TargetURL)
    assert.Error(t, err)
}

// æµ‹è¯•é…ç½®éªŒè¯
func TestConfigValidation(t *testing.T) {
    tests := []struct {
        name    string
        modify  func(*config.Config)
        wantErr bool
    }{
        {
            name: "ç©ºURL",
            modify: func(c *config.Config) {
                c.TargetURL = ""
            },
            wantErr: true,
        },
        {
            name: "è´Ÿæ·±åº¦",
            modify: func(c *config.Config) {
                c.DepthSettings.MaxDepth = -1
            },
            wantErr: true,
        },
        {
            name: "æ­£å¸¸é…ç½®",
            modify: func(c *config.Config) {},
            wantErr: false,
        },
    }
    
    for _, tt := range tests {
        t.Run(tt.name, func(t *testing.T) {
            cfg := config.NewDefaultConfig()
            cfg.TargetURL = "https://example.com"
            tt.modify(cfg)
            
            err := cfg.Validate()
            if tt.wantErr {
                assert.Error(t, err)
            } else {
                assert.NoError(t, err)
            }
        })
    }
}
```

**æµ‹è¯•è¦†ç›–ç›®æ ‡**:
- [ ] Spider æ ¸å¿ƒåŠŸèƒ½ > 70%
- [ ] é…ç½®ç®¡ç† > 80%
- [ ] é”™è¯¯å¤„ç† > 90%
- [ ] å·¥å…·ç±» > 60%

---

#### 1.4 æ–‡æ¡£å®Œå–„ â° 2å¤©

**æ–°å¢æ–‡æ¡£**:
- `docs/API.md` - API æ–‡æ¡£
- `docs/EXAMPLES.md` - ä½¿ç”¨ç¤ºä¾‹
- `docs/DEVELOPMENT.md` - å¼€å‘æŒ‡å—
- `docs/TROUBLESHOOTING.md` - æ•…éšœæ’æŸ¥

**æ”¹è¿›ç°æœ‰æ–‡æ¡£**:
- æ›´æ–° `README.md` æ·»åŠ å¾½ç« 
- æ·»åŠ å¿«é€Ÿå¼€å§‹æŒ‡å—
- æ·»åŠ é…ç½®è¯´æ˜

**ç¤ºä¾‹ä»£ç **:
```markdown
# å¿«é€Ÿå¼€å§‹

## å®‰è£…

```bash
go install github.com/Warren-Jace/gogospider@latest
```

## åŸºæœ¬ä½¿ç”¨

```bash
# ç®€å•çˆ¬å–
spider -url https://example.com

# æ·±åº¦çˆ¬å–
spider -url https://example.com -depth 5

# å¯ç”¨å‚æ•°çˆ†ç ´
spider -url https://example.com -fuzz

# ä½¿ç”¨ä»£ç†
spider -url https://example.com -proxy http://127.0.0.1:8080

# è®¾ç½®æ—¥å¿—çº§åˆ«
spider -url https://example.com -log-level debug
```
```

---

### v2.6 éªŒæ”¶æ ‡å‡†

- [ ] æ‰€æœ‰æ—¥å¿—ä½¿ç”¨ slog
- [ ] å®æ—¶è¿›åº¦ç›‘æ§æ­£å¸¸
- [ ] æµ‹è¯•è¦†ç›–ç‡ > 60%
- [ ] æ–‡æ¡£å®Œæ•´ä¸”å‡†ç¡®
- [ ] CI/CD æµç¨‹å»ºç«‹

---

## ğŸ“¦ v2.7 å¢å¼ºç‰ˆ (3å‘¨)

**ä¸»é¢˜**: åŠŸèƒ½å¢å¼ºã€æ€§èƒ½ä¼˜åŒ–

### ç›®æ ‡
- æ·»åŠ æ–­ç‚¹ç»­çˆ¬åŠŸèƒ½
- ä¼˜åŒ–çˆ¬å–æ€§èƒ½
- å¢å¼ºå‚æ•°çˆ†ç ´
- æ·»åŠ æ›´å¤šæ¼æ´æ£€æµ‹

### è¯¦ç»†ä»»åŠ¡

#### 2.1 æ–­ç‚¹ç»­çˆ¬ â° 5å¤©

**ç›®æ ‡**: æ”¯æŒä¸­æ–­åç»§ç»­çˆ¬å–

**å®ç°**:
```go
type CheckpointManager struct {
    file      string
    mu        sync.Mutex
    visited   map[string]bool
    pending   []string
    lastSaved time.Time
}

func (cm *CheckpointManager) Save(state *CrawlState) error {
    cm.mu.Lock()
    defer cm.mu.Unlock()
    
    data, err := json.Marshal(state)
    if err != nil {
        return err
    }
    
    return os.WriteFile(cm.file, data, 0644)
}

func (cm *CheckpointManager) Load() (*CrawlState, error) {
    data, err := os.ReadFile(cm.file)
    if err != nil {
        return nil, err
    }
    
    var state CrawlState
    err = json.Unmarshal(data, &state)
    return &state, err
}

// ä½¿ç”¨ç¤ºä¾‹
spider := NewSpider(cfg)
spider.EnableCheckpoint("./spider_checkpoint.json")
spider.Start(targetURL)
```

**åŠŸèƒ½ç‚¹**:
- âœ… è‡ªåŠ¨ä¿å­˜çˆ¬å–çŠ¶æ€
- âœ… æ”¯æŒæ‰‹åŠ¨ä¿å­˜æ£€æŸ¥ç‚¹
- âœ… æ–­ç‚¹æ¢å¤çˆ¬å–
- âœ… å¢é‡çˆ¬å–æ¨¡å¼

---

#### 2.2 æ€§èƒ½ä¼˜åŒ– â° 5å¤©

**ä¼˜åŒ–ç‚¹**:

1. **HTTP è¿æ¥æ± å¤ç”¨**
```go
var defaultClient = &http.Client{
    Timeout: 30 * time.Second,
    Transport: &http.Transport{
        MaxIdleConns:        100,
        MaxIdleConnsPerHost: 20,
        IdleConnTimeout:     90 * time.Second,
        DisableKeepAlives:   false,
    },
}
```

2. **æ­£åˆ™è¡¨è¾¾å¼ç¼“å­˜**
```go
var (
    urlRegex  = regexp.MustCompile(`...`)
    apiRegex  = regexp.MustCompile(`...`)
    // ç¼–è¯‘ä¸€æ¬¡ï¼Œå¤šæ¬¡ä½¿ç”¨
)
```

3. **å†…å­˜ä¼˜åŒ–**
```go
// ä½¿ç”¨å¯¹è±¡æ± 
var resultPool = sync.Pool{
    New: func() interface{} {
        return &Result{
            Links: make([]string, 0, 100),
        }
    },
}

// å¤§HTMLåˆ†å—å¤„ç†
if len(htmlContent) > 5*1024*1024 {
    // åˆ†å—å¤„ç†ï¼Œé¿å…ä¸€æ¬¡æ€§åŠ è½½
}
```

4. **å¹¶å‘ä¼˜åŒ–**
```go
// åŠ¨æ€è°ƒæ•´ Worker æ•°é‡
func (s *Spider) AdjustWorkers(load float64) {
    if load > 0.8 {
        s.increaseWorkers()
    } else if load < 0.3 {
        s.decreaseWorkers()
    }
}
```

**æ€§èƒ½ç›®æ ‡**:
- [ ] çˆ¬å–é€Ÿåº¦æå‡ 50%
- [ ] å†…å­˜ä½¿ç”¨å‡å°‘ 30%
- [ ] CPU ä½¿ç”¨ç‡ä¼˜åŒ– 20%

---

#### 2.3 å¢å¼ºå‚æ•°çˆ†ç ´ â° 4å¤©

**æ–°å¢åŠŸèƒ½**:

1. **æ™ºèƒ½å‚æ•°çŒœæµ‹**
```go
// åŸºäºé¡µé¢å†…å®¹æ™ºèƒ½çŒœæµ‹å‚æ•°
func (p *ParamHandler) SmartGuess(htmlContent string) []string {
    params := []string{}
    
    // ä» JS ä»£ç æå–
    params = append(params, p.extractFromJS(htmlContent)...)
    
    // ä» HTML å±æ€§æå–
    params = append(params, p.extractFromAttrs(htmlContent)...)
    
    // ä» API å“åº”æå–
    params = append(params, p.extractFromAPI(htmlContent)...)
    
    return params
}
```

2. **å‚æ•°ç±»å‹æ¨æ–­**
```go
type ParamType int

const (
    ParamTypeString ParamType = iota
    ParamTypeInt
    ParamTypeBool
    ParamTypeEmail
    ParamTypeURL
)

func (p *ParamHandler) InferType(paramName string) ParamType {
    // åŸºäºå‚æ•°åæ¨æ–­ç±»å‹
}
```

3. **è‡ªå®šä¹‰å­—å…¸**
```go
// æ”¯æŒè‡ªå®šä¹‰å‚æ•°å­—å…¸
spider -url https://example.com -fuzz -fuzz-dict ./params.txt
```

---

#### 2.4 æ¼æ´æ£€æµ‹å¢å¼º â° 5å¤©

**æ–°å¢æ£€æµ‹**:

1. **SQLæ³¨å…¥æ£€æµ‹ç‚¹**
```go
type SQLiDetector struct{}

func (d *SQLiDetector) DetectPoints(url string) []InjectionPoint {
    points := []InjectionPoint{}
    
    // æ£€æµ‹ GET å‚æ•°
    if strings.Contains(url, "id=") {
        points = append(points, InjectionPoint{
            Type: "GET",
            Param: "id",
            URL: url,
        })
    }
    
    // æ£€æµ‹ SQL å…³é”®å­—
    if d.hasSQLKeywords(url) {
        // ...
    }
    
    return points
}
```

2. **XSSæ£€æµ‹ç‚¹**
```go
type XSSDetector struct{}

func (d *XSSDetector) DetectPoints(form Form) []InjectionPoint {
    // æ£€æµ‹å¯èƒ½çš„ XSS æ³¨å…¥ç‚¹
}
```

3. **SSRFæ£€æµ‹**
```go
type SSRFDetector struct{}

func (d *SSRFDetector) DetectURLParams(urls []string) []VulnPoint {
    // æ£€æµ‹å¯èƒ½çš„ SSRF ç‚¹
}
```

4. **å‘½ä»¤æ³¨å…¥æ£€æµ‹**
```go
type CMDIDetector struct{}

func (d *CMDIDetector) DetectPoints(params map[string]string) []InjectionPoint {
    // æ£€æµ‹å¯èƒ½çš„å‘½ä»¤æ³¨å…¥ç‚¹
}
```

**è¾“å‡ºç¤ºä¾‹**:
```json
{
  "vulnerabilities": [
    {
      "type": "SQL Injection",
      "severity": "High",
      "url": "https://example.com/user?id=1",
      "parameter": "id",
      "evidence": "Error-based detection",
      "recommendation": "Use parameterized queries"
    },
    {
      "type": "XSS",
      "severity": "Medium",
      "url": "https://example.com/search",
      "parameter": "q",
      "evidence": "Unescaped user input",
      "recommendation": "Sanitize user input"
    }
  ]
}
```

---

### v2.7 éªŒæ”¶æ ‡å‡†

- [ ] æ–­ç‚¹ç»­çˆ¬åŠŸèƒ½æ­£å¸¸
- [ ] æ€§èƒ½æå‡è¾¾æ ‡
- [ ] å‚æ•°çˆ†ç ´æ›´æ™ºèƒ½
- [ ] æ¼æ´æ£€æµ‹å‡†ç¡®ç‡ > 80%

---

## ğŸ“¦ v2.8 æ€§èƒ½ç‰ˆ (2å‘¨)

**ä¸»é¢˜**: åˆ†å¸ƒå¼ã€å¤§è§„æ¨¡çˆ¬å–

### ç›®æ ‡
- æ”¯æŒåˆ†å¸ƒå¼çˆ¬å–
- Redis é˜Ÿåˆ—æ”¯æŒ
- è¶…å¤§è§„æ¨¡ç«™ç‚¹çˆ¬å–
- çˆ¬å–ç­–ç•¥ä¼˜åŒ–

### è¯¦ç»†ä»»åŠ¡

#### 3.1 åˆ†å¸ƒå¼æ¶æ„ â° 7å¤©

**æ¶æ„è®¾è®¡**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Master    â”‚  â† åè°ƒèŠ‚ç‚¹
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
   â”Œâ”€â”€â”€â”´â”€â”€â”€â”
   â”‚ Redis â”‚  â† ä»»åŠ¡é˜Ÿåˆ—
   â””â”€â”€â”€â”¬â”€â”€â”€â”˜
       â”‚
   â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚               â”‚         â”‚
â”Œâ”€â”€â–¼â”€â”€â”      â”Œâ”€â”€â”€â”€â–¼â”€â”   â”Œâ”€â”€â–¼â”€â”€â”
â”‚Node1â”‚      â”‚Node2 â”‚   â”‚Node3â”‚  â† å·¥ä½œèŠ‚ç‚¹
â””â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”˜
```

**å®ç°**:
```go
// Master èŠ‚ç‚¹
type Master struct {
    redis   *redis.Client
    workers []*Worker
}

func (m *Master) Distribute(urls []string) {
    for _, url := range urls {
        m.redis.RPush("crawl_queue", url)
    }
}

// Worker èŠ‚ç‚¹
type Worker struct {
    id    string
    redis *redis.Client
}

func (w *Worker) Start() {
    for {
        url, err := w.redis.BLPop(0, "crawl_queue")
        if err != nil {
            continue
        }
        
        result := w.crawl(url)
        w.saveResult(result)
    }
}
```

---

#### 3.2 Redis é˜Ÿåˆ— â° 3å¤©

**åŠŸèƒ½**:
- âœ… URL å»é‡ï¼ˆRedis Setï¼‰
- âœ… ä»»åŠ¡é˜Ÿåˆ—ï¼ˆRedis Listï¼‰
- âœ… ç»“æœå­˜å‚¨ï¼ˆRedis Hashï¼‰
- âœ… åˆ†å¸ƒå¼é”

**ä½¿ç”¨ç¤ºä¾‹**:
```bash
# å¯åŠ¨ Master
spider master -redis redis://localhost:6379 -url https://example.com

# å¯åŠ¨ Worker
spider worker -redis redis://localhost:6379 -workers 10
```

---

#### 3.3 è¶…å¤§è§„æ¨¡ä¼˜åŒ– â° 4å¤©

**ä¼˜åŒ–ç­–ç•¥**:

1. **å¸ƒéš†è¿‡æ»¤å™¨å»é‡**
```go
import "github.com/bits-and-blooms/bloom"

bloom := bloom.NewWithEstimates(1000000, 0.01)
```

2. **æµå¼å¤„ç†**
```go
// é¿å…ä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰ç»“æœ
func (s *Spider) StreamResults() <-chan *Result {
    ch := make(chan *Result, 100)
    go func() {
        // æµå¼è¾“å‡ºç»“æœ
    }()
    return ch
}
```

3. **æ™ºèƒ½é™æµ**
```go
// æ ¹æ®æœåŠ¡å™¨å“åº”è‡ªåŠ¨è°ƒæ•´é€Ÿç‡
type AdaptiveRateLimiter struct {
    rate float64
}

func (r *AdaptiveRateLimiter) Adjust(responseTime time.Duration) {
    if responseTime > 5*time.Second {
        r.rate *= 0.8 // é™é€Ÿ
    } else if responseTime < 1*time.Second {
        r.rate *= 1.2 // åŠ é€Ÿ
    }
}
```

---

### v2.8 éªŒæ”¶æ ‡å‡†

- [ ] æ”¯æŒ 3+ èŠ‚ç‚¹åˆ†å¸ƒå¼çˆ¬å–
- [ ] Redis é›†æˆç¨³å®š
- [ ] å¯å¤„ç† 100ä¸‡+ URL
- [ ] å»é‡å‡†ç¡®ç‡ > 99.9%

---

## ğŸ“¦ v3.0 ä¸“ä¸šç‰ˆ (4å‘¨)

**ä¸»é¢˜**: ä¼ä¸šçº§åŠŸèƒ½ã€å®Œæ•´ç”Ÿæ€

### ç›®æ ‡
- Web UI ç®¡ç†ç•Œé¢
- æ’ä»¶ç³»ç»Ÿ
- API æœåŠ¡
- äº‘åŸç”Ÿæ”¯æŒ

### è¯¦ç»†ä»»åŠ¡

#### 4.1 Web UI â° 7å¤©

**åŠŸèƒ½**:
- âœ… ä»»åŠ¡ç®¡ç†
- âœ… å®æ—¶ç›‘æ§
- âœ… ç»“æœæŸ¥çœ‹
- âœ… é…ç½®ç®¡ç†
- âœ… æŠ¥å‘Šç”Ÿæˆ

**æŠ€æœ¯æ ˆ**:
- åç«¯: Gin/Echo
- å‰ç«¯: Vue.js/React
- æ•°æ®åº“: PostgreSQL

---

#### 4.2 æ’ä»¶ç³»ç»Ÿ â° 7å¤©

**è®¾è®¡**:
```go
type Plugin interface {
    Name() string
    Init() error
    OnRequest(req *Request) error
    OnResponse(resp *Response) error
    OnResult(result *Result) error
}

// ç¤ºä¾‹æ’ä»¶
type SQLiPlugin struct{}

func (p *SQLiPlugin) OnResult(result *Result) error {
    // æ£€æµ‹ SQL æ³¨å…¥
}
```

**å†…ç½®æ’ä»¶**:
- SQLæ³¨å…¥æ£€æµ‹
- XSSæ£€æµ‹
- ç›®å½•éå†æ£€æµ‹
- æ–‡ä»¶åŒ…å«æ£€æµ‹
- SSRFæ£€æµ‹

---

#### 4.3 API æœåŠ¡ â° 5å¤©

**RESTful API**:
```
POST   /api/v1/tasks          # åˆ›å»ºä»»åŠ¡
GET    /api/v1/tasks/:id      # è·å–ä»»åŠ¡
DELETE /api/v1/tasks/:id      # åˆ é™¤ä»»åŠ¡
GET    /api/v1/tasks/:id/results  # è·å–ç»“æœ
POST   /api/v1/tasks/:id/stop     # åœæ­¢ä»»åŠ¡
```

---

#### 4.4 äº‘åŸç”Ÿæ”¯æŒ â° 5å¤©

**Docker åŒ–**:
```dockerfile
FROM golang:1.21-alpine AS builder
WORKDIR /app
COPY . .
RUN go build -o spider cmd/spider/main.go

FROM chromedp/headless-shell:latest
COPY --from=builder /app/spider /usr/local/bin/
ENTRYPOINT ["spider"]
```

**Kubernetes éƒ¨ç½²**:
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: spider
spec:
  replicas: 3
  selector:
    matchLabels:
      app: spider
  template:
    spec:
      containers:
      - name: spider
        image: spider:v3.0
        resources:
          limits:
            memory: "2Gi"
            cpu: "1000m"
```

---

### v3.0 éªŒæ”¶æ ‡å‡†

- [ ] Web UI åŠŸèƒ½å®Œæ•´
- [ ] è‡³å°‘ 5 ä¸ªæ’ä»¶
- [ ] API æ–‡æ¡£å®Œå–„
- [ ] Docker é•œåƒå¯ç”¨
- [ ] K8s éƒ¨ç½²æ­£å¸¸

---

## ğŸ“Š å®Œæ•´æ—¶é—´çº¿

```
2025-10 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 2026-01

v2.6 ç¨³å®šç‰ˆ (2å‘¨)
â”œâ”€ ç»“æ„åŒ–æ—¥å¿—    â– â– â– 
â”œâ”€ ç›‘æ§æŒ‡æ ‡      â– â– â– 
â”œâ”€ å•å…ƒæµ‹è¯•      â– â– â– â– 
â””â”€ æ–‡æ¡£å®Œå–„      â– â– 

v2.7 å¢å¼ºç‰ˆ (3å‘¨)
â”œâ”€ æ–­ç‚¹ç»­çˆ¬      â– â– â– â– â– 
â”œâ”€ æ€§èƒ½ä¼˜åŒ–      â– â– â– â– â– 
â”œâ”€ å‚æ•°çˆ†ç ´å¢å¼º  â– â– â– â– 
â””â”€ æ¼æ´æ£€æµ‹      â– â– â– â– â– 

v2.8 æ€§èƒ½ç‰ˆ (2å‘¨)
â”œâ”€ åˆ†å¸ƒå¼æ¶æ„    â– â– â– â– â– â– â– 
â”œâ”€ Redis é˜Ÿåˆ—    â– â– â– 
â””â”€ å¤§è§„æ¨¡ä¼˜åŒ–    â– â– â– â– 

v3.0 ä¸“ä¸šç‰ˆ (4å‘¨)
â”œâ”€ Web UI        â– â– â– â– â– â– â– 
â”œâ”€ æ’ä»¶ç³»ç»Ÿ      â– â– â– â– â– â– â– 
â”œâ”€ API æœåŠ¡      â– â– â– â– â– 
â””â”€ äº‘åŸç”Ÿ        â– â– â– â– â– 
```

**æ€»æ—¶é—´**: çº¦ 11 å‘¨ï¼ˆ3ä¸ªæœˆï¼‰

---

## ğŸ¯ ä¼˜å…ˆçº§å»ºè®®

### P0 - å¿…é¡»å®Œæˆ

1. âœ… ç»“æ„åŒ–æ—¥å¿—ï¼ˆv2.6ï¼‰
2. âœ… ç›‘æ§æŒ‡æ ‡ï¼ˆv2.6ï¼‰
3. âœ… å•å…ƒæµ‹è¯•ï¼ˆv2.6ï¼‰
4. âœ… æ–­ç‚¹ç»­çˆ¬ï¼ˆv2.7ï¼‰
5. âœ… æ€§èƒ½ä¼˜åŒ–ï¼ˆv2.7ï¼‰

### P1 - é‡è¦åŠŸèƒ½

1. âš ï¸ å‚æ•°çˆ†ç ´å¢å¼ºï¼ˆv2.7ï¼‰
2. âš ï¸ æ¼æ´æ£€æµ‹ï¼ˆv2.7ï¼‰
3. âš ï¸ åˆ†å¸ƒå¼æ¶æ„ï¼ˆv2.8ï¼‰
4. âš ï¸ æ’ä»¶ç³»ç»Ÿï¼ˆv3.0ï¼‰

### P2 - é”¦ä¸Šæ·»èŠ±

1. ğŸ”µ Web UIï¼ˆv3.0ï¼‰
2. ğŸ”µ API æœåŠ¡ï¼ˆv3.0ï¼‰
3. ğŸ”µ äº‘åŸç”Ÿï¼ˆv3.0ï¼‰

---

## ğŸ’¡ å¿«é€Ÿå¼€å§‹ï¼ˆv2.6ï¼‰

### ç¬¬ä¸€å‘¨ä»»åŠ¡

**Day 1-3**: ç»“æ„åŒ–æ—¥å¿—
```bash
# åˆ›å»ºåˆ†æ”¯
git checkout -b feature/structured-logging

# å®ç°æ—¥å¿—ç³»ç»Ÿ
- å®šä¹‰ Logger æ¥å£
- å®ç° SlogLogger
- æ›¿æ¢æ‰€æœ‰ fmt.Printf
- æ·»åŠ æ—¥å¿—çº§åˆ«é…ç½®

# æµ‹è¯•
go test -v ./...
```

**Day 4-5**: ç›‘æ§æŒ‡æ ‡
```bash
# åˆ›å»ºåˆ†æ”¯
git checkout -b feature/metrics

# å®ç°ç›‘æ§
- åˆ›å»º Metrics ç»“æ„
- æ·»åŠ æŒ‡æ ‡æ”¶é›†
- å®ç°å®æ—¶è¿›åº¦æ¡
- æ·»åŠ ç»Ÿè®¡æŠ¥å‘Š

# æµ‹è¯•
go run cmd/spider/main.go -url https://example.com
```

### ç¬¬äºŒå‘¨ä»»åŠ¡

**Day 1-4**: å•å…ƒæµ‹è¯•
```bash
# åˆ›å»ºæµ‹è¯•
- spider_test.go
- config_test.go
- errors_test.go

# è¿è¡Œæµ‹è¯•
go test -v -cover ./...

# ç›®æ ‡ï¼šè¦†ç›–ç‡ > 60%
```

**Day 5**: æ–‡æ¡£å®Œå–„
```bash
# æ›´æ–°æ–‡æ¡£
- README.md
- docs/API.md
- docs/EXAMPLES.md
```

---

## ğŸ“š å‚è€ƒèµ„æ–™

### ç±»ä¼¼é¡¹ç›®

1. **Crawlergo** - åŠ¨æ€çˆ¬è™«å‚è€ƒ
2. **Katana** - ä¸‹ä¸€ä»£çˆ¬è™«
3. **Hakrawler** - Go çˆ¬è™«
4. **GoSpider** - å¿«é€Ÿçˆ¬è™«

### æŠ€æœ¯å‚è€ƒ

1. **æ—¥å¿—**: `log/slog` å®˜æ–¹æ–‡æ¡£
2. **æµ‹è¯•**: Go æµ‹è¯•æœ€ä½³å®è·µ
3. **åˆ†å¸ƒå¼**: Redis ä»»åŠ¡é˜Ÿåˆ—æ¨¡å¼
4. **æ€§èƒ½**: Go æ€§èƒ½ä¼˜åŒ–æŒ‡å—

---

## âœ… æ€»ç»“

### v2.6 ç¨³å®šç‰ˆï¼ˆé¦–è¦ç›®æ ‡ï¼‰

**äº¤ä»˜ç‰©**:
- âœ… å®Œæ•´çš„æ—¥å¿—ç³»ç»Ÿ
- âœ… å®æ—¶ç›‘æ§æŒ‡æ ‡
- âœ… 60%+ æµ‹è¯•è¦†ç›–
- âœ… å®Œå–„çš„æ–‡æ¡£

**é¢„æœŸæ•ˆæœ**:
- ğŸ›¡ï¸ æ›´ç¨³å®šå¯é 
- ğŸ” æ›´æ˜“äºè°ƒè¯•
- ğŸ“ˆ è´¨é‡å¯åº¦é‡
- ğŸ“– æ˜“äºä¸Šæ‰‹

### é•¿æœŸç›®æ ‡ï¼ˆv3.0ï¼‰

**æ„¿æ™¯**: æˆä¸º**æœ€å¥½ç”¨çš„ Go å®‰å…¨çˆ¬è™«å·¥å…·**

**ç‰¹è‰²**:
- ğŸš€ é«˜æ€§èƒ½åˆ†å¸ƒå¼
- ğŸ›¡ï¸ ä¸“ä¸šæ¼æ´æ£€æµ‹
- ğŸ¨ å‹å¥½çš„ Web UI
- ğŸ”Œ çµæ´»çš„æ’ä»¶ç³»ç»Ÿ
- â˜ï¸ äº‘åŸç”Ÿæ”¯æŒ

---

**åˆ¶å®šæ—¥æœŸ**: 2025-10-24  
**å½“å‰ç‰ˆæœ¬**: v2.5 (ä¼˜åŒ–ç‰ˆ)  
**ç›®æ ‡ç‰ˆæœ¬**: v3.0 (ä¸“ä¸šç‰ˆ)  
**é¢„è®¡å®Œæˆ**: 2026-01

