
╔═══════════════════════════════════════════════════════════════╗
║                                                               ║
║   ███████╗██████╗ ██╗██████╗ ███████╗██████╗                ║
║   ██╔════╝██╔══██╗██║██╔══██╗██╔════╝██╔══██╗               ║
║   ███████╗██████╔╝██║██║  ██║█████╗  ██████╔╝               ║
║   ╚════██║██╔═══╝ ██║██║  ██║██╔══╝  ██╔══██╗               ║
║   ███████║██║     ██║██████╔╝███████╗██║  ██║               ║
║   ╚══════╝╚═╝     ╚═╝╚═════╝ ╚══════╝╚═╝  ╚═╝               ║
║                                                               ║
║           GogoSpider - 智能Web爬虫系统                       ║
║     Version 3.4 - Hybrid Strategy with Adaptive Learning     ║
║                                                               ║
╚═══════════════════════════════════════════════════════════════╝

[*] 已加载配置文件: .\config.json
[敏感信息] 等待加载外部规则文件...
⚠️  警告: 敏感信息检测已启用，但未指定规则文件
💡 请使用 -sensitive-rules 参数指定规则文件
    示例: -sensitive-rules sensitive_rules_standard.json

[*] 开始爬取: http://testphp.vulnweb.com/
[*] 最大深度: 5
[*] 静态爬虫: true
[*] 动态爬虫: true
[*] 纯爬虫模式: 专注URL发现（已禁用参数爆破）

{"timestamp":"2025-10-27 00:04:30","level":"INFO","msg":"开始爬取","url":"http://testphp.vulnweb.com/","target_domain":"testphp.vulnweb.com","max_depth":5,"version":"v2.6"}

【已启用功能】Spider Ultimate v2.6
  ✓ 跨域JS分析（支持60+个CDN）
  ✓ 智能表单填充（支持20+种字段类型）
  ✓ 作用域精确控制（10个过滤维度）
  ✓ 性能优化（对象池+连接池）
  ✓ 技术栈识别（15+种框架）
  ✓ 敏感信息检测（30+种模式）
  ✓ JavaScript事件触发（点击、悬停、输入、滚动）
  ✓ AJAX请求拦截（动态URL捕获）
  ✓ 增强JS分析（对象、路由、配置）
  ✓ 静态资源分类（7种类型）
  ✓ IP地址检测（内网泄露识别）
  ✓ URL优先级排序（智能爬取策略）
  ✓ 结构化日志系统（分级、文件、JSON）🆕

爬取配置:
  深度: 5 层 | 并发: 20-30 | 日志: INFO

{"timestamp":"2025-10-27 00:04:30","level":"INFO","msg":"开始爬取sitemap和robots.txt","target":"http://testphp.vulnweb.com/"}
{"timestamp":"2025-10-27 00:05:15","level":"INFO","msg":"sitemap和robots.txt爬取完成","sitemap_urls":0,"disallow_paths":0,"allow_paths":0,"extra_sitemaps":0}
{"timestamp":"2025-10-27 00:05:15","level":"INFO","msg":"跳过隐藏路径扫描（EnableCommonPathScan=false）"}
{"timestamp":"2025-10-27 00:05:15","level":"INFO","msg":"使用静态爬虫","url":"http://testphp.vulnweb.com/"}
  [静态爬虫] 发现POST表单: http://testphp.vulnweb.com/search.php?test=query
    字段数: 2, 参数: 1

[静态爬虫] 页面爬取完成: http://testphp.vulnweb.com/
[静态爬虫] 发现 25 个<a>标签
[静态爬虫] 有效链接: 0个 | 重复过滤: 0个 | 无效链接: 25个
[静态爬虫] 最终收集: 2 个链接

{"timestamp":"2025-10-27 00:05:21","level":"INFO","msg":"检测到POST请求","page_url":"http://testphp.vulnweb.com/","post_count":1}
  [技术栈] 检测到: Nginx 1.19.0, PHP 5.6.40
{"timestamp":"2025-10-27 00:05:21","level":"INFO","msg":"静态爬虫完成","url":"http://testphp.vulnweb.com/","links":2,"assets":2,"forms":1,"apis":0}
{"timestamp":"2025-10-27 00:05:21","level":"INFO","msg":"使用动态爬虫","url":"http://testphp.vulnweb.com/","mode":"ajax_intercept"}
  [动态爬虫] AJAX拦截器已启动
2025/10/27 00:05:28 ERROR: could not unmarshal event: parse error: expected string near offset 802 of 'cookiePart...'
2025/10/27 00:05:28 ERROR: could not unmarshal event: unknown IPAddressSpace value: Loopback
2025/10/27 00:05:28 ERROR: could not unmarshal event: unknown IPAddressSpace value: Loopback
2025/10/27 00:05:28 ERROR: could not unmarshal event: parse error: expected string near offset 758 of 'cookiePart...'
2025/10/27 00:05:33 ERROR: could not unmarshal event: parse error: expected string near offset 760 of 'cookiePart...'
2025/10/27 00:05:33 ERROR: could not unmarshal event: unknown IPAddressSpace value: Loopback
2025/10/27 00:05:34 ERROR: could not unmarshal event: parse error: expected string near offset 762 of 'cookiePart...'
  [动态爬虫] 从页面提取到 20 个链接
  [动态爬虫] 从页面提取到 2 个资源
  [动态爬虫] 从页面提取到 1 个表单
  [POST表单] http://testphp.vulnweb.com/search.php?test=query
    参数: 1 个字段
    - searchFor=test_value
  [表单分析] 提交了 1 个POST表单
  [动态爬虫] 启动JavaScript事件触发...
  [事件触发] 开始自动触发页面事件...
  [AJAX拦截] 发现AJAX请求: http://testphp.vulnweb.com/categories.php
  [AJAX拦截] 发现AJAX请求: http://testphp.vulnweb.com/artists.php
  [AJAX拦截] 发现AJAX请求: http://testphp.vulnweb.com/AJAX/index.php
  [AJAX拦截] 发现AJAX请求: http://testphp.vulnweb.com/search.php?test=query
2025/10/27 00:05:35 ERROR: could not unmarshal event: unknown IPAddressSpace value: Loopback
2025/10/27 00:05:36 ERROR: could not unmarshal event: parse error: expected string near offset 802 of 'cookiePart...'
  [AJAX拦截] 发现AJAX请求: http://testphp.vulnweb.com/showimage.php?file=./pictures/1.jpg&size=160
  [AJAX拦截] 发现AJAX请求: http://testphp.vulnweb.com/showimage.php?file=./pictures/2.jpg&size=160
  [AJAX拦截] 发现AJAX请求: http://testphp.vulnweb.com/showimage.php?file=./pictures/3.jpg&size=160
  [AJAX拦截] 发现AJAX请求: http://testphp.vulnweb.com/showimage.php?file=./pictures/4.jpg&size=160
  [AJAX拦截] 发现AJAX请求: http://testphp.vulnweb.com/showimage.php?file=./pictures/5.jpg&size=160
  [AJAX拦截] 发现AJAX请求: http://testphp.vulnweb.com/showimage.php?file=./pictures/6.jpg&size=160
  [AJAX拦截] 发现AJAX请求: http://testphp.vulnweb.com/showimage.php?file=./pictures/7.jpg&size=160
2025/10/27 00:05:36 ERROR: could not unmarshal event: unknown IPAddressSpace value: Loopback
2025/10/27 00:05:36 ERROR: could not unmarshal event: unknown IPAddressSpace value: Loopback
2025/10/27 00:05:36 ERROR: could not unmarshal event: unknown IPAddressSpace value: Loopback
2025/10/27 00:05:36 ERROR: could not unmarshal event: unknown IPAddressSpace value: Loopback
2025/10/27 00:05:36 ERROR: could not unmarshal event: unknown IPAddressSpace value: Loopback
2025/10/27 00:05:36 ERROR: could not unmarshal event: unknown IPAddressSpace value: Loopback
2025/10/27 00:05:36 ERROR: could not unmarshal event: parse error: expected string near offset 697 of 'cookiePart...'
2025/10/27 00:05:36 ERROR: could not unmarshal event: unknown IPAddressSpace value: Loopback
2025/10/27 00:05:36 ERROR: could not unmarshal event: parse error: expected string near offset 697 of 'cookiePart...'
  [事件触发] 触发了 25 个点击事件
2025/10/27 00:05:36 ERROR: could not unmarshal event: parse error: expected string near offset 697 of 'cookiePart...'
  [事件触发] 触发了 50 个悬停事件
  [事件触发] 触发了 1 个输入事件
  [事件触发] 检测到DOM变化
  [事件触发] 完成！发现 50 个新URL, 1 个新表单
  [事件触发] 发现 50 个新URL
  [事件触发] 发现 1 个新表单
  [事件触发] 执行了 1 次滚动加载
  [AJAX拦截] 捕获到 11 个AJAX请求URL
  [AJAX拦截] 统计: map[total_ajax_requests:11]
{"timestamp":"2025-10-27 00:05:39","level":"INFO","msg":"检测到POST请求","page_url":"http://testphp.vulnweb.com/","post_count":1}
  [DOM相似度] 发现相似页面！相似度: 100.0%, 相似于: http://testphp.vulnweb.com/
  [DOM相似度] 原因: 结构哈希完全匹配
  [DOM相似度] ✓ 跳过重复爬取，节省资源
{"timestamp":"2025-10-27 00:05:39","level":"INFO","msg":"动态爬虫完成","url":"http://testphp.vulnweb.com/","links":80,"assets":2,"forms":2,"apis":0}

开始分析跨域JS文件...
未发现需要分析的跨域JS文件
{"timestamp":"2025-10-27 00:05:39","level":"INFO","msg":"自适应优先级学习器已启用","learning_rate":0.15}
{"timestamp":"2025-10-27 00:05:39","level":"INFO","msg":"使用混合调度策略","algorithm":"HYBRID"}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【混合调度策略】BFS框架 + 智能优先级排序
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✨ 结合BFS全面性和优先级智能性
✨ 自适应学习，越爬越聪明


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【第 2 层爬取】混合策略模式 | 最大深度: 5
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  发现 13 个外部链接（已记录但不爬取）
  [URL模式去重] 本层跳过 20 个重复模式URL

  [混合决策] 本层优先级TOP3（BFS框架 + 智能排序）:
    1. [优先级:16.00] http://testphp.vulnweb.com/login.php
    2. [优先级:12.00] http://testphp.vulnweb.com/userinfo.php
    3. [优先级:9.50] http://testphp.vulnweb.com/product.php?pic=6
    ... 还有 16 个URL按优先级排序
收集到 19 个候选URL

  [优先级TOP5] 本层最高价值URL:
    1. [优先级: 16.00] http://testphp.vulnweb.com/login.php
    2. [优先级: 12.00] http://testphp.vulnweb.com/userinfo.php
    3. [优先级: 9.50] http://testphp.vulnweb.com/product.php?pic=6
    4. [优先级: 9.50] http://testphp.vulnweb.com/search.php?test=query
    5. [优先级: 9.50] http://testphp.vulnweb.com/listproducts.php?cat=2
    ... 还有 14 个URL按优先级排序

  [静态爬虫] 发现POST表单: http://testphp.vulnweb.com/userinfo.php
    字段数: 2, 参数: 2
  [静态爬虫] 发现POST表单: http://testphp.vulnweb.com/search.php?test=query
    字段数: 2, 参数: 1

[静态爬虫] 页面爬取完成: http://testphp.vulnweb.com/login.php
[静态爬虫] 发现 24 个<a>标签
[静态爬虫] 有效链接: 0个 | 重复过滤: 0个 | 无效链接: 24个
[静态爬虫] 最终收集: 1 个链接

    [JS提取] 从javascript:协议提取URL: artists.php → http://testphp.vulnweb.com/AJAX/artists.php
    [JS提取] 从javascript:协议提取URL: categories.php → http://testphp.vulnweb.com/AJAX/categories.php

[静态爬虫] 页面爬取完成: http://testphp.vulnweb.com/AJAX/index.php
[静态爬虫] 发现 5 个<a>标签
[静态爬虫] 有效链接: 2个 | 重复过滤: 0个 | 无效链接: 3个
[静态爬虫] 最终收集: 2 个链接

  [静态爬虫] 发现POST表单: http://testphp.vulnweb.com/userinfo.php
    字段数: 2, 参数: 2
  [静态爬虫] 发现POST表单: http://testphp.vulnweb.com/search.php?test=query
    字段数: 2, 参数: 1

[静态爬虫] 页面爬取完成: http://testphp.vulnweb.com/login.php
[静态爬虫] 发现 24 个<a>标签
[静态爬虫] 有效链接: 0个 | 重复过滤: 0个 | 无效链接: 24个
[静态爬虫] 最终收集: 0 个链接

  [静态爬虫] 发现POST表单: http://testphp.vulnweb.com/search.php?test=query
    字段数: 2, 参数: 1

[静态爬虫] 页面爬取完成: http://testphp.vulnweb.com/categories.php
[静态爬虫] 发现 27 个<a>标签
[静态爬虫] 有效链接: 0个 | 重复过滤: 0个 | 无效链接: 27个
[静态爬虫] 最终收集: 0 个链接


[静态爬虫] 页面爬取完成: http://testphp.vulnweb.com/Mod_Rewrite_Shop/
[静态爬虫] 发现 6 个<a>标签
[静态爬虫] 有效链接: 0个 | 重复过滤: 0个 | 无效链接: 6个
[静态爬虫] 最终收集: 0 个链接

  [静态爬虫] 发现POST表单: http://testphp.vulnweb.com/guestbook.php
    字段数: 3, 参数: 2
  [静态爬虫] 发现POST表单: http://testphp.vulnweb.com/search.php?test=query
    字段数: 2, 参数: 1

[静态爬虫] 页面爬取完成: http://testphp.vulnweb.com/guestbook.php
[静态爬虫] 发现 23 个<a>标签
[静态爬虫] 有效链接: 0个 | 重复过滤: 0个 | 无效链接: 23个
[静态爬虫] 最终收集: 0 个链接

  [静态爬虫] 发现POST表单: http://testphp.vulnweb.com/search.php?test=query
    字段数: 2, 参数: 1

[静态爬虫] 页面爬取完成: http://testphp.vulnweb.com/cart.php
[静态爬虫] 发现 24 个<a>标签
[静态爬虫] 有效链接: 0个 | 重复过滤: 0个 | 无效链接: 24个
[静态爬虫] 最终收集: 0 个链接

为URL http://testphp.vulnweb.com/artists.php?artist=2 生成 7 个参数变体
  变体: http://testphp.vulnweb.com/artists.php?artist=2
  变体: http://testphp.vulnweb.com/artists.php?artist=2&id=1
  变体: http://testphp.vulnweb.com/artists.php?artist=2&page=1
  变体: http://testphp.vulnweb.com/artists.php?artist=2&category=1
  变体: http://testphp.vulnweb.com/artists.php?artist=2&product=1
  变体: http://testphp.vulnweb.com/artists.php?artist=2&user=1
  变体: http://testphp.vulnweb.com/artists.php?artist=2&token=1
  [静态爬虫] 发现POST表单: http://testphp.vulnweb.com/search.php?test=query
    字段数: 2, 参数: 1

[静态爬虫] 页面爬取完成: http://testphp.vulnweb.com/artists.php?artist=2
[静态爬虫] 发现 25 个<a>标签
[静态爬虫] 有效链接: 0个 | 重复过滤: 0个 | 无效链接: 25个
[静态爬虫] 最终收集: 0 个链接

请求错误 http://testphp.vulnweb.com/privacy.php: Not Found
为URL http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F5.jpg&size=160 生成 9 个参数变体
  变体: http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F5.jpg&size=160
  变体: http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F5.jpg&id=1&size=160
  变体: http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F5.jpg&page=1&size=160
  变体: http://testphp.vulnweb.com/showimage.php?category=1&file=.%2Fpictures%2F5.jpg&size=160
  变体: http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F5.jpg&product=1&size=160
  变体: http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F5.jpg&size=160&user=1
  变体: http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F5.jpg&size=160&token=1
  变体: http://testphp.vulnweb.com/showimage.php?size=160
  变体: http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F5.jpg

[静态爬虫] 页面爬取完成: http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F5.jpg&size=160
[静态爬虫] 发现 0 个<a>标签
[静态爬虫] 有效链接: 0个 | 重复过滤: 0个 | 无效链接: 0个
[静态爬虫] 最终收集: 0 个链接

为URL http://testphp.vulnweb.com/product.php?pic=6 生成 7 个参数变体
  变体: http://testphp.vulnweb.com/product.php?pic=6
  变体: http://testphp.vulnweb.com/product.php?id=1&pic=6
  变体: http://testphp.vulnweb.com/product.php?page=1&pic=6
  变体: http://testphp.vulnweb.com/product.php?category=1&pic=6
  变体: http://testphp.vulnweb.com/product.php?pic=6&product=1
  变体: http://testphp.vulnweb.com/product.php?pic=6&user=1
  变体: http://testphp.vulnweb.com/product.php?pic=6&token=1
  [静态爬虫] 发现POST表单: http://testphp.vulnweb.com/cart.php
    字段数: 2, 参数: 2
  [静态爬虫] 发现POST表单: http://testphp.vulnweb.com/search.php?test=query
    字段数: 2, 参数: 1

[静态爬虫] 页面爬取完成: http://testphp.vulnweb.com/product.php?pic=6
[静态爬虫] 发现 25 个<a>标签
[静态爬虫] 有效链接: 0个 | 重复过滤: 0个 | 无效链接: 25个
[静态爬虫] 最终收集: 1 个链接

为URL http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F3.jpg 生成 8 个参数变体
  变体: http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F3.jpg
  变体: http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F3.jpg&id=1
  变体: http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F3.jpg&page=1
  变体: http://testphp.vulnweb.com/showimage.php?category=1&file=.%2Fpictures%2F3.jpg
  变体: http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F3.jpg&product=1
  变体: http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F3.jpg&user=1
  变体: http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F3.jpg&token=1
  变体: http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F3.jpg&size=160

[静态爬虫] 页面爬取完成: http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F3.jpg
[静态爬虫] 发现 0 个<a>标签
[静态爬虫] 有效链接: 0个 | 重复过滤: 0个 | 无效链接: 0个
[静态爬虫] 最终收集: 0 个链接


[静态爬虫] 页面爬取完成: http://testphp.vulnweb.com/hpp/
[静态爬虫] 发现 2 个<a>标签
[静态爬虫] 有效链接: 0个 | 重复过滤: 0个 | 无效链接: 2个
[静态爬虫] 最终收集: 0 个链接

  [静态爬虫] 发现POST表单: http://testphp.vulnweb.com/search.php?test=query
    字段数: 2, 参数: 1

[静态爬虫] 页面爬取完成: http://testphp.vulnweb.com/disclaimer.php
[静态爬虫] 发现 24 个<a>标签
[静态爬虫] 有效链接: 0个 | 重复过滤: 0个 | 无效链接: 24个
[静态爬虫] 最终收集: 0 个链接

  [静态爬虫] 发现POST表单: http://testphp.vulnweb.com/search.php?test=query
    字段数: 2, 参数: 1

[静态爬虫] 页面爬取完成: http://testphp.vulnweb.com/index.php
[静态爬虫] 发现 25 个<a>标签
[静态爬虫] 有效链接: 0个 | 重复过滤: 0个 | 无效链接: 25个
[静态爬虫] 最终收集: 0 个链接


[静态爬虫] 页面爬取完成: http://testphp.vulnweb.com/Flash/add.swf
[静态爬虫] 发现 0 个<a>标签
[静态爬虫] 有效链接: 0个 | 重复过滤: 0个 | 无效链接: 0个
[静态爬虫] 最终收集: 0 个链接

为URL http://testphp.vulnweb.com/search.php?test=query 生成 7 个参数变体
  变体: http://testphp.vulnweb.com/search.php?test=query
  变体: http://testphp.vulnweb.com/search.php?id=1&test=query
  变体: http://testphp.vulnweb.com/search.php?page=1&test=query
  变体: http://testphp.vulnweb.com/search.php?category=1&test=query
  变体: http://testphp.vulnweb.com/search.php?product=1&test=query
  变体: http://testphp.vulnweb.com/search.php?test=query&user=1
  变体: http://testphp.vulnweb.com/search.php?test=query&token=1
  [静态爬虫] 发现POST表单: http://testphp.vulnweb.com/search.php?test=query
    字段数: 2, 参数: 1

[静态爬虫] 页面爬取完成: http://testphp.vulnweb.com/search.php?test=query
[静态爬虫] 发现 23 个<a>标签
[静态爬虫] 有效链接: 0个 | 重复过滤: 0个 | 无效链接: 23个
[静态爬虫] 最终收集: 0 个链接

为URL http://testphp.vulnweb.com/listproducts.php?cat=2 生成 7 个参数变体
  变体: http://testphp.vulnweb.com/listproducts.php?cat=2
  变体: http://testphp.vulnweb.com/listproducts.php?cat=2&id=1
  变体: http://testphp.vulnweb.com/listproducts.php?cat=2&page=1
  变体: http://testphp.vulnweb.com/listproducts.php?cat=2&category=1
  变体: http://testphp.vulnweb.com/listproducts.php?cat=2&product=1
  变体: http://testphp.vulnweb.com/listproducts.php?cat=2&user=1
  变体: http://testphp.vulnweb.com/listproducts.php?cat=2&token=1
  [静态爬虫] 发现POST表单: http://testphp.vulnweb.com/search.php?test=query
    字段数: 2, 参数: 1

[静态爬虫] 页面爬取完成: http://testphp.vulnweb.com/artists.php
[静态爬虫] 发现 29 个<a>标签
[静态爬虫] 有效链接: 0个 | 重复过滤: 0个 | 无效链接: 29个
[静态爬虫] 最终收集: 0 个链接

  [静态爬虫] 发现POST表单: http://testphp.vulnweb.com/search.php?test=query
    字段数: 2, 参数: 1

[静态爬虫] 页面爬取完成: http://testphp.vulnweb.com/listproducts.php?cat=2
[静态爬虫] 发现 27 个<a>标签
[静态爬虫] 有效链接: 0个 | 重复过滤: 0个 | 无效链接: 27个
[静态爬虫] 最终收集: 0 个链接

  本层统计 - 总任务: 19, 成功: 19, 失败: 0

第 2 层完成！爬取 19 个URL，累计 19 个

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【第 3 层爬取】混合策略模式 | 最大深度: 5
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  发现 13 个外部链接（已记录但不爬取）
  [URL模式去重] 本层跳过 23 个重复模式URL

  [混合决策] 本层优先级TOP3（BFS框架 + 智能排序）:
    1. [优先级:5.50] http://testphp.vulnweb.com/AJAX/categories.php
    2. [优先级:5.50] http://testphp.vulnweb.com/AJAX/artists.php
收集到 2 个候选URL

  [优先级TOP5] 本层最高价值URL:
    1. [优先级: 5.50] http://testphp.vulnweb.com/AJAX/categories.php
    2. [优先级: 5.50] http://testphp.vulnweb.com/AJAX/artists.php


[静态爬虫] 页面爬取完成: http://testphp.vulnweb.com/AJAX/categories.php
[静态爬虫] 发现 0 个<a>标签
[静态爬虫] 有效链接: 0个 | 重复过滤: 0个 | 无效链接: 0个
[静态爬虫] 最终收集: 0 个链接


[静态爬虫] 页面爬取完成: http://testphp.vulnweb.com/AJAX/artists.php
[静态爬虫] 发现 0 个<a>标签
[静态爬虫] 有效链接: 0个 | 重复过滤: 0个 | 无效链接: 0个
[静态爬虫] 最终收集: 0 个链接

  本层统计 - 总任务: 2, 成功: 2, 失败: 0

第 3 层完成！爬取 2 个URL，累计 21 个

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【第 4 层爬取】混合策略模式 | 最大深度: 5
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  发现 13 个外部链接（已记录但不爬取）
  [URL模式去重] 本层跳过 23 个重复模式URL
第 4 层没有新链接，爬取结束

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【混合策略爬取完成】
总深度: 4 层 | 总URL: 21 个
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
       自适应优先级学习报告
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【学习统计】
  总爬取URL数:   21
  高价值URL:     0 (0.0%)
  中等价值URL:   21 (100.0%)
  低价值URL:     0 (0.0%)

【发现统计】
  总链接数:      4
  总API数:       0
  总表单数:      16
  平均链接/页:   0.2
  API发现率:     0.0%

【性能指标】
  成功率:        95.2%
  权重调整次数:  0

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


正在关闭爬虫，清理资源...
停止爬取...
资源清理完成

[+] URL保存完成:
  - spider_testphp.vulnweb.com_20251027_000544_all_urls.txt  : 46 个URL（全部）
  - spider_testphp.vulnweb.com_20251027_000544_post_requests.txt : 20 个POST请求

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  ✅ URL去重文件已保存: spider_testphp.vulnweb.com_20251027_000544_unique_urls.txt
  唯一URL模式: 22 个
  原始URL总数: 42 个
  去重效果: 减少 20 个 (47.6%)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[敏感信息] 未发现敏感信息，跳过文件保存
[敏感信息] 未发现敏感信息，跳过JSON保存
  - spider_testphp.vulnweb.com_20251027_000544_excluded.txt : 57 个排除的URL
  - spider_testphp.vulnweb.com_20251027_000544_css_files.txt : 1 个CSS文件

============================================================
                        爬取统计
============================================================
爬取页面数:    23
唯一URL数:     22
发现链接数:    86
发现表单数:    19
POST请求数:    20
API接口数:     0
带参数URL:     6
静态资源:      1
耗时:          74.23秒
平均速度:      0.31 页/秒
============================================================

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔍 登录墙检测报告
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
总爬取页面: 2 个
登录页面: 0 个 (0.0%)
正常页面: 2 个
唯一登录URL: 0 个

✅ 未发现登录墙，所有页面均可正常访问
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 URL质量过滤报告 (v3.5)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🎯 过滤效果:
  原始收集URL: 86
  有效业务URL: 1
  过滤垃圾URL: 85
  过滤率: 98.8%

✨ 过滤规则:
  ✓ MIME类型字符串（application/vnd.*）
  ✓ JavaScript关键字（Math, Object, Array等）
  ✓ URL编码的代码片段
  ✓ 无意义的单字符路径（/a, /b, /M等）
  ✓ HTML标签片段
  ✓ 只保留有业务价值的URL

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📮 POST请求检测报告 (v3.5)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🎯 检测结果:
  总POST请求数: 20
  唯一POST端点: 4

📊 来源分布:
  - HTML表单: 20 (100.0%)

📝 POST端点示例（前10个）:
  1. http://testphp.vulnweb.com/search.php?test=query
  2. http://testphp.vulnweb.com/userinfo.php
  3. http://testphp.vulnweb.com/guestbook.php
  4. http://testphp.vulnweb.com/cart.php
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


================================================================================
                    URL模式去重报告
================================================================================

【总体统计】
  处理URL总数:    88
  唯一模式数:     22
  重复URL数:      66
  节省请求数:     66
  去重率:         75.0%

【Top 10 重复模式】
--------------------------------------------------------------------------------

1. GET http://testphp.vulnweb.com/showimage.php?file=
   重复次数: 21
   首次URL:  http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F3.jpg
   重复示例: http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F2.jpg, http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F4.jpg, ... (共5个)

2. GET http://testphp.vulnweb.com/showimage.php?file=&size=
   重复次数: 21
   首次URL:  http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F5.jpg&size=160
   重复示例: http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F2.jpg&size=160, http://testphp.vulnweb.com/showimage.php?file=.%2Fpictures%2F3.jpg&size=160, ... (共5个)

3. GET http://testphp.vulnweb.com/product.php?pic=
   重复次数: 19
   首次URL:  http://testphp.vulnweb.com/product.php?pic=6
   重复示例: http://testphp.vulnweb.com/product.php?pic=4, http://testphp.vulnweb.com/product.php?pic=7, ... (共5个)

4. GET http://testphp.vulnweb.com/artists.php?artist=
   重复次数: 4
   首次URL:  http://testphp.vulnweb.com/artists.php?artist=2
   重复示例: http://testphp.vulnweb.com/artists.php?artist=1, http://testphp.vulnweb.com/artists.php?artist=1, ... (共3个)

5. GET http://testphp.vulnweb.com/listproducts.php?cat=
   重复次数: 4
   首次URL:  http://testphp.vulnweb.com/listproducts.php?cat=2
   重复示例: http://testphp.vulnweb.com/listproducts.php?cat=1, http://testphp.vulnweb.com/listproducts.php?cat=1, ... (共3个)

6. GET mailto://
   重复次数: 3
   首次URL:  mailto:wvs@acunetix.com
   重复示例: mailto:wvs@acunetix.com, mailto:wvs@acunetix.com

7. GET http://testphp.vulnweb.com/Mod_Rewrite_Shop/
   重复次数: 1
   首次URL:  http://testphp.vulnweb.com/Mod_Rewrite_Shop/

8. GET http://testphp.vulnweb.com/guestbook.php
   重复次数: 1
   首次URL:  http://testphp.vulnweb.com/guestbook.php

9. GET http://testphp.vulnweb.com/artists.php
   重复次数: 1
   首次URL:  http://testphp.vulnweb.com/artists.php

10. GET http://testphp.vulnweb.com/AJAX/categories.php
   重复次数: 1
   首次URL:  http://testphp.vulnweb.com/AJAX/categories.php

================================================================================

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
         URL去重统计报告
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  唯一URL模式: 22 个
  URL总数:     42 个
  平均变体数:  1 个/模式
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  去重效果: 减少 20 个URL (47.6%)


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
       URL模式变体详细报告
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[1] 模式: http://testphp.vulnweb.com/showimage.php?file=&size=
    变体数: 7 个
    示例:
      - http://testphp.vulnweb.com/showimage.php?file=./pictures/1.jpg&size=160
      - http://testphp.vulnweb.com/showimage.php?file=./pictures/2.jpg&size=160
      - http://testphp.vulnweb.com/showimage.php?file=./pictures/3.jpg&size=160
      ... 还有 4 个变体

[2] 模式: http://testphp.vulnweb.com/showimage.php?file=
    变体数: 7 个
    示例:
      - http://testphp.vulnweb.com/showimage.php?file=./pictures/1.jpg
      - http://testphp.vulnweb.com/showimage.php?file=./pictures/2.jpg
      - http://testphp.vulnweb.com/showimage.php?file=./pictures/3.jpg
      ... 还有 4 个变体

[3] 模式: http://testphp.vulnweb.com/product.php?pic=
    变体数: 7 个
    示例:
      - http://testphp.vulnweb.com/product.php?pic=1
      - http://testphp.vulnweb.com/product.php?pic=2
      - http://testphp.vulnweb.com/product.php?pic=3
      ... 还有 4 个变体

[4] 模式: http://testphp.vulnweb.com/artists.php?artist=
    变体数: 2 个
    示例:
      - http://testphp.vulnweb.com/artists.php?artist=1
      - http://testphp.vulnweb.com/artists.php?artist=2

[5] 模式: http://testphp.vulnweb.com/listproducts.php?cat=
    变体数: 2 个
    示例:
      - http://testphp.vulnweb.com/listproducts.php?cat=1
      - http://testphp.vulnweb.com/listproducts.php?cat=2

[6] 模式: http://testphp.vulnweb.com/privacy.php
    变体数: 1 个
    示例:
      - http://testphp.vulnweb.com/privacy.php

[7] 模式: http://testphp.vulnweb.com/guestbook.php
    变体数: 1 个
    示例:
      - http://testphp.vulnweb.com/guestbook.php

[8] 模式: http://testphp.vulnweb.com/index.php
    变体数: 1 个
    示例:
      - http://testphp.vulnweb.com/index.php

[9] 模式: http://testphp.vulnweb.com/artists.php
    变体数: 1 个
    示例:
      - http://testphp.vulnweb.com/artists.php

[10] 模式: http://testphp.vulnweb.com/style.css
    变体数: 1 个
    示例:
      - http://testphp.vulnweb.com/style.css

... 还有 12 个模式
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


================================================================================
                   URL结构化去重报告
================================================================================

【总体统计】
  总URL数:          0 个
  唯一结构数:       0 个
  去重的URL数:      0 个

================================================================================

[+] 结果已保存到当前目录
