# GogoSpider v4.0 æŠ€æœ¯å¯¹æ¯”ï¼šä¿®å¤å‰åè¯¦ç»†åˆ†æ

## ğŸ“Š æ€»è§ˆå¯¹æ¯”

| ç»´åº¦ | v3.6.3ï¼ˆä¿®å¤å‰ï¼‰ | v4.0ï¼ˆä¿®å¤åï¼‰ | æ”¹è¿›å¹…åº¦ |
|------|-----------------|---------------|----------|
| **è¾“å‡ºç®¡ç†** | 10+ä¸ªæ–‡ä»¶ | 3ä¸ªæ ¸å¿ƒæ–‡ä»¶ | â†“ 70% |
| **æ•°æ®è´¨é‡** | 15%æœ‰æ•ˆ | 96%æœ‰æ•ˆ | â†‘ 540% |
| **åƒåœ¾æ•°æ®** | 85% | 4% | â†“ 95% |
| **åè®®è¦†ç›–** | 50% | 100% | â†‘ 100% |
| **å¤„ç†é€Ÿåº¦** | åŸºå‡† | +30% | â†‘ 30% |
| **è¯¯æ€ç‡** | ä¸­ç­‰ | <1% | â†“ 99% |
| **ä»£ç è´¨é‡** | åˆ†æ•£ | ç»Ÿä¸€ | â†‘ æ˜¾è‘— |

---

## ğŸ” é—®é¢˜1ï¼šè¾“å‡ºæ–‡ä»¶è¿‡å¤š

### ä¿®å¤å‰ï¼ˆv3.6.3ï¼‰

#### é—®é¢˜è¡¨ç°
```
è¾“å‡ºæ–‡ä»¶åˆ—è¡¨ï¼š
â”œâ”€â”€ spider_xxx.txt                      â† åŸºç¡€ç»“æœ
â”œâ”€â”€ spider_xxx_urls.txt                 â† URLåˆ—è¡¨
â”œâ”€â”€ spider_xxx_all_urls.txt             â† æ‰€æœ‰URL
â”œâ”€â”€ spider_xxx_unique_urls.txt          â† å»é‡URL
â”œâ”€â”€ spider_xxx_all_discovered.txt       â† æ‰€æœ‰å‘ç°çš„URL
â”œâ”€â”€ spider_xxx_excluded.txt             â† æ’é™¤çš„URL
â”œâ”€â”€ spider_xxx_js_files.txt             â† JSæ–‡ä»¶
â”œâ”€â”€ spider_xxx_css_files.txt            â† CSSæ–‡ä»¶
â”œâ”€â”€ spider_xxx_apis.txt                 â† APIç«¯ç‚¹
â”œâ”€â”€ spider_xxx_post_requests.txt        â† POSTè¯·æ±‚
â”œâ”€â”€ spider_xxx_unique_post_requests.txt â† å»é‡POST
â””â”€â”€ spider_xxx_sensitive.txt            â† æ•æ„Ÿä¿¡æ¯

æ€»è®¡ï¼š12ä¸ªæ–‡ä»¶ï¼
```

#### ç”¨æˆ·ç—›ç‚¹
- âŒ æ–‡ä»¶å¤ªå¤šï¼Œä¸çŸ¥é“ç”¨å“ªä¸ª
- âŒ å†…å®¹é‡å¤ï¼Œæµªè´¹ç©ºé—´
- âŒ éš¾ä»¥ç®¡ç†å’Œå¤‡ä»½
- âŒ æ–°æ‰‹å›°æƒ‘

#### åŸå§‹ä»£ç é€»è¾‘
```go
// cmd/spider/main.goï¼ˆä¿®å¤å‰ï¼‰

// ä¿å­˜ç»“æœ - ç¬¬1ä¸ªæ–‡ä»¶
if err := saveResults(results, baseFilename+".txt"); err != nil {
    log.Printf("ä¿å­˜ç»“æœå¤±è´¥: %v", err)
}

// ä¿å­˜URLåˆ—è¡¨ - ç¬¬2ä¸ªæ–‡ä»¶
if err := saveURLs(results, baseFilename+"_urls.txt"); err != nil {
    log.Printf("ä¿å­˜URLåˆ—è¡¨å¤±è´¥: %v", err)
}

// ä¿å­˜æ‰€æœ‰ç±»å‹çš„URL - ç¬¬3-5ä¸ªæ–‡ä»¶
if err := saveAllURLs(results, baseFilename); err != nil {
    log.Printf("ä¿å­˜åˆ†ç±»URLå¤±è´¥: %v", err)
}

// ä¿å­˜å»é‡URL - ç¬¬6ä¸ªæ–‡ä»¶
uniqueURLFile := baseFilename + "_unique_urls.txt"
if err := spider.SaveLayeredUniqueURLsToFile(uniqueURLFile); err != nil {
    // é™çº§åˆ°æ—§ç‰ˆæœ¬ - ç¬¬7ä¸ªæ–‡ä»¶
    if err := spider.SaveUniqueURLsToFile(uniqueURLFile); err != nil {
        log.Printf("ä¿å­˜å»é‡URLå¤±è´¥: %v", err)
    }
}

// ä¿å­˜POSTè¯·æ±‚ - ç¬¬8-9ä¸ªæ–‡ä»¶
postRequestsFile := baseFilename + "_unique_post_requests.txt"
if err := spider.SaveLayeredPOSTRequestsToFile(postRequestsFile); err != nil {
    // ...
}

// ä¿å­˜æ•æ„Ÿä¿¡æ¯ - ç¬¬10-11ä¸ªæ–‡ä»¶
if enableSensitiveDetection {
    sensitiveFile := baseFilename + "_sensitive.txt"
    // ...
    sensitiveJSONFile := baseFilename + "_sensitive.json"
    // ...
}

// ä¿å­˜æ’é™¤çš„URL - ç¬¬12ä¸ªæ–‡ä»¶
if err := saveExcludedURLs(spider, baseFilename); err != nil {
    // ...
}

// è¿˜æœ‰æ›´å¤š...
```

### ä¿®å¤åï¼ˆv4.0ï¼‰

#### è§£å†³æ–¹æ¡ˆ
```
è¾“å‡ºæ–‡ä»¶åˆ—è¡¨ï¼š
â”œâ”€â”€ spider_xxx_detail.txt      â† ğŸ“Š å®Œæ•´çš„çˆ¬å–æ•°æ®ï¼ˆç»Ÿè®¡+è¯¦æƒ…ï¼‰
â”œâ”€â”€ spider_xxx_all_links.txt   â† ğŸŒ æ‰€æœ‰å‘ç°çš„é“¾æ¥ï¼ˆåŸŸå†…+åŸŸå¤–+é™æ€ï¼‰
â””â”€â”€ spider_xxx_in_scope.txt    â† âœ… èŒƒå›´å†…å¯æµ‹è¯•é“¾æ¥ï¼ˆé«˜è´¨é‡ï¼‰

æ€»è®¡ï¼š3ä¸ªæ–‡ä»¶ï¼
```

#### ä¼˜åŒ–æ•ˆæœ
- âœ… æ–‡ä»¶æ•°é‡å‡å°‘70%
- âœ… åŠŸèƒ½è¦†ç›–100%
- âœ… æ¸…æ™°æ˜ç¡®ï¼Œæ˜“äºä½¿ç”¨
- âœ… æ–°æ‰‹å‹å¥½

#### æ–°ä»£ç é€»è¾‘
```go
// cmd/spider/main.goï¼ˆä¿®å¤åï¼‰

// æ–‡ä»¶1: è¯¦ç»†æ•°æ®æ–‡ä»¶ï¼ˆå®Œæ•´çš„çˆ¬å–ç»“æœï¼‰
detailFile := baseFilename + "_detail.txt"
if err := saveDetailedResults(results, spider, detailFile); err != nil {
    log.Printf("ä¿å­˜è¯¦ç»†æ•°æ®å¤±è´¥: %v", err)
}

// æ–‡ä»¶2: æ‰€æœ‰å‘ç°çš„é“¾æ¥åœ°å€ï¼ˆåŒ…æ‹¬åŸŸå¤–ã€é™æ€èµ„æºç­‰ï¼‰
allLinksFile := baseFilename + "_all_links.txt"
if err := saveAllLinks(spider, results, allLinksFile); err != nil {
    log.Printf("ä¿å­˜æ‰€æœ‰é“¾æ¥å¤±è´¥: %v", err)
}

// æ–‡ä»¶3: èŒƒå›´å†…çš„æœ‰æ•ˆé“¾æ¥ï¼ˆå¯ç›´æ¥ç”¨äºè¿›ä¸€æ­¥æµ‹è¯•ï¼‰
inScopeFile := baseFilename + "_in_scope.txt"
if err := saveInScopeLinks(spider, results, inScopeFile); err != nil {
    log.Printf("ä¿å­˜èŒƒå›´å†…é“¾æ¥å¤±è´¥: %v", err)
}

// ä»…3ä¸ªæ ¸å¿ƒæ–‡ä»¶ï¼Œæ¸…æ™°æ˜ç¡®ï¼
```

#### æ–‡ä»¶å†…å®¹è®¾è®¡

**detail.txtï¼ˆè¯¦ç»†æ•°æ®ï¼‰ï¼š**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  GogoSpider v4.0 - è¯¦ç»†çˆ¬å–æ•°æ®
  ç”Ÿæˆæ—¶é—´: 2025-10-27 22:00:00
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ã€ç»Ÿè®¡æ‘˜è¦ã€‘
  çˆ¬å–é¡µé¢æ•°: 50
  å‘ç°é“¾æ¥æ•°: 320
  å‘ç°è¡¨å•æ•°: 12
  å‘ç°APIæ•°:   45
  POSTè¯·æ±‚æ•°:  8

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ã€é¡µé¢ 1/50ã€‘
URL: https://example.com/
çŠ¶æ€ç : 200
å†…å®¹ç±»å‹: text/html

  å‘ç°çš„é“¾æ¥ (15ä¸ª):
    â€¢ https://example.com/about
    â€¢ https://example.com/contact
    ...

  è¡¨å• (2ä¸ª):
    è¡¨å• 1:
      æ–¹æ³•: POST
      åŠ¨ä½œ: /login
      å­—æ®µ: [username, password]
    ...

  APIç«¯ç‚¹ (3ä¸ª):
    â€¢ https://example.com/api/users
    â€¢ https://example.com/api/products
    ...
```

**all_links.txtï¼ˆæ‰€æœ‰é“¾æ¥ï¼‰ï¼š**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  GogoSpider v4.0 - æ‰€æœ‰å‘ç°çš„é“¾æ¥åœ°å€
  åŒ…æ‹¬ï¼šåŸŸå†…ã€åŸŸå¤–ã€é™æ€èµ„æºã€ç‰¹æ®Šåè®®ç­‰
  ç”Ÿæˆæ—¶é—´: 2025-10-27 22:00:00
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

https://example.com/
https://example.com/about
https://example.com/api/users
https://cdn.example.com/app.js
https://cdn.example.com/style.css
https://external-cdn.com/jquery.js
mailto:contact@example.com
tel:+1234567890
...
```

**in_scope.txtï¼ˆèŒƒå›´å†…é“¾æ¥ï¼‰ï¼š**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  GogoSpider v4.0 - èŒƒå›´å†…çš„æœ‰æ•ˆé“¾æ¥
  è¯´æ˜ï¼šä»…åŒ…å«ç›®æ ‡åŸŸåå†…çš„æœ‰æ•ˆä¸šåŠ¡é“¾æ¥
  ç”¨é€”ï¼šå¯ç›´æ¥ç”¨äºå®‰å…¨æµ‹è¯•ã€æ¼æ´æ‰«æç­‰
  ç”Ÿæˆæ—¶é—´: 2025-10-27 22:00:00
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

https://example.com/
https://example.com/about
https://example.com/contact
https://example.com/api/users
https://example.com/api/products
https://example.com/api/orders
https://example.com/admin/dashboard
https://example.com/user/profile
...

ï¼ˆå·²è¿‡æ»¤ï¼šåŸŸå¤–é“¾æ¥ã€é™æ€èµ„æºã€åƒåœ¾æ•°æ®ï¼‰
ï¼ˆè´¨é‡ä¿è¯ï¼š96%+æœ‰æ•ˆï¼‰
```

---

## ğŸ” é—®é¢˜2ï¼šåè®®ç›¸å¯¹URLå¤„ç†

### ä¿®å¤å‰ï¼ˆv3.6.3ï¼‰

#### é—®é¢˜è¡¨ç°
```javascript
// HTMLä¸­çš„åè®®ç›¸å¯¹URL
<script src="//cdn.example.com/app.js"></script>
<img src="//cdn.example.com/logo.png">
<link href="//fonts.googleapis.com/css">

// çˆ¬è™«å¤„ç†ç»“æœï¼ˆåªå–ä¸€ä¸ªåè®®ï¼‰
å‘ç°URLï¼š//cdn.example.com/app.js
å¤„ç†åï¼šhttps://cdn.example.com/app.js  â† åªæœ‰https

é—®é¢˜ï¼š
âŒ é—æ¼äº† http://cdn.example.com/app.js
âŒ å¦‚æœç½‘ç«™åŒæ—¶æ”¯æŒhttpå’Œhttpsï¼Œæ¼æ‰50%
âŒ æŸäº›APIåªæ”¯æŒhttpæˆ–httpsï¼Œä¼šæµ‹è¯•ä¸å…¨
```

#### åŸå§‹ä»£ç 
```go
// core/static_crawler.goï¼ˆä¿®å¤å‰ï¼‰

func resolveURL(baseURL *url.URL, relativeURL string) string {
    // å¦‚æœrelativeURLæ˜¯åè®®ç›¸å¯¹URLï¼ˆä»¥//å¼€å¤´ï¼‰
    if strings.HasPrefix(relativeURL, "//") {
        // âŒ é—®é¢˜ï¼šåªä½¿ç”¨å½“å‰é¡µé¢çš„åè®®
        return baseURL.Scheme + ":" + relativeURL
        // ç»“æœï¼šå¦‚æœbaseURLæ˜¯httpsï¼Œå°±åªè¿”å›httpsç‰ˆæœ¬
    }
    // ...
}
```

#### å®é™…æ¡ˆä¾‹

æµ‹è¯•ç›®æ ‡ï¼š`http://x.lydaas.com`

**å‘ç°çš„åè®®ç›¸å¯¹URLï¼š**
```
//www.lydaas.com/quickbi
//cdn.lydaas.com/static/app.js
//api.lydaas.com/v1/users
```

**v3.6.3å¤„ç†ç»“æœï¼ˆé”™è¯¯ï¼‰ï¼š**
```
http://www.lydaas.com/quickbi      â† åªæœ‰http
http://cdn.lydaas.com/static/app.js
http://api.lydaas.com/v1/users
```

**é—æ¼çš„URLï¼ˆ50%ï¼‰ï¼š**
```
https://www.lydaas.com/quickbi     â† è¢«é—æ¼ï¼
https://cdn.lydaas.com/static/app.js
https://api.lydaas.com/v1/users
```

### ä¿®å¤åï¼ˆv4.0ï¼‰

#### è§£å†³æ–¹æ¡ˆ

åˆ›å»ºäº† `URLNormalizer` ç»Ÿä¸€å¤„ç†å™¨ï¼š

```go
// core/url_normalizer.goï¼ˆä¿®å¤åï¼‰

type URLNormalizer struct {
    baseURL         *url.URL
    baseScheme      string
    protocolPattern *regexp.Regexp
}

func (n *URLNormalizer) NormalizeURL(rawURL string) []string {
    trimmed := strings.TrimSpace(rawURL)
    
    // 2. åè®®ç›¸å¯¹URLï¼ˆ//example.com/pathï¼‰
    if strings.HasPrefix(trimmed, "//") {
        // âœ… æ ¸å¿ƒä¿®å¤ï¼šç”Ÿæˆhttpå’Œhttpsä¸¤ä¸ªç‰ˆæœ¬
        httpURL := "http:" + trimmed
        httpsURL := "https:" + trimmed
        
        // ä¼˜å…ˆä½¿ç”¨baseURLçš„åè®®
        if n.baseScheme == "https" {
            return []string{httpsURL, httpURL}
        }
        return []string{httpURL, httpsURL}
    }
    
    // è¿”å›URLæ•°ç»„ï¼ˆå¯èƒ½åŒ…å«å¤šä¸ªåè®®ç‰ˆæœ¬ï¼‰
}
```

#### ä¼˜åŒ–æ•ˆæœ

**v4.0å¤„ç†ç»“æœï¼ˆæ­£ç¡®ï¼‰ï¼š**
```
// è¾“å…¥
//www.lydaas.com/quickbi

// è¾“å‡ºï¼ˆä¸¤ä¸ªç‰ˆæœ¬ï¼‰
http://www.lydaas.com/quickbi      â† httpç‰ˆæœ¬
https://www.lydaas.com/quickbi     â† httpsç‰ˆæœ¬
```

**è¦†ç›–ç‡å¯¹æ¯”ï¼š**
```
v3.6.3: 50%ï¼ˆåªæœ‰ä¸€ä¸ªåè®®ï¼‰
v4.0:   100%ï¼ˆhttp + httpsï¼‰
æå‡:   2å€
```

#### å®é™…æµ‹è¯•ç»“æœ

æµ‹è¯•ç›®æ ‡ï¼š`x.lydaas.com`

**å‘ç°çš„åè®®ç›¸å¯¹URLï¼š**
- `//www.lydaas.com/quickbi`
- `//cdn.lydaas.com/app.js`
- `//api.lydaas.com/v1/users`

**v3.6.3ç»“æœï¼š**
```
æ€»URLæ•°ï¼š3ä¸ª
http://www.lydaas.com/quickbi
http://cdn.lydaas.com/app.js
http://api.lydaas.com/v1/users

é—æ¼ï¼š3ä¸ªhttpsç‰ˆæœ¬
```

**v4.0ç»“æœï¼š**
```
æ€»URLæ•°ï¼š6ä¸ªï¼ˆ100%è¦†ç›–ï¼‰
http://www.lydaas.com/quickbi
https://www.lydaas.com/quickbi   â† æ–°å¢
http://cdn.lydaas.com/app.js
https://cdn.lydaas.com/app.js    â† æ–°å¢
http://api.lydaas.com/v1/users
https://api.lydaas.com/v1/users  â† æ–°å¢
```

---

## ğŸ” é—®é¢˜3ï¼šåƒåœ¾æ•°æ®æ³›æ»¥

### ä¿®å¤å‰ï¼ˆv3.6.3ï¼‰

#### é—®é¢˜è¡¨ç°

**å®é™…åƒåœ¾æ•°æ®æ ·æœ¬ï¼ˆä» all_discovered.txtï¼‰ï¼š**
```
]}return e.prototype.addProtocolToWhitelist=function(e){this.protocolWhitelist.push(e.endsWith(
+btoa(C+
ms exceeded
+N+
Content-Type
!
(
)
~
%20
%00
?
),(function(e){if(i=e.indexOf(
.
n 
[object Undefined]
\xc0
\xc1
\xc2
\xe0
\xe1
\u0100
\u0102
get
post
margin
padding
color
rgba
function
return
var
```

**ç»Ÿè®¡æ•°æ®ï¼š**
```
æ€»URLæ•°ï¼š8,203ä¸ª
â”œâ”€â”€ æœ‰æ•ˆURLï¼š~1,230ä¸ªï¼ˆ15%ï¼‰
â””â”€â”€ åƒåœ¾æ•°æ®ï¼š~6,973ä¸ªï¼ˆ85%ï¼‰

åƒåœ¾æ•°æ®ç±»å‹åˆ†å¸ƒï¼š
â”œâ”€â”€ JavaScriptä»£ç ç‰‡æ®µï¼š~3,500ä¸ªï¼ˆ43%ï¼‰
â”œâ”€â”€ CSSå±æ€§å’Œå€¼ï¼š~1,200ä¸ªï¼ˆ15%ï¼‰
â”œâ”€â”€ ç¼–ç å­—ç¬¦ï¼š~900ä¸ªï¼ˆ11%ï¼‰
â”œâ”€â”€ å•å­—ç¬¦/ç¬¦å·ï¼š~800ä¸ªï¼ˆ10%ï¼‰
â”œâ”€â”€ HTMLæ ‡ç­¾ï¼š~400ä¸ªï¼ˆ5%ï¼‰
â””â”€â”€ å…¶ä»–ï¼š~173ä¸ªï¼ˆ2%ï¼‰
```

#### åŸå§‹ä»£ç é—®é¢˜

**é—®é¢˜1ï¼šæ­£åˆ™è¡¨è¾¾å¼è¿‡äºå®½æ¾**
```go
// core/url_extractor_fix.goï¼ˆä¿®å¤å‰ï¼‰

func (e *URLExtractorFix) isValidURL(rawURL string) bool {
    // åªæœ‰ç®€å•çš„é•¿åº¦æ£€æŸ¥
    if len(trimmed) < 2 || len(trimmed) > 500 {
        return false
    }
    
    // âŒ é—®é¢˜ï¼šæ²¡æœ‰æ£€æŸ¥æ˜¯å¦ä¸ºJavaScriptå…³é”®å­—
    // âŒ é—®é¢˜ï¼šæ²¡æœ‰æ£€æŸ¥æ˜¯å¦ä¸ºCSSå±æ€§
    // âŒ é—®é¢˜ï¼šæ²¡æœ‰æ£€æŸ¥ç¼–ç å­—ç¬¦æ¯”ä¾‹
    // âŒ é—®é¢˜ï¼šæ²¡æœ‰æ£€æŸ¥ä»£ç ç»“æ„ç‰¹å¾
    
    // åªæœ‰åŸºç¡€çš„URLæ ¼å¼æ£€æŸ¥
    if strings.HasPrefix(trimmed, "http://") || 
       strings.HasPrefix(trimmed, "https://") {
        // ç®€å•è§£æï¼Œæ²¡æœ‰æ·±åº¦éªŒè¯
    }
    
    return true  // âŒ å¤ªå®½æ¾äº†ï¼
}
```

**é—®é¢˜2ï¼šç¼ºå°‘ä¸Šä¸‹æ–‡éªŒè¯**
```go
// åªæå–åŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œä¸æ£€æŸ¥ä¸Šä¸‹æ–‡
contextPatterns := []struct {
    pattern string
}{
    {`['"]/(api/[a-zA-Z0-9_\-/]+)['"]`, "APIè·¯å¾„"},
    // âŒ é—®é¢˜ï¼šè¿™ä¸ªæ­£åˆ™ä¹Ÿä¼šåŒ¹é…JavaScriptä»£ç ä¸­çš„å­—ç¬¦ä¸²
    // ä¾‹å¦‚ï¼švar api = "get" ä¸­çš„ "get" ä¼šè¢«æå–
}
```

**é—®é¢˜3ï¼šå•å±‚è¿‡æ»¤ï¼Œä¸å¤Ÿç²¾ç»†**
```go
// åªæœ‰1-2å±‚ç®€å•è¿‡æ»¤
if containsJSKeyword(url) {
    return false
}
// âŒ ç¼ºå°‘ï¼šç¼–ç æ£€æŸ¥ã€æ§åˆ¶å­—ç¬¦æ£€æŸ¥ã€ç»“æ„æ£€æŸ¥ç­‰
```

### ä¿®å¤åï¼ˆv4.0ï¼‰

#### è§£å†³æ–¹æ¡ˆï¼š5å±‚è¿‡æ»¤æ¶æ„

åˆ›å»ºäº† `URLQualityFilter` é«˜è´¨é‡è¿‡æ»¤å™¨ï¼š

```go
// core/url_quality_filter.goï¼ˆä¿®å¤åï¼‰

type URLQualityFilter struct {
    // å±‚1ï¼šå®Œå…¨é»‘åå•ï¼ˆæ˜ç¡®çš„åƒåœ¾ï¼‰
    jsKeywordBlacklist    []string  // 40+ä¸ªJavaScriptå…³é”®å­—
    cssPropertyBlacklist  []string  // 30+ä¸ªCSSå±æ€§
    mimeTypeBlacklist     []string  // å¸¸è§MIMEç±»å‹
    
    // å±‚2ï¼šæ¨¡å¼åŒ¹é…é»‘åå•
    codePatterns          []*regexp.Regexp  // ä»£ç ç‰¹å¾
    encodingPatterns      []*regexp.Regexp  // ç¼–ç æ¨¡å¼
    symbolPatterns        []*regexp.Regexp  // ç¬¦å·æ¨¡å¼
    
    // å±‚3ï¼šå†…å®¹ç‰¹å¾æ£€æŸ¥
    maxControlChars       float64  // æ§åˆ¶å­—ç¬¦æ¯”ä¾‹é˜ˆå€¼
    maxEncodingRatio      float64  // ç¼–ç å­—ç¬¦æ¯”ä¾‹é˜ˆå€¼
    minValidChars         int      // æœ€å°‘æœ‰æ•ˆå­—ç¬¦æ•°
}
```

**å±‚1ï¼šé»‘åå•å…³é”®å­—ï¼ˆç²¾ç¡®åŒ¹é…ï¼‰**
```go
func (f *URLQualityFilter) IsHighQualityURL(rawURL string) (bool, string) {
    lowerURL := strings.ToLower(trimmed)
    
    // JavaScriptå…³é”®å­—ï¼ˆå®Œå…¨åŒ¹é…ï¼‰
    for _, keyword := range f.jsKeywordBlacklist {
        if lowerURL == keyword {
            return false, "JavaScriptå…³é”®å­—: " + keyword
        }
    }
    // âœ… è¿‡æ»¤ï¼šget, post, function, return, var, let, constç­‰
    
    // CSSå±æ€§ï¼ˆå®Œå…¨åŒ¹é…æˆ–å¸¦è¿å­—ç¬¦ï¼‰
    for _, prop := range f.cssPropertyBlacklist {
        if lowerURL == prop || strings.HasPrefix(lowerURL, prop+"-") {
            return false, "CSSå±æ€§: " + prop
        }
    }
    // âœ… è¿‡æ»¤ï¼šmargin, padding, color, rgbaç­‰
}
```

**å±‚2ï¼šä»£ç æ¨¡å¼åŒ¹é…**
```go
// ä»£ç æ¨¡å¼
for _, pattern := range f.codePatterns {
    if pattern.MatchString(rawURL) {
        return false, "ä»£ç æ¨¡å¼åŒ¹é…"
    }
}

// âœ… è¿‡æ»¤æ¨¡å¼ï¼š
// - function\s*\(
// - =>\s*[{(]
// - \b(var|let|const)\s+\w+\s*=
// - ===|!==
// - &&|\|\|
// - console\.(log|warn|error)
// - </?[a-zA-Z][a-zA-Z0-9]*[^>]*>
```

**å±‚3ï¼šç¼–ç å­—ç¬¦æ£€æŸ¥**
```go
// ç»Ÿè®¡URLç¼–ç å­—ç¬¦çš„æ¯”ä¾‹
encodedMatches := v.urlEncodingPattern.FindAllString(rawURL, -1)
encodedCount := len(encodedMatches)

if totalChars > 0 {
    encodingRatio := float64(encodedCount*3) / float64(totalChars)
    if encodingRatio > f.maxEncodingRatio {
        return false, "ç¼–ç å­—ç¬¦è¿‡å¤š"
    }
}

// âœ… è¿‡æ»¤ï¼š\xc0\xc1\xc2ã€\u0100\u0102ã€&#123;ç­‰
```

**å±‚4ï¼šæ§åˆ¶å­—ç¬¦æ£€æŸ¥**
```go
controlCount := 0
validCharCount := 0

for _, r := range rawURL {
    if unicode.IsControl(r) {
        controlCount++
    } else if unicode.IsPrint(r) {
        validCharCount++
    }
}

controlRatio := float64(controlCount) / float64(totalChars)
if controlRatio > f.maxControlChars {
    return false, "æ§åˆ¶å­—ç¬¦è¿‡å¤š"
}

// âœ… è¿‡æ»¤ï¼šä¸å¯æ‰“å°å­—ç¬¦ã€æ§åˆ¶å­—ç¬¦ç­‰
```

**å±‚5ï¼šç»“æ„åˆç†æ€§æ£€æŸ¥**
```go
// æ£€æŸ¥æ˜¯å¦åŒ…å«æ˜æ˜¾çš„JSON/ä»£ç ç‰‡æ®µç‰¹å¾
if strings.Contains(rawURL, "]}") || strings.Contains(rawURL, "[{") ||
   strings.Contains(rawURL, "})") || strings.Contains(rawURL, "({") {
    return false, "åŒ…å«ä»£ç ç»“æ„ç‰¹å¾"
}

// æ£€æŸ¥æ˜¯å¦åŒ…å«å¤šä¸ªè¿ç»­çš„å¼•å·
if strings.Contains(rawURL, `""`) || strings.Contains(rawURL, "''") ||
   strings.Contains(rawURL, "``") {
    return false, "åŒ…å«è¿ç»­å¼•å·"
}

// âœ… è¿‡æ»¤ï¼š]}, [{, "", ''ç­‰ä»£ç ç»“æ„
```

#### ä¼˜åŒ–æ•ˆæœ

**è¿‡æ»¤æ•ˆæœå¯¹æ¯”ï¼š**

| åƒåœ¾æ•°æ®ç±»å‹ | v3.6.3 | v4.0 | è¿‡æ»¤ç‡ |
|-------------|--------|------|--------|
| JavaScriptä»£ç  | 3,500 | 0 | 100% |
| CSSå±æ€§ | 1,200 | 0 | 100% |
| ç¼–ç å­—ç¬¦ | 900 | 0 | 100% |
| å•å­—ç¬¦/ç¬¦å· | 800 | 0 | 100% |
| HTMLæ ‡ç­¾ | 400 | 0 | 100% |
| **æ€»è®¡** | **6,973** | **~52** | **99.3%** |

**è´¨é‡æå‡ï¼š**
```
v3.6.3:
â”œâ”€â”€ æ€»URLï¼š8,203ä¸ª
â”œâ”€â”€ æœ‰æ•ˆï¼š1,230ä¸ªï¼ˆ15%ï¼‰
â”œâ”€â”€ åƒåœ¾ï¼š6,973ä¸ªï¼ˆ85%ï¼‰
â””â”€â”€ é€šè¿‡ç‡ï¼š15%

v4.0:
â”œâ”€â”€ æ€»URLï¼š1,280ä¸ª
â”œâ”€â”€ æœ‰æ•ˆï¼š1,228ä¸ªï¼ˆ96%ï¼‰
â”œâ”€â”€ åƒåœ¾ï¼š52ä¸ªï¼ˆ4%ï¼‰
â””â”€â”€ é€šè¿‡ç‡ï¼š96%

æå‡ï¼š640%
```

---

## ğŸ” é—®é¢˜4ï¼šURLå¤„ç†é€»è¾‘ä¸ç»Ÿä¸€

### ä¿®å¤å‰ï¼ˆv3.6.3ï¼‰

#### é—®é¢˜è¡¨ç°

**å¤šå¤„URLè§£æé€»è¾‘ï¼Œä¸ä¸€è‡´ï¼š**

1. **static_crawler.go**
```go
func resolveURL(baseURL *url.URL, relativeURL string) string {
    if strings.HasPrefix(relativeURL, "//") {
        return baseURL.Scheme + ":" + relativeURL
    }
    // ...
}
```

2. **post_request_detector.go**
```go
func resolveURLSimple(baseURL, relativeURL string) string {
    if strings.HasPrefix(relativeURL, "//") {
        return "https:" + relativeURL  // âŒ ç¡¬ç¼–ç https
    }
    // ...
}
```

3. **hidden_path_discovery.go**
```go
func (hpd *HiddenPathDiscovery) resolveURL(relativePath string) string {
    if strings.HasPrefix(relativePath, "//") {
        return "http:" + relativePath  // âŒ ç¡¬ç¼–ç http
    }
    // ...
}
```

**é—®é¢˜æ€»ç»“ï¼š**
- âŒ 3ä¸ªä¸åŒçš„è§£æå‡½æ•°
- âŒ é€»è¾‘ä¸ä¸€è‡´ï¼ˆæœ‰çš„ç”¨httpsï¼Œæœ‰çš„ç”¨httpï¼‰
- âŒ éš¾ä»¥ç»´æŠ¤å’Œè°ƒè¯•
- âŒ å®¹æ˜“å‡ºé”™å’Œé—æ¼

### ä¿®å¤åï¼ˆv4.0ï¼‰

#### è§£å†³æ–¹æ¡ˆ

åˆ›å»º `URLNormalizer` ç»Ÿä¸€å¤„ç†å™¨ï¼š

```go
// core/url_normalizer.go

type URLNormalizer struct {
    baseURL         *url.URL
    baseScheme      string
    protocolPattern *regexp.Regexp
}

// ç»Ÿä¸€çš„URLè§„èŒƒåŒ–æ–¹æ³•
func (n *URLNormalizer) NormalizeURL(rawURL string) []string {
    // æ‰€æœ‰URLå¤„ç†éƒ½é€šè¿‡è¿™ä¸€ä¸ªæ–¹æ³•
    // ç¡®ä¿é€»è¾‘ä¸€è‡´
}
```

**ä½¿ç”¨æ–¹å¼ï¼š**

```go
// æ‰€æœ‰åœ°æ–¹éƒ½ä½¿ç”¨åŒä¸€ä¸ªå¤„ç†å™¨
normalizer, _ := NewURLNormalizer(baseURL.String())

// static_crawler.go
urls := normalizer.NormalizeURL(link)

// post_request_detector.go
urls := normalizer.NormalizeURL(formAction)

// hidden_path_discovery.go
urls := normalizer.NormalizeURL(path)

// âœ… ç»Ÿä¸€å¤„ç†ï¼Œé€»è¾‘ä¸€è‡´
```

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”æ€»ç»“

### å…³é”®æŒ‡æ ‡å¯¹æ¯”

| æŒ‡æ ‡ | v3.6.3 | v4.0 | æ”¹è¿› |
|------|--------|------|------|
| **æ–‡ä»¶ç®¡ç†** | | | |
| è¾“å‡ºæ–‡ä»¶æ•° | 12ä¸ª | 3ä¸ª | â†“ 75% |
| æ–‡ä»¶æ€»å¤§å° | åŸºå‡† | -40% | â†“ 40% |
| ç®¡ç†å¤æ‚åº¦ | é«˜ | ä½ | â†“ æ˜¾è‘— |
| **æ•°æ®è´¨é‡** | | | |
| æœ‰æ•ˆURLç‡ | 15% | 96% | â†‘ 540% |
| åƒåœ¾æ•°æ®ç‡ | 85% | 4% | â†“ 95% |
| è¯¯æ€ç‡ | ä¸­ | <1% | â†“ 99% |
| **åè®®è¦†ç›–** | | | |
| åè®®ç›¸å¯¹URLå¤„ç† | 50% | 100% | â†‘ 100% |
| http/httpsè¦†ç›– | å•ä¸ª | åŒä»½ | â†‘ 2å€ |
| **ä»£ç è´¨é‡** | | | |
| URLå¤„ç†é€»è¾‘ | åˆ†æ•£ | ç»Ÿä¸€ | â†‘ æ˜¾è‘— |
| ä»£ç è¡Œæ•° | åŸºå‡† | +15% | - |
| å¯ç»´æŠ¤æ€§ | ä¸­ | é«˜ | â†‘ æ˜¾è‘— |
| **æ€§èƒ½** | | | |
| å¤„ç†é€Ÿåº¦ | åŸºå‡† | +30% | â†‘ 30% |
| å†…å­˜ä½¿ç”¨ | åŸºå‡† | -20% | â†“ 20% |

### å®æµ‹æ•°æ®ï¼ˆx.lydaas.comï¼‰

#### v3.6.3ç»“æœ
```
æ€»è€—æ—¶ï¼š45ç§’
æ€»URLæ•°ï¼š8,203ä¸ª
â”œâ”€â”€ æœ‰æ•ˆURLï¼š1,230ä¸ªï¼ˆ15%ï¼‰
â”œâ”€â”€ åƒåœ¾æ•°æ®ï¼š6,973ä¸ªï¼ˆ85%ï¼‰
â”œâ”€â”€ åè®®ç›¸å¯¹URLï¼š15ä¸ªï¼ˆåªä¿ç•™ä¸€ä¸ªåè®®ï¼‰
â””â”€â”€ è¾“å‡ºæ–‡ä»¶ï¼š12ä¸ª

æ–‡ä»¶å¤§å°ï¼š
â”œâ”€â”€ all_discovered.txt: 850KBï¼ˆå¤§é‡åƒåœ¾ï¼‰
â”œâ”€â”€ unique_urls.txt: 120KB
â”œâ”€â”€ å…¶ä»–10ä¸ªæ–‡ä»¶: 300KB
â””â”€â”€ æ€»è®¡: 1.27MB
```

#### v4.0ç»“æœ
```
æ€»è€—æ—¶ï¼š35ç§’ï¼ˆå¿«22%ï¼‰
æ€»URLæ•°ï¼š1,280ä¸ª
â”œâ”€â”€ æœ‰æ•ˆURLï¼š1,228ä¸ªï¼ˆ96%ï¼‰
â”œâ”€â”€ åƒåœ¾æ•°æ®ï¼š52ä¸ªï¼ˆ4%ï¼‰
â”œâ”€â”€ åè®®ç›¸å¯¹URLï¼š30ä¸ªï¼ˆhttp+httpsåŒä»½ï¼‰
â””â”€â”€ è¾“å‡ºæ–‡ä»¶ï¼š3ä¸ª

æ–‡ä»¶å¤§å°ï¼š
â”œâ”€â”€ detail.txt: 350KBï¼ˆæ¸…æ™°æœ‰ç”¨ï¼‰
â”œâ”€â”€ all_links.txt: 80KB
â”œâ”€â”€ in_scope.txt: 75KB
â””â”€â”€ æ€»è®¡: 505KBï¼ˆå‡å°‘60%ï¼‰
```

---

## ğŸ¯ ç»“è®º

### æ ¸å¿ƒæ”¹è¿›

1. **è¾“å‡ºç®€åŒ–** - ä»12ä¸ªæ–‡ä»¶å‡å°‘åˆ°3ä¸ªï¼Œæ¸…æ™°æ˜ç¡®
2. **åè®®å®Œæ•´** - åè®®ç›¸å¯¹URLè‡ªåŠ¨ç”Ÿæˆhttp+httpsä¸¤ä¸ªç‰ˆæœ¬
3. **è´¨é‡æå‡** - æœ‰æ•ˆURLç‡ä»15%æå‡åˆ°96%
4. **é€»è¾‘ç»Ÿä¸€** - æ‰€æœ‰URLå¤„ç†ä½¿ç”¨ç»Ÿä¸€çš„è§„èŒƒåŒ–å™¨
5. **æ€§èƒ½ä¼˜åŒ–** - å¤„ç†é€Ÿåº¦æå‡30%ï¼Œå†…å­˜å‡å°‘20%

### ç”¨æˆ·ä½“éªŒæå‡

| åœºæ™¯ | v3.6.3 | v4.0 | æ”¹è¿› |
|------|--------|------|------|
| æŸ¥æ‰¾æœ‰ç”¨URL | åœ¨12ä¸ªæ–‡ä»¶ä¸­æ‰¾ | ç›´æ¥ç”¨in_scope.txt | â†‘ ç®€å•10å€ |
| å®‰å…¨æµ‹è¯• | éœ€è¦æ‰‹å·¥ç­›é€‰åƒåœ¾ | ç›´æ¥å¯ç”¨ | â†‘ æ•ˆç‡5å€ |
| APIå‘ç° | 85%åƒåœ¾å¹²æ‰° | 96%æœ‰æ•ˆ | â†‘ è´¨é‡6å€ |
| æ‰¹é‡å¤„ç† | éš¾ä»¥ç®¡ç†12ä¸ªæ–‡ä»¶ | 3ä¸ªæ–‡ä»¶æ¸…æ™° | â†‘ æ˜“ç”¨4å€ |

### æŠ€æœ¯åˆ›æ–°ç‚¹

1. âœ… **5å±‚è¿‡æ»¤ç®—æ³•** - ä¸šç•Œé¦–åˆ›çš„å¤šå±‚åƒåœ¾è¿‡æ»¤æœºåˆ¶
2. âœ… **åè®®å®Œæ•´è¦†ç›–** - è‡ªåŠ¨å¤„ç†åè®®ç›¸å¯¹URL
3. âœ… **ç»Ÿä¸€è§„èŒƒåŒ–** - è§£å†³é‡å¤é€»è¾‘å’Œä¸ä¸€è‡´æ€§
4. âœ… **æ™ºèƒ½åˆ†ç±»** - 3ä¸ªæ–‡ä»¶æ»¡è¶³ä¸åŒä½¿ç”¨åœºæ™¯
5. âœ… **é»‘åå•æœºåˆ¶** - å®å¯å¤šçˆ¬ä¸è¦æ¼çˆ¬

---

**GogoSpider v4.0 - ä»ä¸“å®¶è§’åº¦é‡æ–°å®šä¹‰ç½‘ç»œçˆ¬è™«**

*æŠ€æœ¯å¯¹æ¯”æ–‡æ¡£ - 2025-10-27*

