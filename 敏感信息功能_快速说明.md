# ğŸ”’ æ•æ„Ÿä¿¡æ¯æ£€æµ‹åŠŸèƒ½ - å¿«é€Ÿè¯´æ˜

## âœ… **æ‚¨çš„ä¸‰ä¸ªé—®é¢˜çš„ç­”æ¡ˆ**

### **é—®é¢˜1ï¼šæ•æ„Ÿä¿¡æ¯æ˜¯å¦ä¿å­˜åˆ°å•ç‹¬æ–‡ä»¶ä¸­ï¼Œå¹¶æŒ‡æ˜æ¥æºåœ°å€å’Œä¿¡æ¯ç±»å‹ï¼Ÿ**

**ç­”æ¡ˆï¼šâœ… æ˜¯çš„ï¼å®Œå…¨æ»¡è¶³è¦æ±‚**

**ä¿å­˜ä½ç½®ï¼š**
```
spider_{domain}_{timestamp}_sensitive.txt    # å•ç‹¬çš„æ•æ„Ÿä¿¡æ¯æ–‡ä»¶
```

**æ–‡ä»¶å†…å®¹ç¤ºä¾‹ï¼š**
```
ã€é«˜å±å‘ç°ã€‘
[1] APIå¯†é’¥æ³„éœ²                        â† ä¿¡æ¯ç±»å‹
    æ¥æºURL: https://example.com/config.js  â† æ¥æºåœ°å€
    ä½ç½®: Line 45                      â† ç²¾ç¡®ä½ç½®
    å€¼: sk_test_****xyz                â† è„±æ•å€¼

[2] æ•°æ®åº“å¯†ç 
    æ¥æºURL: https://example.com/db.php
    ä½ç½®: Line 23
    å€¼: pass****123
```

---

### **é—®é¢˜2ï¼šæ•æ„Ÿä¿¡æ¯æ£€æµ‹æ˜¯å¦é’ˆå¯¹æ¯ä¸ªè¿”å›æ•°æ®åŒ…ï¼Ÿ**

**ç­”æ¡ˆï¼šâœ… æ˜¯çš„ï¼æ¯ä¸ªæ•°æ®åŒ…éƒ½ä¼šæ£€æµ‹**

**æ£€æµ‹æ—¶æœºï¼š**
```
å‘é€è¯·æ±‚ â†’ æ¥æ”¶å“åº” â†’ addResult() â†’ ğŸ” æ•æ„Ÿä¿¡æ¯æ£€æµ‹
                                    â”œâ”€ æ‰«æå“åº”ä½“
                                    â””â”€ æ‰«æå“åº”å¤´
```

**ä»£ç ä½ç½®ï¼š** `core/spider.go` ç¬¬733-775è¡Œ

```go
// æ¯æ¬¡æ·»åŠ çˆ¬å–ç»“æœæ—¶éƒ½ä¼šæ‰§è¡Œ
if s.config.SensitiveDetectionSettings.Enabled {
    // æ£€æµ‹å“åº”ä½“
    bodyFindings := s.sensitiveDetector.Scan(result.HTMLContent, result.URL)
    
    // æ£€æµ‹å“åº”å¤´
    headerFindings := s.sensitiveDetector.Scan(headerContent, result.URL)
}
```

---

### **é—®é¢˜3ï¼šæ•æ„Ÿä¿¡æ¯æ£€æµ‹æ˜¯å¦æ˜¯ç»Ÿä¸€åŠŸèƒ½ï¼Ÿ**

**ç­”æ¡ˆï¼šâœ… æ˜¯çš„ï¼å®Œå…¨ç»Ÿä¸€**

**ç»Ÿä¸€æ¶æ„ï¼š**
```
Spider
â”œâ”€ sensitiveDetector   (ç»Ÿä¸€æ£€æµ‹å™¨)
â”œâ”€ sensitiveManager    (ç»Ÿä¸€ç®¡ç†å™¨)
â”œâ”€ sensitiveFindings   (ç»Ÿä¸€å­˜å‚¨)
â””â”€ config.SensitiveDetectionSettings (ç»Ÿä¸€é…ç½®)
```

**ç»Ÿä¸€é…ç½®æ–‡ä»¶ï¼š**
```json
{
  "sensitive_detection_settings": {
    "enabled": true,                     // ç»Ÿä¸€å¼€å…³
    "scan_response_body": true,          // æ‰«æå“åº”ä½“
    "scan_response_headers": true,       // æ‰«æå“åº”å¤´
    "rules_file": "sensitive_rules_standard.json"  // ç»Ÿä¸€è§„åˆ™
  }
}
```

---

## ğŸ“Š **å®Œæ•´ä¿¡æ¯è®°å½•**

æ¯æ¡æ•æ„Ÿä¿¡æ¯åŒ…å«ä»¥ä¸‹å­—æ®µï¼š

```go
type SensitiveInfo struct {
    Type       string  // âœ… æ•æ„Ÿä¿¡æ¯ç±»å‹ï¼ˆAPIå¯†é’¥ã€å¯†ç ã€é‚®ç®±ç­‰ï¼‰
    SourceURL  string  // âœ… æ¥æºURLåœ°å€ï¼ˆå®Œæ•´è®°å½•ï¼‰
    Location   string  // âœ… å…·ä½“ä½ç½®ï¼ˆLine 45ï¼‰
    Value      string  // âœ… è„±æ•åçš„å€¼
    FullValue  string  // âœ… å®Œæ•´å€¼ï¼ˆå†…éƒ¨ä½¿ç”¨ï¼‰
    Severity   string  // âœ… ä¸¥é‡ç¨‹åº¦ï¼ˆHIGH/MEDIUM/LOWï¼‰
    LineNumber int     // âœ… è¡Œå·
}
```

---

## ğŸš€ **å¦‚ä½•æŸ¥çœ‹æ•æ„Ÿä¿¡æ¯æ£€æµ‹ç»“æœ**

### **æ–¹æ³•1ï¼šè¿è¡Œæµ‹è¯•è„šæœ¬ï¼ˆæ¨èï¼‰**

```bash
# Windows
æµ‹è¯•æ•æ„Ÿä¿¡æ¯æ£€æµ‹.bat

# ä¼šè‡ªåŠ¨ï¼š
# 1. è¿è¡Œçˆ¬è™«
# 2. ç”Ÿæˆæ•æ„Ÿä¿¡æ¯æŠ¥å‘Š
# 3. æ˜¾ç¤ºæ–‡ä»¶é¢„è§ˆ
```

### **æ–¹æ³•2ï¼šæ‰‹åŠ¨è¿è¡Œ**

```bash
# 1. è¿è¡Œçˆ¬è™«ï¼ˆæ•æ„Ÿä¿¡æ¯æ£€æµ‹é»˜è®¤å¼€å¯ï¼‰
./spider -url https://testphp.vulnweb.com -sensitive-rules sensitive_rules_standard.json

# 2. æŸ¥çœ‹ç”Ÿæˆçš„æ–‡ä»¶
dir spider_*_sensitive.*

# 3. æŸ¥çœ‹æ–‡æœ¬æŠ¥å‘Š
type spider_testphp.vulnweb.com_*_sensitive.txt

# 4. æŸ¥çœ‹HTMLå¯è§†åŒ–æŠ¥å‘Šï¼ˆæœ€æ¨èï¼‰
start sensitive_*.html
```

---

## ğŸ“ **ç”Ÿæˆçš„æ–‡ä»¶æ¸…å•**

è¿è¡Œåä¼šç”Ÿæˆä»¥ä¸‹ç‹¬ç«‹æ–‡ä»¶ï¼š

| æ–‡ä»¶å | è¯´æ˜ | åŒ…å«å†…å®¹ |
|--------|------|---------|
| `spider_{domain}_{time}_sensitive.txt` | è¯¦ç»†æ–‡æœ¬æŠ¥å‘Š | âœ… æ¥æºURL + ç±»å‹ + ä½ç½® |
| `sensitive_{domain}_{time}.json` | JSONæ•°æ® | âœ… ç»“æ„åŒ–æ•°æ® |
| `sensitive_{domain}_{time}.csv` | Excelè¡¨æ ¼ | âœ… å¯ç”¨Excelåˆ†æ |
| `sensitive_{domain}_{time}.html` | å¯è§†åŒ–æŠ¥å‘Š | âœ… æµè§ˆå™¨ç›´æ¥æŸ¥çœ‹ |
| `sensitive_{domain}_{time}_summary.txt` | å¿«é€Ÿæ‘˜è¦ | âœ… æ€»è§ˆç»Ÿè®¡ |

---

## ğŸ¯ **æ ¸å¿ƒç‰¹æ€§**

### âœ… **å…¨é¢æ£€æµ‹**
- æ¯ä¸ªHTTPå“åº”éƒ½æ£€æµ‹
- å“åº”ä½“å’Œå“åº”å¤´éƒ½æ‰«æ
- æ”¯æŒè‡ªå®šä¹‰è§„åˆ™

### âœ… **å®Œæ•´è®°å½•**
- æ•æ„Ÿä¿¡æ¯ç±»å‹
- æ¥æºURLåœ°å€
- ç²¾ç¡®è¡Œå·ä½ç½®
- ä¸¥é‡ç¨‹åº¦åˆ†çº§

### âœ… **ç‹¬ç«‹ä¿å­˜**
- å•ç‹¬çš„æ•æ„Ÿä¿¡æ¯æ–‡ä»¶
- ä¸çˆ¬å–ç»“æœåˆ†ç¦»
- å¤šç§æ ¼å¼å¯é€‰

### âœ… **ç»Ÿä¸€ç®¡ç†**
- ç»Ÿä¸€çš„æ£€æµ‹å™¨
- ç»Ÿä¸€çš„é…ç½®
- ç»Ÿä¸€çš„å¯¼å‡º

---

## ğŸ’¡ **å®é™…ä½¿ç”¨ç¤ºä¾‹**

### **ç¤ºä¾‹1ï¼šåŸºæœ¬ä½¿ç”¨**

```bash
# è¿è¡Œçˆ¬è™«ï¼ˆä¼šè‡ªåŠ¨æ£€æµ‹æ•æ„Ÿä¿¡æ¯ï¼‰
./spider -url https://example.com

# æŸ¥çœ‹ç»“æœ
type spider_example.com_*_sensitive.txt
```

### **ç¤ºä¾‹2ï¼šè‡ªå®šä¹‰è§„åˆ™**

```bash
# ä½¿ç”¨è‡ªå®šä¹‰è§„åˆ™æ–‡ä»¶
./spider -url https://example.com -sensitive-rules my_rules.json
```

### **ç¤ºä¾‹3ï¼šæ‰¹é‡æ‰«æ**

```bash
# æ‰¹é‡æ‰«æå¤šä¸ªç›®æ ‡
./spider -batch-file targets.txt

# æ¯ä¸ªç›®æ ‡éƒ½ä¼šç”Ÿæˆç‹¬ç«‹çš„æ•æ„Ÿä¿¡æ¯æŠ¥å‘Š
```

---

## ğŸ“Š **å®é™…è¾“å‡ºç¤ºä¾‹**

### **æ–‡æœ¬æŠ¥å‘Šï¼ˆspider_*_sensitive.txtï¼‰**

```
==========================================
   æ•æ„Ÿä¿¡æ¯æ³„éœ²æ£€æµ‹æŠ¥å‘Š
==========================================

æ‰«æé¡µé¢æ•°: 150
å‘ç°æ€»æ•°: 12
  - é«˜å±: 2
  - ä¸­å±: 6
  - ä½å±: 4

==========================================

ã€é«˜å±å‘ç°ã€‘
------------------------------------------------------------

[1] APIå¯†é’¥æ³„éœ²
    æ¥æºURL: https://example.com/js/config.js
    ä½ç½®: Line 15
    å€¼: AIza****************************xyz

[2] æ•°æ®åº“è¿æ¥å¯†ç 
    æ¥æºURL: https://example.com/config/database.php
    ä½ç½®: Line 8
    å€¼: db_p****word

ã€ä¸­å±å‘ç°ã€‘
------------------------------------------------------------

[3] å†…éƒ¨IPåœ°å€
    æ¥æºURL: https://example.com/admin/dashboard
    ä½ç½®: Line 45
    å€¼: 192.168.1.100

[4] é‚®ç®±åœ°å€
    æ¥æºURL: https://example.com/contact.html
    ä½ç½®: Line 89
    å€¼: admin@example.com
```

### **JSONæŠ¥å‘Šï¼ˆsensitive_*.jsonï¼‰**

```json
{
  "scan_time": "2025-10-28 15:36:37",
  "target_domain": "example.com",
  "statistics": {
    "total_findings": 12,
    "high_severity": 2,
    "medium_severity": 6,
    "low_severity": 4
  },
  "findings": [
    {
      "type": "APIå¯†é’¥æ³„éœ²",
      "value": "AIza****************************xyz",
      "source_url": "https://example.com/js/config.js",
      "location": "Line 15",
      "severity": "HIGH"
    }
  ]
}
```

---

## âœ… **æ€»ç»“**

æ‚¨æå‡ºçš„æ‰€æœ‰è¦æ±‚**éƒ½å·²å®Œå…¨å®ç°**ï¼š

1. âœ… **ç‹¬ç«‹ä¿å­˜**ï¼šæ•æ„Ÿä¿¡æ¯ä¿å­˜åœ¨å•ç‹¬æ–‡ä»¶ä¸­
2. âœ… **å®Œæ•´è®°å½•**ï¼šæ¯æ¡è®°å½•éƒ½åŒ…å«æ¥æºURLå’Œä¿¡æ¯ç±»å‹
3. âœ… **å…¨é¢æ£€æµ‹**ï¼šé’ˆå¯¹æ¯ä¸ªè¿”å›æ•°æ®åŒ…è¿›è¡Œæ£€æµ‹
4. âœ… **ç»Ÿä¸€åŠŸèƒ½**ï¼šé€šè¿‡ç»Ÿä¸€çš„æ£€æµ‹å™¨å’Œé…ç½®ç®¡ç†

**å»ºè®®ï¼š**
- è¿è¡Œ `æµ‹è¯•æ•æ„Ÿä¿¡æ¯æ£€æµ‹.bat` ç«‹å³æŸ¥çœ‹æ•ˆæœ
- æŸ¥çœ‹ç”Ÿæˆçš„HTMLæŠ¥å‘Šï¼ˆæœ€ç›´è§‚ï¼‰
- æ ¹æ®éœ€è¦è‡ªå®šä¹‰è§„åˆ™æ–‡ä»¶

---

**GogoSpider v4.2** - ä¸“ä¸šçš„æ•æ„Ÿä¿¡æ¯æ£€æµ‹ç³»ç»Ÿï¼

ç”Ÿæˆæ—¶é—´ï¼š2025-10-28

