# GogoSpider v3.4 配置说明

## 🚀 快速开始

**只需一个配置文件：`config.json`**

### 默认运行（使用混合策略）

```bash
# 方式1：使用config.json（推荐）
spider.exe -url http://x.lydaas.com -config config.json

# 方式2：仅命令行参数（使用默认配置）
spider.exe -url http://x.lydaas.com
```

---

## ⚙️ 核心配置

### 1. 调度策略（默认：HYBRID混合策略）

**位置**：`scheduling_settings.algorithm`

**默认值**：`"HYBRID"` ✨ (广度优先 + 优先级策略 + 自适应学习)

**可选值**：
- `"HYBRID"` - 混合策略（推荐，默认）
- `"BFS"` - 纯广度优先
- `"PRIORITY_QUEUE"` - 纯优先级队列

**混合策略特点**：
- ✅ 保留BFS的全面覆盖
- ✅ 智能优先级排序（高价值URL优先）
- ✅ 自适应学习（越爬越聪明）

---

### 2. 目标URL

**位置**：`target_url`

**修改方式**：
```json
{
  "target_url": "http://你的目标网站.com"
}
```

或命令行指定（会覆盖配置文件）：
```bash
spider.exe -url http://目标网站.com -config config.json
```

---

### 3. 爬取深度

**位置**：`depth_settings.max_depth`

**默认值**：`5`

**推荐值**：
- 快速扫描：2-3
- 深度扫描：5-10
- 全量扫描：10-20

---

### 4. 优先级权重（混合策略专属）

**位置**：`scheduling_settings.hybrid_config.priority_weights`

**6个维度权重**（数值越大，影响越大）：

| 权重 | 默认值 | 说明 | 调整建议 |
|------|--------|------|----------|
| `depth` | 3.0 | 浅层优先 | API发现场景：降低到2.0 |
| `internal` | 2.0 | 域内链接优先 | 深度爬取：提升到3.0 |
| `params` | 1.5 | 带参数URL优先 | API发现：提升到3.0 |
| `recent` | 1.0 | 新发现URL优先 | 保持默认 |
| `path_value` | 4.0 | 高价值路径优先 | 安全审计：提升到5.0 |
| `business_value` | 0.5 | 业务价值优先 | 结合业务过滤器使用 |

---

## 📋 常见场景配置

### 场景1: API接口发现（快速发现所有API）

修改 `config.json`：
```json
{
  "scheduling_settings": {
    "algorithm": "HYBRID",
    "hybrid_config": {
      "priority_weights": {
        "params": 3.0,
        "path_value": 5.0
      }
    }
  },
  "scope_settings": {
    "include_paths": ["/api/*", "/v1/*", "/v2/*", "/graphql"]
  }
}
```

### 场景2: 安全审计（优先高价值URL）

```json
{
  "scheduling_settings": {
    "algorithm": "HYBRID",
    "hybrid_config": {
      "high_value_threshold": 70.0,
      "max_urls_per_layer": 50,
      "priority_weights": {
        "path_value": 5.0,
        "business_value": 1.0
      }
    }
  }
}
```

### 场景3: 全量快速扫描

```json
{
  "scheduling_settings": {
    "algorithm": "HYBRID",
    "hybrid_config": {
      "max_urls_per_layer": 200,
      "priority_weights": {
        "depth": 4.0,
        "internal": 3.0
      }
    }
  },
  "depth_settings": {
    "max_depth": 10
  }
}
```

---

## 🤖 自适应学习

**位置**：`scheduling_settings.hybrid_config.enable_adaptive_learning`

**默认值**：`true` ✅

**学习机制**：
- 每爬取50个URL评估一次
- 自动调整优先级权重
- 根据实际效果优化策略

**效果示例**：
```
🤖 [自适应学习] API发现率较高(35.2%),可增强参数权重
✅ 权重已优化，下一层将使用新权重
```

**关闭学习**：
```json
{
  "hybrid_config": {
    "enable_adaptive_learning": false
  }
}
```

---

## 🎯 其他重要配置

### 性能配置

```json
{
  "scheduling_settings": {
    "performance_config": {
      "max_concurrent_requests": 20,
      "request_timeout": 30,
      "max_retry": 3
    }
  }
}
```

### 反爬虫配置

```json
{
  "anti_detection_settings": {
    "request_delay": 500000000,
    "user_agents": ["..."],
    "proxies": []
  },
  "rate_limit_settings": {
    "enabled": false,
    "requests_per_second": 100
  }
}
```

### 去重配置

```json
{
  "deduplication_settings": {
    "similarity_threshold": 0.85,
    "enable_smart_param_dedup": true,
    "enable_business_aware_filter": true
  }
}
```

---

## ⚠️ 常见问题

### Q1: 运行报错"目标URL不能为空"？

**A**: 确保config.json中的`target_url`不为空，或使用命令行参数：
```bash
spider.exe -url http://目标网站.com -config config.json
```

### Q2: 如何切换回纯BFS算法？

**A**: 修改`scheduling_settings.algorithm`为`"BFS"`

### Q3: 混合策略会影响性能吗？

**A**: 不会。混合策略只在每层内部排序，性能与BFS相当，甚至更快（优先爬取高价值URL）

### Q4: 自适应学习可以关闭吗？

**A**: 可以，设置`enable_adaptive_learning: false`

---

## 📂 配置文件结构

```
config.json（唯一配置文件，包含所有功能）
├── target_url（目标URL）
├── depth_settings（深度配置）
├── scheduling_settings（✨ 调度策略配置）
│   ├── algorithm（算法选择：HYBRID/BFS/PRIORITY_QUEUE）
│   ├── hybrid_config（混合策略配置）
│   │   ├── enable_adaptive_learning（自适应学习）
│   │   ├── priority_weights（6个优先级权重）
│   │   ├── max_urls_per_layer（每层URL限制）
│   │   └── high_value_threshold（高价值阈值）
│   └── performance_config（性能配置）
├── strategy_settings（爬取策略）
├── anti_detection_settings（反爬配置）
├── deduplication_settings（去重配置）
├── scope_settings（作用域配置）
├── sensitive_detection_settings（敏感信息检测）
├── advanced_settings（✨ 高级功能配置）
└── output_advanced（✨ 输出增强配置）
```

---

## 🎓 最佳实践

1. **首次使用** → 使用默认配置（HYBRID算法）
2. **API发现** → 增加`params`和`path_value`权重
3. **安全审计** → 设置`high_value_threshold`，优先高价值URL
4. **大型站点** → 设置`max_urls_per_layer`限制每层URL数
5. **隐蔽扫描** → 启用`rate_limit`，降低并发数
6. **启用学习** → 保持`enable_adaptive_learning: true`

---

## 📚 更多文档

- `混合策略使用指南.md` - 详细的使用指南
- `项目深度分析与优化方案.md` - 技术细节
- `FINAL_REPORT_优化完成.md` - 完整优化报告

---

**🎉 享受更智能的爬虫体验！**

**默认算法**：HYBRID（混合策略） = 广度优先 + 优先级策略 + 自适应学习

