# æ™ºèƒ½å‚æ•°å€¼å»é‡ç®—æ³•è®¾è®¡

## ğŸ¯ è®¾è®¡ç›®æ ‡

**ç”¨æˆ·éœ€æ±‚**: 
- å‚æ•°å­—æ®µç›¸åŒä½†å€¼ä¸åŒçš„URLï¼Œå¦‚æœå‚æ•°å€¼ç‰¹å¾ç›¸ä¼¼ï¼ˆå¦‚é•¿åº¦ç›¸åŒï¼‰ï¼Œè¶…è¿‡Nä¸ªå°±è·³è¿‡
- é¿å…å¤§é‡æ— æ„ä¹‰çš„URLé‡å¤çˆ¬å–

**ç¤ºä¾‹**:
```
http://test.com?id=1234567890  (10ä½æ•°å­—) âœ… çˆ¬å–
http://test.com?id=9876543210  (10ä½æ•°å­—) âœ… çˆ¬å–
http://test.com?id=5555555555  (10ä½æ•°å­—) âœ… çˆ¬å– (ç¬¬3ä¸ª)
http://test.com?id=1111111111  (10ä½æ•°å­—) âŒ è·³è¿‡ (å·²æœ‰3ä¸ªç›¸ä¼¼çš„)
http://test.com?id=2222222222  (10ä½æ•°å­—) âŒ è·³è¿‡
```

---

## ğŸ“ ç®—æ³•è®¾è®¡

### æ ¸å¿ƒæ¦‚å¿µ

#### 1. URLæ¨¡å¼ (Pattern)

**å®šä¹‰**: URLçš„è·¯å¾„ + å‚æ•°åï¼ˆä¸åŒ…å«å‚æ•°å€¼ï¼‰

**ç¤ºä¾‹**:
```
http://test.com?id=1        â†’ æ¨¡å¼: http://test.com?id
http://test.com?id=2        â†’ æ¨¡å¼: http://test.com?id (ç›¸åŒ)
http://test.com?id=admin    â†’ æ¨¡å¼: http://test.com?id (ç›¸åŒ)

http://test.com?id=1&page=1 â†’ æ¨¡å¼: http://test.com?id&page
http://test.com?id=2&page=2 â†’ æ¨¡å¼: http://test.com?id&page (ç›¸åŒ)
```

#### 2. å‚æ•°å€¼ç‰¹å¾ (Value Feature)

**å®šä¹‰**: å‚æ•°å€¼çš„åˆ†ç±»æ ‡ç­¾ï¼ŒåŸºäºé•¿åº¦å’Œç±»å‹

**åˆ†ç±»ç»´åº¦**:

##### A. æ•°å­—å‹ï¼ˆæŒ‰é•¿åº¦ï¼‰
- `num_1_5`: 1-5ä½æ•°å­— (ä¾‹: 1, 123, 12345)
- `num_6_10`: 6-10ä½æ•°å­— (ä¾‹: 123456, 1234567890)
- `num_11_20`: 11-20ä½æ•°å­— (ä¾‹: æ‰‹æœºå·13800138000)
- `num_20+`: 20ä½ä»¥ä¸Šæ•°å­— (ä¾‹: æ—¶é—´æˆ³)

##### B. å­—æ¯å‹ï¼ˆæŒ‰é•¿åº¦ï¼‰
- `alpha_1_5`: 1-5ä½å­—æ¯ (ä¾‹: admin, test, user)
- `alpha_6_10`: 6-10ä½å­—æ¯ (ä¾‹: username, password)
- `alpha_11+`: 11ä½ä»¥ä¸Šå­—æ¯ (ä¾‹: administrator)

##### C. æ··åˆå‹
- `alphanum`: å­—æ¯æ•°å­—æ··åˆ (ä¾‹: user123, abc456)

##### D. ç‰¹æ®Šæ ¼å¼
- `uuid`: UUIDæ ¼å¼ (ä¾‹: 550e8400-e29b-41d4-a716-446655440000)
- `md5`: MD5å“ˆå¸Œ (ä¾‹: 5d41402abc4b2a76b9719d911017c592)
- `sha1`: SHA1å“ˆå¸Œ (40ä½hex)
- `sha256`: SHA256å“ˆå¸Œ (64ä½hex)
- `base64`: Base64ç¼–ç 
- `hex`: åå…­è¿›åˆ¶å­—ç¬¦ä¸²

##### E. å®‰å…¨æµ‹è¯•
- `path_trav`: è·¯å¾„ç©¿è¶Š (ä¾‹: ../, ../../etc/passwd)
- `special`: ç‰¹æ®Šå­—ç¬¦ (ä¾‹: <script>, ' OR '1'='1)

##### F. å…¶ä»–
- `empty`: ç©ºå€¼
- `other`: å…¶ä»–ç±»å‹

#### 3. ç‰¹å¾ç»„è®¡æ•°

**æ•°æ®ç»“æ„**:
```go
PatternInfo {
    Pattern: "http://test.com?id"
    ValueGroups: {
        "num_6_10": 3,      // å·²çˆ¬å–3ä¸ª6-10ä½æ•°å­—
        "alpha_1_5": 2,     // å·²çˆ¬å–2ä¸ª1-5ä½å­—æ¯
        "path_trav": 1,     // å·²çˆ¬å–1ä¸ªè·¯å¾„ç©¿è¶Š
    }
    AllValues: ["1234567890", "9876543210", "5555555555", "admin", "test", "../"]
}
```

---

## ğŸ”„ ç®—æ³•æµç¨‹

### ä¸»æµç¨‹

```
è¾“å…¥: URL = http://test.com?id=1234567890

ç¬¬1æ­¥: æå–URLæ¨¡å¼
  â†“
Pattern = "http://test.com?id"
ParamValue = "1234567890"

ç¬¬2æ­¥: æ£€æŸ¥æ˜¯å¦ä¸ºæ–°æ¨¡å¼
  â†“
å¦‚æœæ˜¯æ–°æ¨¡å¼ â†’ åˆå§‹åŒ– â†’ å…è®¸çˆ¬å– â†’ ç»“æŸ

ç¬¬3æ­¥: å¯¹å‚æ•°å€¼åˆ†ç±»
  â†“
ValueClass = ClassifyParamValue("1234567890")
           = "num_6_10" (6-10ä½æ•°å­—)

ç¬¬4æ­¥: æ£€æŸ¥è¯¥ç‰¹å¾ç»„çš„è®¡æ•°
  â†“
CurrentCount = PatternInfo.ValueGroups["num_6_10"]
             = 2 (å·²çˆ¬å–2ä¸ª)

ç¬¬5æ­¥: åˆ¤æ–­æ˜¯å¦è¾¾åˆ°é™åˆ¶
  â†“
å¦‚æœ CurrentCount >= MaxPerGroup(3):
    âœ— è·³è¿‡è¯¥URL
å¦åˆ™:
    âœ“ å…è®¸çˆ¬å–
    âœ“ æ›´æ–°è®¡æ•°: ValueGroups["num_6_10"]++
```

---

## ğŸ“Š å®é™…æ¡ˆä¾‹æ¼”ç¤º

### æ¡ˆä¾‹1: XSS Quizç«™ç‚¹

**å‘ç°çš„URLåºåˆ—**:
```
1. https://xss-quiz.int21h.jp/?id=1
2. https://xss-quiz.int21h.jp/?id=2
3. https://xss-quiz.int21h.jp/?id=123
4. https://xss-quiz.int21h.jp/?id=12345
5. https://xss-quiz.int21h.jp/?id=admin
6. https://xss-quiz.int21h.jp/?id=test
7. https://xss-quiz.int21h.jp/?id=user
8. https://xss-quiz.int21h.jp/?id=debug
9. https://xss-quiz.int21h.jp/?id=1234567890
10. https://xss-quiz.int21h.jp/?id=9876543210
11. https://xss-quiz.int21h.jp/?id=5555555555
12. https://xss-quiz.int21h.jp/?id=..%2F
```

**æ™ºèƒ½å»é‡å¤„ç†** (maxPerGroup=3):
```
URLæ¨¡å¼: https://xss-quiz.int21h.jp/?id

åºå·1: ?id=1
  ç‰¹å¾: num_1_5 (1-5ä½æ•°å­—)
  è®¡æ•°: 1/3
  ç»“æœ: âœ… çˆ¬å–

åºå·2: ?id=2
  ç‰¹å¾: num_1_5
  è®¡æ•°: 2/3
  ç»“æœ: âœ… çˆ¬å–

åºå·3: ?id=123
  ç‰¹å¾: num_1_5
  è®¡æ•°: 3/3
  ç»“æœ: âœ… çˆ¬å–

åºå·4: ?id=12345
  ç‰¹å¾: num_1_5
  è®¡æ•°: å·²è¾¾é™åˆ¶ (3/3)
  ç»“æœ: âŒ è·³è¿‡ï¼(ç›¸åŒç‰¹å¾å·²æœ‰3ä¸ª)

åºå·5: ?id=admin
  ç‰¹å¾: alpha_1_5 (1-5ä½å­—æ¯)
  è®¡æ•°: 1/3
  ç»“æœ: âœ… çˆ¬å– (æ–°ç‰¹å¾ç»„)

åºå·6: ?id=test
  ç‰¹å¾: alpha_1_5
  è®¡æ•°: 2/3
  ç»“æœ: âœ… çˆ¬å–

åºå·7: ?id=user
  ç‰¹å¾: alpha_1_5
  è®¡æ•°: 3/3
  ç»“æœ: âœ… çˆ¬å–

åºå·8: ?id=debug
  ç‰¹å¾: alpha_1_5
  è®¡æ•°: å·²è¾¾é™åˆ¶ (3/3)
  ç»“æœ: âŒ è·³è¿‡ï¼

åºå·9: ?id=1234567890
  ç‰¹å¾: num_6_10 (6-10ä½æ•°å­—)
  è®¡æ•°: 1/3
  ç»“æœ: âœ… çˆ¬å– (æ–°ç‰¹å¾ç»„)

åºå·10: ?id=9876543210
  ç‰¹å¾: num_6_10
  è®¡æ•°: 2/3
  ç»“æœ: âœ… çˆ¬å–

åºå·11: ?id=5555555555
  ç‰¹å¾: num_6_10
  è®¡æ•°: 3/3
  ç»“æœ: âœ… çˆ¬å–

åºå·12: ?id=..%2F
  ç‰¹å¾: path_trav (è·¯å¾„ç©¿è¶Š)
  è®¡æ•°: 1/3
  ç»“æœ: âœ… çˆ¬å– (æ–°ç‰¹å¾ç»„)
```

**ç»Ÿè®¡**:
```
å‘ç°URL: 12ä¸ª
å®é™…çˆ¬å–: 9ä¸ª (75%)
æ™ºèƒ½è·³è¿‡: 3ä¸ª (25%)

ç‰¹å¾ç»„åˆ†å¸ƒ:
  - num_1_5: 3ä¸ª (è¾¾åˆ°é™åˆ¶)
  - alpha_1_5: 3ä¸ª (è¾¾åˆ°é™åˆ¶)
  - num_6_10: 3ä¸ª (è¾¾åˆ°é™åˆ¶)
  - path_trav: 1ä¸ª

èŠ‚çœè¯·æ±‚: 25%
```

---

### æ¡ˆä¾‹2: å¤§å‹ç”µå•†ç½‘ç«™

**å•†å“ID URL**:
```
http://shop.com/product?id=10001
http://shop.com/product?id=10002
http://shop.com/product?id=10003
... (1000ä¸ªç±»ä¼¼çš„å•†å“ID)
```

**æ™ºèƒ½å»é‡æ•ˆæœ** (maxPerGroup=3):
```
URLæ¨¡å¼: http://shop.com/product?id

1. ?id=10001  â†’ num_1_5 â†’ çˆ¬å– âœ…
2. ?id=10002  â†’ num_1_5 â†’ çˆ¬å– âœ…
3. ?id=10003  â†’ num_1_5 â†’ çˆ¬å– âœ…
4. ?id=10004  â†’ num_1_5 â†’ è·³è¿‡ âŒ
...
1000. ?id=11000 â†’ num_1_5 â†’ è·³è¿‡ âŒ

ç»“æœ: 1000ä¸ªURL â†’ å®é™…çˆ¬å–3ä¸ª
èŠ‚çœ: 99.7%
```

---

## âš™ï¸ é…ç½®å‚æ•°

### æ–°å¢é…ç½®é¡¹

```json
{
  "deduplication_settings": {
    "similarity_threshold": 0.85,
    "enable_dom_deduplication": true,
    "enable_url_pattern_recognition": true,
    
    "_new_feature": "æ™ºèƒ½å‚æ•°å€¼å»é‡",
    "enable_smart_param_dedup": true,
    "_smart_dedup_desc": "å¯ç”¨æ™ºèƒ½å‚æ•°å€¼å»é‡ï¼Œé¿å…ç›¸ä¼¼å‚æ•°å€¼çš„é‡å¤çˆ¬å–",
    
    "max_param_value_variants_per_group": 3,
    "_max_variants_desc": "æ¯ä¸ªå‚æ•°å€¼ç‰¹å¾ç»„æœ€å¤šçˆ¬å–å¤šå°‘ä¸ªURL",
    "_max_variants_example": "å¯¹äº10ä½æ•°å­—çš„idå‚æ•°ï¼Œæœ€å¤šçˆ¬å–3ä¸ªä¸åŒçš„å€¼"
  }
}
```

### é…ç½®è¯´æ˜

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ | ç¤ºä¾‹æ•ˆæœ |
|------|--------|------|---------|
| `enable_smart_param_dedup` | `true` | æ˜¯å¦å¯ç”¨æ™ºèƒ½å»é‡ | true=å¯ç”¨, false=ç¦ç”¨ |
| `max_param_value_variants_per_group` | `3` | æ¯ç»„æœ€å¤šçˆ¬å–æ•°é‡ | 3=æ¯ç§ç‰¹å¾æœ€å¤š3ä¸ª |

**è°ƒä¼˜å»ºè®®**:
- `1`: æåº¦ä¿å®ˆï¼ˆå¯èƒ½æ¼æ‰æœ‰ä»·å€¼çš„URLï¼‰
- `3`: æ¨èé»˜è®¤ï¼ˆå¹³è¡¡è¦†ç›–å’Œæ•ˆç‡ï¼‰
- `5`: å®½æ¾æ¨¡å¼ï¼ˆæ›´å…¨é¢ä½†ç¨æ…¢ï¼‰
- `10+`: å‡ ä¹ç­‰äºç¦ç”¨ï¼ˆä¸æ¨èï¼‰

---

## ğŸ“Š æ•ˆæœé¢„æµ‹

### åœºæ™¯1: å‚æ•°çˆ†ç ´ç”Ÿæˆçš„URL

**ä¼˜åŒ–å‰**:
```
åŸå§‹: http://test.com
å‚æ•°çˆ†ç ´ç”Ÿæˆ:
  ?id=1, ?id=2, ?id=admin, ?id=test, ?id=debug, ?id=123
  ?page=1, ?page=2, ...
  å…±37ä¸ªå˜ä½“ â†’ å…¨éƒ¨çˆ¬å–
```

**ä¼˜åŒ–å**:
```
å‚æ•°çˆ†ç ´ç”Ÿæˆ:
  ?id=1 (num_1_5) â†’ çˆ¬å– âœ…
  
æ™ºèƒ½å»é‡:
  ?id=2 (num_1_5) â†’ è·³è¿‡ âŒ (å·²æœ‰num_1_5ç‰¹å¾)
  ?id=admin (alpha_1_5) â†’ çˆ¬å– âœ… (æ–°ç‰¹å¾)
  ?id=test (alpha_1_5) â†’ è·³è¿‡ âŒ
  
å…±7ä¸ªå‚æ•°å Ã— 1ä¸ªç‰¹å¾ä»£è¡¨ = 7ä¸ªURL
```

**ç»“æœ**: 37ä¸ª â†’ 7ä¸ª (-81%)

---

### åœºæ™¯2: è‡ªç„¶å‘ç°çš„URLï¼ˆä»æ‚¨çš„æ—¥å¿—ï¼‰

**å‘ç°åºåˆ—**:
```
ç¬¬1å±‚: https://xss-quiz.int21h.jp/
  â†’ å‘ç°é“¾æ¥ï¼Œçˆ¬å–

ç¬¬2å±‚: çˆ¬å–åå‘ç°
  ?id=1
  ?page=1
  ?search=test
  â†’ éƒ½çˆ¬å–ï¼ˆæ–°æ¨¡å¼ï¼‰

ç¬¬3å±‚: å‚æ•°çˆ†ç ´+è‡ªç„¶å‘ç°
  ?id=1 å·²çˆ¬å–
  ?id=2        â†’ num_1_5, 2/3 â†’ çˆ¬å–
  ?id=admin    â†’ alpha_1_5, 1/3 â†’ çˆ¬å–
  ?id=test     â†’ alpha_1_5, 2/3 â†’ çˆ¬å–
  ?id=debug    â†’ alpha_1_5, 3/3 â†’ çˆ¬å–
  ?id=user     â†’ alpha_1_5, 4/3 â†’ è·³è¿‡ âŒ
  ?id=123      â†’ num_1_5, 3/3 â†’ çˆ¬å–
  ?id=12345    â†’ num_1_5, 4/3 â†’ è·³è¿‡ âŒ
  ?id=1234567890 â†’ num_6_10, 1/3 â†’ çˆ¬å–
  ...
```

**ç»Ÿè®¡**:
- å‘ç°: 50ä¸ªç›¸ä¼¼URL
- çˆ¬å–: 15ä¸ª (æ¯ç§ç‰¹å¾3ä¸ª)
- è·³è¿‡: 35ä¸ª
- **èŠ‚çœ: 70%**

---

## ğŸ¨ ç‰¹å¾åˆ†ç±»è¯¦è§£

### æ•°å­—å‹ç‰¹å¾

```go
func classifyNumeric(value string) string {
    length := len(value)
    
    if length <= 5 {
        return "num_1_5"      // å°æ•°å­—: 1, 2, 123, 12345
    } else if length <= 10 {
        return "num_6_10"     // ä¸­æ•°å­—: 123456, 1234567890
    } else if length <= 20 {
        return "num_11_20"    // å¤§æ•°å­—: æ‰‹æœºå·, è®¢å•å·
    } else {
        return "num_20+"      // è¶…å¤§æ•°å­—: æ—¶é—´æˆ³
    }
}
```

**ç¤ºä¾‹**:
```
å€¼: "1"          â†’ num_1_5
å€¼: "123"        â†’ num_1_5   (ç›¸åŒç‰¹å¾)
å€¼: "12345"      â†’ num_1_5   (ç›¸åŒç‰¹å¾)
å€¼: "123456"     â†’ num_6_10  (ä¸åŒç‰¹å¾)
å€¼: "1234567890" â†’ num_6_10  (ç›¸åŒç‰¹å¾)
```

### å­—æ¯å‹ç‰¹å¾

```go
func classifyAlpha(value string) string {
    length := len(value)
    
    if length <= 5 {
        return "alpha_1_5"    // çŸ­å•è¯: admin, test, user
    } else if length <= 10 {
        return "alpha_6_10"   // ä¸­ç­‰å•è¯: username, password
    } else {
        return "alpha_11+"    // é•¿å•è¯: administrator
    }
}
```

**ç¤ºä¾‹**:
```
å€¼: "admin"         â†’ alpha_1_5
å€¼: "test"          â†’ alpha_1_5  (ç›¸åŒç‰¹å¾)
å€¼: "user"          â†’ alpha_1_5  (ç›¸åŒç‰¹å¾)
å€¼: "username"      â†’ alpha_6_10 (ä¸åŒç‰¹å¾)
å€¼: "administrator" â†’ alpha_11+  (ä¸åŒç‰¹å¾)
```

### ç‰¹æ®Šæ ¼å¼è¯†åˆ«

```go
// UUIDæ ¼å¼
"550e8400-e29b-41d4-a716-446655440000" â†’ uuid

// MD5å“ˆå¸Œ
"5d41402abc4b2a76b9719d911017c592" â†’ md5

// è·¯å¾„ç©¿è¶Š
"../"                â†’ path_trav
"../../etc/passwd"   â†’ path_trav (ç›¸åŒç‰¹å¾)
"../config.php"      â†’ path_trav (ç›¸åŒç‰¹å¾)
```

---

## ğŸ¯ åˆ¤æ–­é€»è¾‘ç¤ºä¾‹

### ä¼ªä»£ç 

```python
class SmartParamDedup:
    def __init__(self, max_per_group=3):
        self.patterns = {}  # URLæ¨¡å¼ -> PatternInfo
        self.max_per_group = max_per_group
    
    def should_crawl(self, url):
        # 1. æå–æ¨¡å¼å’Œå‚æ•°å€¼
        pattern = extract_pattern(url)  # "http://test.com?id"
        param_value = extract_value(url)  # "1234567890"
        
        # 2. æ–°æ¨¡å¼ï¼Œå…è®¸çˆ¬å–
        if pattern not in self.patterns:
            self.patterns[pattern] = {
                'value_groups': {},
                'all_values': []
            }
            self.patterns[pattern]['all_values'].append(param_value)
            feature = classify_value(param_value)
            self.patterns[pattern]['value_groups'][feature] = 1
            return True, f"æ–°æ¨¡å¼ï¼Œå…è®¸çˆ¬å–"
        
        # 3. å¯¹å‚æ•°å€¼åˆ†ç±»
        feature = classify_value(param_value)  # "num_6_10"
        
        # 4. æ£€æŸ¥è®¡æ•°
        count = self.patterns[pattern]['value_groups'].get(feature, 0)
        
        if count >= self.max_per_group:
            return False, f"ç‰¹å¾ {feature} å·²è¾¾é™åˆ¶ {count}/{self.max_per_group}"
        
        # 5. å…è®¸çˆ¬å–ï¼Œæ›´æ–°è®¡æ•°
        self.patterns[pattern]['value_groups'][feature] = count + 1
        self.patterns[pattern]['all_values'].append(param_value)
        
        return True, f"ç‰¹å¾ {feature} è®¡æ•° {count+1}/{self.max_per_group}"
```

---

## ğŸ’» å®Œæ•´å®ç°ä»£ç 

æˆ‘å·²åˆ›å»ºæ–‡ä»¶: `core/smart_param_dedup.go`

**æ ¸å¿ƒåŠŸèƒ½**:
1. âœ… `NewSmartParamDeduplicator()` - åˆ›å»ºå»é‡å™¨
2. âœ… `ShouldCrawl(url)` - åˆ¤æ–­æ˜¯å¦åº”è¯¥çˆ¬å–
3. âœ… `classifyParamValue()` - å‚æ•°å€¼åˆ†ç±»
4. âœ… `extractURLPattern()` - URLæ¨¡å¼æå–
5. âœ… `GetStatistics()` - è·å–ç»Ÿè®¡ä¿¡æ¯
6. âœ… `PrintStatistics()` - æ‰“å°å»é‡æ•ˆæœ

---

## ğŸ”§ é›†æˆæ–¹æ¡ˆ

### éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶

#### 1. ä¿®æ”¹ `config/config.go`

æ·»åŠ æ–°çš„é…ç½®é¡¹ï¼š

```go
type DeduplicationSettings struct {
    SimilarityThreshold         float64
    EnableDOMDeduplication      bool
    EnableURLPatternRecognition bool
    
    // æ–°å¢ï¼šæ™ºèƒ½å‚æ•°å€¼å»é‡
    EnableSmartParamDedup            bool   // æ˜¯å¦å¯ç”¨
    MaxParamValueVariantsPerGroup    int    // æ¯ç»„æœ€å¤šçˆ¬å–æ•°é‡
}
```

é»˜è®¤é…ç½®ï¼š

```go
DeduplicationSettings: DeduplicationSettings{
    SimilarityThreshold:              0.85,
    EnableDOMDeduplication:           true,
    EnableURLPatternRecognition:      true,
    EnableSmartParamDedup:            true,  // é»˜è®¤å¯ç”¨
    MaxParamValueVariantsPerGroup:    3,    // é»˜è®¤æ¯ç»„3ä¸ª
},
```

#### 2. ä¿®æ”¹ `core/spider.go`

åœ¨Spiderç»“æ„ä½“ä¸­æ·»åŠ æ™ºèƒ½å»é‡å™¨ï¼š

```go
type Spider struct {
    config           *config.Config
    duplicateHandler *DuplicateHandler
    smartParamDedup  *SmartParamDeduplicator  // æ–°å¢
    // ...
}

func NewSpider(cfg *config.Config) *Spider {
    return &Spider{
        config:           cfg,
        duplicateHandler: NewDuplicateHandler(0.9),
        smartParamDedup:  NewSmartParamDeduplicator(
            cfg.DeduplicationSettings.MaxParamValueVariantsPerGroup,
            cfg.DeduplicationSettings.EnableSmartParamDedup,
        ),
        // ...
    }
}
```

#### 3. ä¿®æ”¹çˆ¬å–é€»è¾‘

åœ¨æ·»åŠ URLåˆ°é˜Ÿåˆ—å‰è¿›è¡Œæ™ºèƒ½å»é‡ï¼š

```go
func (s *Spider) shouldCrawlURL(url string) bool {
    // 1. åŸºç¡€URLå»é‡
    if s.duplicateHandler.IsDuplicateURL(url) {
        return false
    }
    
    // 2. æ™ºèƒ½å‚æ•°å€¼å»é‡
    if s.config.DeduplicationSettings.EnableSmartParamDedup {
        shouldCrawl, reason := s.smartParamDedup.ShouldCrawl(url)
        if !shouldCrawl {
            fmt.Printf("[æ™ºèƒ½å»é‡] è·³è¿‡URL: %s\n  åŸå› : %s\n", url, reason)
            return false
        }
    }
    
    return true
}
```

---

## ğŸ“ˆ é¢„æœŸæ•ˆæœ

### æ•ˆæœå¯¹æ¯”

| åœºæ™¯ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æ”¹å–„ |
|------|--------|--------|------|
| **å‚æ•°çˆ†ç ´** | 37ä¸ªå˜ä½“ | 7-10ä¸ª | -70-80% |
| **å•†å“åˆ—è¡¨** | 1000ä¸ªå•†å“ID | 3ä¸ªä»£è¡¨ | -99.7% |
| **ç”¨æˆ·åˆ—è¡¨** | 500ä¸ªç”¨æˆ·ID | 3ä¸ªä»£è¡¨ | -99.4% |
| **å“ˆå¸ŒURL** | 100ä¸ªMD5 | 3ä¸ªMD5 | -97% |
| **ç»¼åˆåœºæ™¯** | å¤§é‡é‡å¤ | ç²¾ç®€é«˜æ•ˆ | -80-95% |

### æ—¥å¿—è¾“å‡ºç¤ºä¾‹

**ä¼˜åŒ–åçš„æ—¥å¿—**:
```
[æ™ºèƒ½å»é‡] URLæ¨¡å¼: https://xss-quiz.int21h.jp/?id
[æ™ºèƒ½å»é‡] å‚æ•°å€¼: 1, ç‰¹å¾: num_1_5, è®¡æ•°: 1/3 â†’ å…è®¸çˆ¬å–

[æ™ºèƒ½å»é‡] URLæ¨¡å¼: https://xss-quiz.int21h.jp/?id
[æ™ºèƒ½å»é‡] å‚æ•°å€¼: 2, ç‰¹å¾: num_1_5, è®¡æ•°: 2/3 â†’ å…è®¸çˆ¬å–

[æ™ºèƒ½å»é‡] URLæ¨¡å¼: https://xss-quiz.int21h.jp/?id
[æ™ºèƒ½å»é‡] å‚æ•°å€¼: 123, ç‰¹å¾: num_1_5, è®¡æ•°: 3/3 â†’ å…è®¸çˆ¬å–

[æ™ºèƒ½å»é‡] è·³è¿‡URL: https://xss-quiz.int21h.jp/?id=12345
  åŸå› : ç‰¹å¾ç»„ 'num_1_5' å·²è¾¾é™åˆ¶ (3/3)

[æ™ºèƒ½å»é‡] URLæ¨¡å¼: https://xss-quiz.int21h.jp/?id
[æ™ºèƒ½å»é‡] å‚æ•°å€¼: admin, ç‰¹å¾: alpha_1_5, è®¡æ•°: 1/3 â†’ å…è®¸çˆ¬å–

...

============================================================
           æ™ºèƒ½å‚æ•°å»é‡ç»Ÿè®¡
============================================================
çŠ¶æ€:               true
æ¯ç»„æœ€å¤§æ•°é‡:       3
URLæ¨¡å¼æ€»æ•°:        5
------------------------------------------------------------

æ¨¡å¼ 1: https://xss-quiz.int21h.jp/?id
  å‘ç°å€¼æ€»æ•°: 25
  å®é™…çˆ¬å–:   9
  æ™ºèƒ½è·³è¿‡:   16
  ç‰¹å¾ç»„åˆ†å¸ƒ:
    - num_1_5: 3ä¸ª
    - alpha_1_5: 3ä¸ª
    - num_6_10: 3ä¸ª
============================================================
```

---

## âœ… æ€»ç»“

### ç®—æ³•ä¼˜åŠ¿

âœ… **æ™ºèƒ½è¯†åˆ«**: è‡ªåŠ¨è¯†åˆ«å‚æ•°å€¼ç±»å‹å’Œé•¿åº¦  
âœ… **ç²¾å‡†å»é‡**: åŸºäºç‰¹å¾åˆ†ç»„ï¼Œä¸æ˜¯ç®€å•çš„å€¼æ¯”è¾ƒ  
âœ… **è¦†ç›–å…¨é¢**: ä¿ç•™æ¯ç§ç‰¹å¾çš„ä»£è¡¨æ€§URL  
âœ… **æ•ˆç‡æå‡**: å‡å°‘70-99%çš„æ— æ„ä¹‰çˆ¬å–  
âœ… **å¯é…ç½®**: çµæ´»è°ƒæ•´æ¯ç»„æœ€å¤§æ•°é‡  

### æ ¸å¿ƒæœºåˆ¶

**URLæ¨¡å¼**: `è·¯å¾„ + å‚æ•°å`ï¼ˆå¿½ç•¥å‚æ•°å€¼ï¼‰  
**å‚æ•°å€¼ç‰¹å¾**: `é•¿åº¦åˆ†ç±» + ç±»å‹åˆ†ç±»`  
**é™åˆ¶è§„åˆ™**: æ¯ä¸ªæ¨¡å¼çš„æ¯ç§ç‰¹å¾æœ€å¤šçˆ¬å–Nä¸ª  

### ä¸‹ä¸€æ­¥

æˆ‘å·²ç»åˆ›å»ºäº†å®Œæ•´çš„å®ç°ä»£ç  `core/smart_param_dedup.go`ã€‚

éœ€è¦æˆ‘ç»§ç»­é›†æˆåˆ°ä¸»ç¨‹åºä¸­å¹¶é‡æ–°ç¼–è¯‘å—ï¼Ÿ
