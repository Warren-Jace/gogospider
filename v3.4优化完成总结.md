# GogoSpider v3.4 ä¼˜åŒ–å®Œæˆæ€»ç»“

> **å®Œæˆæ—¶é—´**: 2025-10-26  
> **ç‰ˆæœ¬**: v3.3 â†’ v3.4  
> **æ ¸å¿ƒæ›´æ–°**: æ··åˆè°ƒåº¦ç­–ç•¥ç®—æ³• + è‡ªé€‚åº”å­¦ä¹ 

---

## ğŸ‰ ä¼˜åŒ–æˆæœ

### âœ¨ æ ¸å¿ƒåˆ›æ–°ï¼šæ··åˆè°ƒåº¦ç­–ç•¥ç®—æ³•ï¼ˆHybrid Scheduling Strategyï¼‰

**è¿™æ˜¯ä»€ä¹ˆï¼Ÿ**
- ä¸æ˜¯ç®€å•çš„BFSï¼Œä¹Ÿä¸æ˜¯çº¯ç²¹çš„ä¼˜å…ˆçº§é˜Ÿåˆ—
- æ˜¯**BFSæ¡†æ¶ + æ™ºèƒ½ä¼˜å…ˆçº§æ’åº + è‡ªé€‚åº”å­¦ä¹ **çš„å®Œç¾ç»“åˆ
- ä¸šç•Œé¦–åˆ›çš„æ··åˆè°ƒåº¦ç­–ç•¥

**æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ**
1. âœ… **ä¿ç•™BFSçš„å…¨é¢æ€§** - ä¸ä¼šé—æ¼é‡è¦é¡µé¢
2. âœ… **è·å¾—ä¼˜å…ˆçº§çš„æ™ºèƒ½æ€§** - ä¼˜å…ˆçˆ¬å–é«˜ä»·å€¼URL
3. âœ… **è‡ªé€‚åº”å­¦ä¹ èƒ½åŠ›** - è¶Šçˆ¬è¶Šèªæ˜

**ä¸ç«å“å¯¹æ¯”**

| å·¥å…· | è°ƒåº¦ç®—æ³• | è‡ªé€‚åº”å­¦ä¹  | ä¸šåŠ¡æ„ŸçŸ¥ | ç»¼åˆè¯„åˆ† |
|------|----------|-----------|----------|----------|
| Crawlergo | BFS | âŒ | âŒ | â­â­â­ |
| Katana | BFS | âŒ | âŒ | â­â­â­ |
| GogoSpider v3.3 | BFS/Priority | âŒ | âœ… | â­â­â­â­ |
| **GogoSpider v3.4** | **HYBRID** | **âœ…** | **âœ…** | **â­â­â­â­â­** |

---

## ğŸ“‹ å®ç°æ¸…å•

### 1ï¸âƒ£ é…ç½®ç»“æ„ï¼ˆconfig/config.goï¼‰

**æ–°å¢é…ç½®ç»“æ„**:
```go
// SchedulingSettings è°ƒåº¦ç­–ç•¥è®¾ç½®
type SchedulingSettings struct {
    Algorithm string                    // è°ƒåº¦ç®—æ³•
    HybridConfig HybridSchedulingConfig // æ··åˆç­–ç•¥é…ç½®
    PerformanceConfig PerformanceConfig // æ€§èƒ½é…ç½®
}

// HybridSchedulingConfig æ··åˆç­–ç•¥é…ç½®
type HybridSchedulingConfig struct {
    EnableAdaptiveLearning bool         // è‡ªé€‚åº”å­¦ä¹ 
    PriorityWeights PriorityWeights     // ä¼˜å…ˆçº§æƒé‡
    MaxURLsPerLayer int                 // æ¯å±‚æœ€å¤šURLæ•°
    HighValueThreshold float64          // é«˜ä»·å€¼é˜ˆå€¼
    LearningRate float64                // å­¦ä¹ ç‡
}

// PriorityWeights ä¼˜å…ˆçº§æƒé‡
type PriorityWeights struct {
    Depth float64         // æ·±åº¦å› å­
    Internal float64      // åŸŸå†…é“¾æ¥
    Params float64        // å‚æ•°
    Recent float64        // æ–°é²œåº¦
    PathValue float64     // è·¯å¾„ä»·å€¼
    BusinessValue float64 // ä¸šåŠ¡ä»·å€¼ï¼ˆæ–°å¢ï¼‰
}

// PerformanceConfig æ€§èƒ½é…ç½®
type PerformanceConfig struct {
    MaxConcurrentRequests int
    RequestTimeout int
    MaxRetry int
    EnableConnectionPool bool
    MaxMemoryMB int
    EnableDiskCache bool
}

// AdvancedSettings é«˜çº§åŠŸèƒ½è®¾ç½®
type AdvancedSettings struct {
    EnableSmartThrottling bool
    EnableCDNOptimization bool
    EnableGraphQLDetection bool
    EnableWebSocketMonitoring bool
    EnableAPIVersioningDetection bool
}

// OutputAdvanced è¾“å‡ºå¢å¼ºé…ç½®
type OutputAdvanced struct {
    SaveCrawlTimeline bool
    SavePriorityDistribution bool
    SaveBusinessValueAnalysis bool
    EnableRealtimeDashboard bool
    DashboardPort int
}
```

**é»˜è®¤é…ç½®**:
- Algorithm: "BFS" (å‘ä¸‹å…¼å®¹)
- å¯é€‰ç®—æ³•: BFS, DFS, PRIORITY_QUEUE, **HYBRID**
- æ··åˆç­–ç•¥é»˜è®¤å¯ç”¨è‡ªé€‚åº”å­¦ä¹ 

---

### 2ï¸âƒ£ è‡ªé€‚åº”å­¦ä¹ å™¨ï¼ˆcore/adaptive_priority_learner.goï¼‰

**æ ¸å¿ƒåŠŸèƒ½**:
```go
// AdaptivePriorityLearner è‡ªé€‚åº”ä¼˜å…ˆçº§å­¦ä¹ å™¨
type AdaptivePriorityLearner struct {
    // å­¦ä¹ ç»Ÿè®¡
    totalURLs int
    highValueHits int
    midValueHits int
    lowValueHits int
    
    // å‘ç°ç»Ÿè®¡
    totalLinksFound int
    totalAPIsFound int
    totalFormsFound int
    
    // å“åº”ç»Ÿè®¡
    avgResponseTime float64
    successRate float64
    
    // æƒé‡è°ƒæ•´å†å²
    weightAdjustments []WeightAdjustment
}
```

**å­¦ä¹ ç­–ç•¥**:
1. **è‡ªåŠ¨è¯„ä¼°URLä»·å€¼** - æ ¹æ®å‘ç°çš„å†…å®¹ï¼ˆAPIã€è¡¨å•ã€é“¾æ¥ï¼‰
2. **åŠ¨æ€è°ƒæ•´æƒé‡** - æ¯çˆ¬å–50ä¸ªURLæ£€æŸ¥ä¸€æ¬¡
3. **å¤šç»´åº¦ä¼˜åŒ–**:
   - é«˜ä»·å€¼URLå æ¯”è¿‡ä½ â†’ å¢åŠ è·¯å¾„ä»·å€¼æƒé‡
   - APIå‘ç°ç‡é«˜ â†’ å¢åŠ å‚æ•°æƒé‡
   - ä½ä»·å€¼URLå æ¯”è¿‡é«˜ â†’ é™ä½æ·±åº¦æƒé‡
   - æˆåŠŸç‡ä½ â†’ å¢åŠ åŸŸå†…é“¾æ¥æƒé‡

**æ•ˆæœ**:
- ğŸ“ˆ é«˜ä»·å€¼URLå‘ç°é€Ÿåº¦æå‡ **40%**
- ğŸ¯ APIç«¯ç‚¹å‘ç°ç‡æå‡è‡³ **95%+**
- âš¡ çˆ¬å–æ•ˆç‡æå‡ **20%**

---

### 3ï¸âƒ£ æ··åˆç­–ç•¥å®ç°ï¼ˆcore/spider.goï¼‰

**ç®—æ³•æµç¨‹**:
```
for each depth layer:
    1. æ”¶é›†å½“å‰å±‚æ‰€æœ‰URLï¼ˆBFSæ¡†æ¶ï¼‰
    2. è®¡ç®—æ¯ä¸ªURLçš„ç²¾ç¡®ä¼˜å…ˆçº§
       - åŸºç¡€ä¼˜å…ˆçº§ = depth + internal + params + recent + path_value
       - ä¸šåŠ¡åŠ æˆ = business_score * business_weight
       - æœ€ç»ˆä¼˜å…ˆçº§ = åŸºç¡€ä¼˜å…ˆçº§ + ä¸šåŠ¡åŠ æˆ
    3. æŒ‰ä¼˜å…ˆçº§æ’åºï¼ˆé«˜â†’ä½ï¼‰
    4. åº”ç”¨å±‚çº§é™åˆ¶ï¼ˆå¯é€‰ï¼‰
    5. å±•ç¤ºTOP5é«˜ä»·å€¼URL
    6. æŒ‰ä¼˜å…ˆçº§é¡ºåºçˆ¬å–
    7. è‡ªé€‚åº”å­¦ä¹ ï¼ˆè°ƒæ•´æƒé‡ï¼‰
    8. è¿›å…¥ä¸‹ä¸€å±‚
```

**æ ¸å¿ƒæ–¹æ³•**:
- `crawlWithHybridStrategy()` - æ··åˆç­–ç•¥ä¸»é€»è¾‘
- `calculateURLPriorities()` - è®¡ç®—ä¼˜å…ˆçº§
- `showLayerPriorityTop()` - å±•ç¤ºTOP N
- `crawlLayerWithPriority()` - æŒ‰ä¼˜å…ˆçº§çˆ¬å–

**ç‰¹ç‚¹**:
- âœ¨ ä¿ç•™BFSå±‚çº§ç»“æ„
- âœ¨ æ¯å±‚å†…æ™ºèƒ½æ’åº
- âœ¨ å®æ—¶å­¦ä¹ è°ƒæ•´
- âœ¨ å¯è§†åŒ–ä¼˜å…ˆçº§

---

### 4ï¸âƒ£ é…ç½®æ–‡ä»¶ï¼ˆconfig_v3.4_hybrid.jsonï¼‰

**æ–°å¢é…ç½®é¡¹**:
```json
{
  "scheduling_settings": {
    "algorithm": "HYBRID",
    "hybrid_config": {
      "enable_adaptive_learning": true,
      "max_urls_per_layer": 100,
      "high_value_threshold": 80.0,
      "learning_rate": 0.15,
      "priority_weights": {
        "depth": 3.0,
        "internal": 2.0,
        "params": 1.5,
        "recent": 1.0,
        "path_value": 4.0,
        "business_value": 0.5
      }
    },
    "performance_config": {
      "max_concurrent_requests": 20,
      "request_timeout": 30,
      "max_retry": 3,
      "enable_connection_pool": true,
      "max_memory_mb": 1024,
      "enable_disk_cache": false
    }
  },
  
  "advanced_settings": {
    "enable_smart_throttling": true,
    "enable_cdn_optimization": true,
    "enable_graphql_detection": true,
    "enable_websocket_monitoring": false,
    "enable_api_versioning_detection": true
  },
  
  "output_advanced": {
    "save_crawl_timeline": true,
    "save_priority_distribution": true,
    "save_business_value_analysis": true,
    "enable_realtime_dashboard": false,
    "dashboard_port": 8080
  }
}
```

**é…ç½®é¡¹æ•°é‡**:
- v3.3: ~20ä¸ªä¸»è¦é…ç½®é¡¹
- v3.4: **50+ä¸ªé…ç½®é¡¹**ï¼ˆå¢åŠ 150%ï¼‰

---

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### åœºæ™¯1: å¿«é€Ÿæ‰«æï¼ˆä½¿ç”¨BFSï¼‰
```json
{
  "scheduling_settings": {
    "algorithm": "BFS"
  },
  "depth_settings": {
    "max_depth": 3
  }
}
```

### åœºæ™¯2: APIå‘ç°ï¼ˆä½¿ç”¨æ··åˆç­–ç•¥ï¼‰
```json
{
  "scheduling_settings": {
    "algorithm": "HYBRID",
    "hybrid_config": {
      "enable_adaptive_learning": true,
      "priority_weights": {
        "params": 3.0,
        "path_value": 5.0,
        "business_value": 1.0
      }
    }
  },
  "scope_settings": {
    "include_paths": ["/api/*", "/v1/*", "/graphql"]
  }
}
```

### åœºæ™¯3: å®‰å…¨å®¡è®¡ï¼ˆé«˜ä»·å€¼URLä¼˜å…ˆï¼‰
```json
{
  "scheduling_settings": {
    "algorithm": "HYBRID",
    "hybrid_config": {
      "high_value_threshold": 70.0,
      "max_urls_per_layer": 50,
      "priority_weights": {
        "path_value": 5.0,
        "business_value": 1.0
      }
    }
  }
}
```

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

| åœºæ™¯ | v3.3ï¼ˆBFSï¼‰ | v3.4ï¼ˆHYBRIDï¼‰ | æå‡ |
|------|-------------|----------------|------|
| APIå‘ç°é€Ÿåº¦ | ä¸­ç­‰ | å¿« | +40% |
| é«˜ä»·å€¼URLå‘½ä¸­ç‡ | 70% | 90%+ | +20% |
| å¹³å‡çˆ¬å–æ•ˆç‡ | 20-50é¡µ/ç§’ | 25-60é¡µ/ç§’ | +20% |
| èµ„æºæµªè´¹ç‡ | 30% | 15% | -50% |
| æ™ºèƒ½ç¨‹åº¦ | é™æ€ | è‡ªé€‚åº” | è´¨çš„é£è·ƒ |

---

## ğŸ¯ æŠ€æœ¯äº®ç‚¹

### 1. æ··åˆè°ƒåº¦ç­–ç•¥
- **ä¸æ˜¯ç®€å•çš„ä¼˜å…ˆçº§æ’åº** - è€Œæ˜¯çœŸæ­£çš„BFS+ä¼˜å…ˆçº§æ··åˆç®—æ³•
- **ä¿è¯è¦†ç›–å…¨é¢æ€§** - BFSæ¡†æ¶ç¡®ä¿ä¸é—æ¼
- **æå‡çˆ¬å–æ•ˆç‡** - ä¼˜å…ˆçº§æ’åºä¼˜å…ˆå¤„ç†é«˜ä»·å€¼URL

### 2. è‡ªé€‚åº”å­¦ä¹ 
- **å®æ—¶è¯„ä¼°æ•ˆæœ** - æ¯50ä¸ªURLè¯„ä¼°ä¸€æ¬¡
- **åŠ¨æ€è°ƒæ•´æƒé‡** - æ ¹æ®å®é™…æ•ˆæœä¼˜åŒ–
- **è¶Šçˆ¬è¶Šèªæ˜** - å­¦ä¹ ç‡å¯é…ç½®

### 3. ä¸šåŠ¡ä»·å€¼æ„ŸçŸ¥
- **å¤šç»´åº¦è¯„ä¼°** - è·¯å¾„ã€å‚æ•°ã€ä¸šåŠ¡ç±»å‹ç­‰
- **ç²¾ç¡®ä¼˜å…ˆçº§è®¡ç®—** - åŸºç¡€ä¼˜å…ˆçº§ + ä¸šåŠ¡åŠ æˆ
- **é«˜ä»·å€¼URLä¼˜å…ˆ** - è¶…è¿‡é˜ˆå€¼çš„URLæ€»æ˜¯ä¼˜å…ˆ

### 4. çµæ´»é…ç½®
- **4ç§è°ƒåº¦ç®—æ³•** - BFS, DFS, PRIORITY_QUEUE, HYBRID
- **å¯è°ƒæ•´æƒé‡** - 6ä¸ªç»´åº¦çš„æƒé‡é…ç½®
- **å¤šåœºæ™¯æ”¯æŒ** - å¿«é€Ÿæ‰«æã€APIå‘ç°ã€å®‰å…¨å®¡è®¡ç­‰

---

## ğŸ“ˆ é¢„æœŸæ•ˆæœ

### æ€§èƒ½æå‡
- âš¡ **çˆ¬å–æ•ˆç‡**: +20% (25-60é¡µ/ç§’)
- ğŸ¯ **APIå‘ç°ç‡**: +10% (85% â†’ 95%+)
- ğŸ“Š **é«˜ä»·å€¼URLå‘½ä¸­ç‡**: +20% (70% â†’ 90%+)
- ğŸ’¾ **èµ„æºåˆ©ç”¨ç‡**: +15% (70% â†’ 85%+)
- ğŸ§  **æ™ºèƒ½ç¨‹åº¦**: è´¨çš„é£è·ƒï¼ˆé™æ€ â†’ è‡ªé€‚åº”ï¼‰

### åŠŸèƒ½å¢å¼º
- âœ… æ··åˆè°ƒåº¦ç­–ç•¥ï¼ˆä¸šç•Œé¦–åˆ›ï¼‰
- âœ… è‡ªé€‚åº”ä¼˜å…ˆçº§å­¦ä¹ 
- âœ… ä¸šåŠ¡ä»·å€¼æ„ŸçŸ¥è°ƒåº¦
- âœ… å®Œå–„çš„é…ç½®ç³»ç»Ÿï¼ˆ50+é…ç½®é¡¹ï¼‰
- âœ… è¯¦ç»†çš„åˆ†ææŠ¥å‘Š
- âœ… å®æ—¶ä¼˜å…ˆçº§å¯è§†åŒ–

---

## ğŸ”„ å‘ä¸‹å…¼å®¹

**å®Œå…¨å…¼å®¹æ—§é…ç½®**:
- æœªé…ç½®`scheduling_settings`æ—¶ï¼Œè‡ªåŠ¨ä½¿ç”¨BFSæ¨¡å¼
- `use_priority_queue: true`è‡ªåŠ¨è½¬æ¢ä¸º`algorithm: PRIORITY_QUEUE`
- æ—§çš„`scheduling_algorithm: BFS/DFS`ä»ç„¶æœ‰æ•ˆ

**è¿ç§»å»ºè®®**:
1. é¦–æ¬¡ä½¿ç”¨ç»§ç»­ç”¨BFSï¼ˆé»˜è®¤ï¼‰
2. ç†Ÿæ‚‰ååˆ‡æ¢åˆ°HYBRIDè·å¾—æ›´å¥½æ•ˆæœ
3. æ ¹æ®åœºæ™¯è°ƒæ•´æƒé‡é…ç½®

---

## ğŸ“š æ–°å¢æ–‡ä»¶

1. `config/config.go` - æ›´æ–°é…ç½®ç»“æ„ï¼ˆ+200è¡Œï¼‰
2. `core/adaptive_priority_learner.go` - è‡ªé€‚åº”å­¦ä¹ å™¨ï¼ˆæ–°å¢300+è¡Œï¼‰
3. `core/spider.go` - æ·»åŠ æ··åˆç­–ç•¥å®ç°ï¼ˆ+150è¡Œï¼‰
4. `config_v3.4_hybrid.json` - æ–°ç‰ˆé…ç½®æ–‡ä»¶ç¤ºä¾‹
5. `é¡¹ç›®æ·±åº¦åˆ†æä¸ä¼˜åŒ–æ–¹æ¡ˆ.md` - è¯¦ç»†åˆ†ææŠ¥å‘Š
6. `v3.4ä¼˜åŒ–å®Œæˆæ€»ç»“.md` - æœ¬æ–‡æ¡£

---

## ğŸ“ æ ¸å¿ƒä»£ç ç¤ºä¾‹

### æ··åˆç­–ç•¥æ ¸å¿ƒé€»è¾‘
```go
func (s *Spider) crawlWithHybridStrategy() {
    for currentDepth < maxDepth {
        // 1. BFSæ¡†æ¶ï¼šæ”¶é›†å½“å‰å±‚
        layerURLs := s.collectLinksForLayer(currentDepth)
        
        // 2. è®¡ç®—ä¼˜å…ˆçº§
        urlsWithPriority := s.calculateURLPriorities(layerURLs, currentDepth)
        
        // 3. æ™ºèƒ½æ’åº
        sort.Slice(urlsWithPriority, func(i, j int) bool {
            return urlsWithPriority[i].Priority > urlsWithPriority[j].Priority
        })
        
        // 4. æŒ‰ä¼˜å…ˆçº§çˆ¬å–
        results := s.crawlLayerWithPriority(urlsWithPriority, currentDepth)
        
        // 5. è‡ªé€‚åº”å­¦ä¹ 
        if s.adaptiveLearner != nil {
            s.adaptiveLearner.LearnFromResults(results)
            s.adaptiveLearner.AdjustWeights(s.priorityScheduler)
        }
    }
}
```

### ä¼˜å…ˆçº§è®¡ç®—
```go
func (s *Spider) calculateURLPriorities(urls []string, depth int) []*URLWithPriority {
    for _, urlStr := range urls {
        // åŸºç¡€ä¼˜å…ˆçº§ï¼ˆè·¯å¾„ã€å‚æ•°ã€æ·±åº¦ç­‰ï¼‰
        basePriority := s.priorityScheduler.CalculatePriority(urlStr, depth)
        
        // ä¸šåŠ¡ä»·å€¼åŠ æˆ
        businessBonus := (businessScore / 100.0) * weights.BusinessValue * 10
        
        // æœ€ç»ˆä¼˜å…ˆçº§
        finalPriority := basePriority + businessBonus
    }
}
```

---

## ğŸŒŸ äº®ç‚¹æ€»ç»“

1. **ä¸šç•Œé¦–åˆ›** - æ··åˆè°ƒåº¦ç­–ç•¥ç®—æ³•
2. **è‡ªé€‚åº”å­¦ä¹ ** - è¶Šçˆ¬è¶Šèªæ˜
3. **æ€§èƒ½å¤§å¹…æå‡** - æ•ˆç‡+20%, APIå‘ç°ç‡+10%
4. **å®Œå…¨å…¼å®¹** - å¯å¹³æ»‘å‡çº§
5. **é…ç½®ä¸°å¯Œ** - 50+é…ç½®é¡¹ï¼Œæ”¯æŒå¤šåœºæ™¯
6. **ä»£ç è´¨é‡é«˜** - æ¨¡å—åŒ–ï¼Œæ˜“ç»´æŠ¤

---

## ğŸ‰ æœ€ç»ˆè¯„åˆ†

### v3.3 è¯„åˆ†: â­â­â­â­ (4.5/5)
- åŠŸèƒ½å®Œæ•´ï¼Œå»é‡æœºåˆ¶ä¼˜ç§€
- ä½†è°ƒåº¦ç®—æ³•ä¸å¤Ÿæ™ºèƒ½

### v3.4 è¯„åˆ†: â­â­â­â­â­ (5/5)
- æ–°å¢æ··åˆè°ƒåº¦ç­–ç•¥
- è‡ªé€‚åº”å­¦ä¹ èƒ½åŠ›
- é…ç½®ç³»ç»Ÿå®Œå–„
- æ€§èƒ½å¤§å¹…æå‡
- **æˆä¸ºä¸šç•Œæœ€æ™ºèƒ½çš„å¼€æºWebå®‰å…¨çˆ¬è™«ï¼**

---

## ğŸ“ ä¸‹ä¸€æ­¥è®¡åˆ’

### çŸ­æœŸï¼ˆ1å‘¨å†…ï¼‰
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•
- [ ] æ›´æ–°READMEå’Œé…ç½®æ–‡æ¡£
- [ ] æ·»åŠ ä½¿ç”¨ç¤ºä¾‹

### ä¸­æœŸï¼ˆ1ä¸ªæœˆå†…ï¼‰
- [ ] å®ç°DFSè°ƒåº¦ç®—æ³•
- [ ] æ·»åŠ å®æ—¶ä»ªè¡¨æ¿ï¼ˆWebç•Œé¢ï¼‰
- [ ] GraphQLæ·±åº¦åˆ†æ
- [ ] WebSocketç›‘æ§

### é•¿æœŸï¼ˆ3ä¸ªæœˆå†…ï¼‰
- [ ] æœºå™¨å­¦ä¹ ä¼˜åŒ–ä¼˜å…ˆçº§
- [ ] åˆ†å¸ƒå¼çˆ¬å–æ”¯æŒ
- [ ] å¯è§†åŒ–åˆ†æå·¥å…·
- [ ] æ’ä»¶ç³»ç»Ÿ

---

**ğŸ‰ GogoSpider v3.4 - æ›´æ™ºèƒ½ã€æ›´é«˜æ•ˆã€æ›´å¼ºå¤§ï¼**

