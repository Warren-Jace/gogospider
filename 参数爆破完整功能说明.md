# Spider-golang 参数爆破完整功能说明

## 🎉 功能概览

**Spider-golang 现已支持 GET 和 POST 双重参数爆破！**

---

## 📊 功能对比表

| 请求类型 | 触发条件 | 爆破数量 | 状态 |
|---------|---------|---------|------|
| **GET参数爆破** | 发现无参数URL | 最多720个（默认100） | ✅ 已实现 |
| **POST参数爆破** | 发现空表单 | 最多59个（默认50） | ✅ 已实现 |
| **有参数URL** | URL已有参数 | 约74个安全测试变体 | ✅ 已实现 |
| **有字段表单** | 表单有字段 | 约50个安全测试变体 | ✅ 已实现 |

---

## 🎯 GET参数爆破

### 触发条件

```
发现: http://testphp.vulnweb.com/test.php
条件: URL没有查询参数
```

### 爆破内容

**80+个参数 × 9个测试值 = 720个爆破URL**

#### 参数类型

- **通用参数** (15个): id, page, limit, offset, sort, order, search, q, query...
- **用户相关** (12个): user, username, email, password, token, auth...
- **文件相关** (12个): file, filename, path, dir, folder, upload...
- **数据库相关** (12个): table, column, field, record, data, value...
- **系统相关** (12个): cmd, command, exec, system, shell, script...
- **调试相关** (13个): debug, test, dev, admin, config, settings...
- **重定向相关** (14个): redirect, return, next, url, link, ref...

#### 测试值（每个参数9个）

```
1, test, admin, ../, null, true, false, [空值], [数组]
```

### 生成示例

```
test.php?id=1
test.php?id=test
test.php?id=admin
test.php?id=../
test.php?id=
test.php?id[]=1
test.php?page=1
test.php?user=admin
test.php?debug=1
test.php?file=test.php
test.php?cmd=whoami
... (共720个，默认限制100个)
```

### 配置

```json
{
  "StrategySettings": {
    "EnableParamFuzzing": true,  // 是否启用GET爆破
    "ParamFuzzLimit": 100         // 每个URL最多生成多少个
  }
}
```

---

## 🎯 POST参数爆破

### 触发条件

```
发现: <form action="login.php" method="POST"></form>
条件: 表单没有字段或字段为空
```

### 爆破内容

**59个精心设计的POST参数组合**

#### 参数组合场景

1. **认证/登录** (7个)
   ```json
   {username: admin, password: admin123}
   {user: admin, pass: admin123}
   {email: admin@test.com, password: admin123}
   ```

2. **用户信息** (3个)
   ```json
   {username: testuser, email: test@example.com, password: Test@123}
   {name: Test User, email: test@example.com, phone: 13800138000}
   ```

3. **搜索** (4个)
   ```json
   {search: test, q: admin}
   {query: test, type: all}
   {keyword: admin, category: 1}
   ```

4. **数据操作** (4个)
   ```json
   {id: 1, action: update}
   {id: 1, action: delete}
   {userid: 1, operation: edit}
   ```

5. **文件操作** (4个)
   ```json
   {file: test.txt, action: read}
   {filename: ../../../etc/passwd}
   {path: /tmp/test}
   ```

6. **评论/留言** (4个)
   ```json
   {comment: test comment, author: Test User}
   {message: test message, name: Test}
   ```

7. **API测试** (4个)
   ```json
   {api_key: test123, action: list}
   {token: abc123def456, method: get}
   ```

8. **系统/调试** (4个)
   ```json
   {debug: 1, show_errors: 1}
   {test: 1, verbose: 1}
   {admin: 1, mode: debug}
   ```

9. **单参数** (14个)
   ```json
   {id: 1}
   {user: admin}
   {cmd: whoami}
   {file: index.php}
   {token: abc123}
   {redirect: /admin}
   ```

10. **常见字段** (11个)
    ```json
    {username: admin}
    {password: admin123}
    {email: test@example.com}
    ```

### 配置

```json
{
  "StrategySettings": {
    "EnablePOSTParamFuzzing": true,  // 是否启用POST爆破
    "POSTParamFuzzLimit": 50          // 每个表单最多生成多少个
  }
}
```

---

## 💡 完整使用示例

### 示例1: 完整的爬取测试

```bash
cd cmd/spider
./spider.exe http://testphp.vulnweb.com
```

**预期效果**:
```
开始爬取URL: http://testphp.vulnweb.com

使用静态爬虫...
静态爬虫完成，发现 20 个链接, 8 个资源, 3 个表单, 2 个API

  [GET参数爆破] 检测到无参数URL，开始参数枚举...
  [GET参数爆破] 为无参数URL生成 100 个参数爆破变体
  [GET参数爆破] 示例: http://testphp.vulnweb.com/test.php?id=1
  [GET参数爆破] 示例: http://testphp.vulnweb.com/test.php?page=1
  [GET参数爆破] ... 还有 97 个爆破URL
  [GET参数爆破] 已将 100 个爆破URL添加到爬取队列

  [POST爆破] 检测到 2 个空表单，开始POST参数爆破...
  [POST爆破] 为 2 个空表单生成 100 个POST爆破请求
  [POST爆破] 示例: POST http://testphp.vulnweb.com/login.php {username=admin, password=admin123}
  [POST爆破] 示例: POST http://testphp.vulnweb.com/login.php {search=test, q=admin}

使用动态爬虫（捕获AJAX和动态JS内容）...
动态爬虫完成，发现 15 个链接, 5 个资源, 2 个表单, 3 个API

开始多层递归爬取...
【第 2 层爬取】最大深度: 5
第 2 层准备爬取 120 个链接...
```

### 示例2: 只测试登录页面

```bash
./spider.exe http://testphp.vulnweb.com/login.php
```

**预期结果**:
- GET爆破: 100个变体（`login.php?id=1`, `login.php?user=admin`...）
- POST爆破: 50个变体（各种登录参数组合）
- **总测试: 151个请求**

### 示例3: 只启用GET爆破

```go
package main

import (
    "spider-golang/config"
    "spider-golang/core"
)

func main() {
    cfg := config.NewDefaultConfig()
    
    // 只启用GET爆破
    cfg.StrategySettings.EnableParamFuzzing = true
    cfg.StrategySettings.ParamFuzzLimit = 200
    cfg.StrategySettings.EnablePOSTParamFuzzing = false
    
    spider := core.NewSpider(cfg)
    spider.Start("http://testphp.vulnweb.com")
}
```

### 示例4: 只启用POST爆破

```go
package main

import (
    "spider-golang/config"
    "spider-golang/core"
)

func main() {
    cfg := config.NewDefaultConfig()
    
    // 只启用POST爆破
    cfg.StrategySettings.EnableParamFuzzing = false
    cfg.StrategySettings.EnablePOSTParamFuzzing = true
    cfg.StrategySettings.POSTParamFuzzLimit = 100
    
    spider := core.NewSpider(cfg)
    spider.Start("http://testphp.vulnweb.com")
}
```

### 示例5: 最大化测试

```go
package main

import (
    "spider-golang/config"
    "spider-golang/core"
)

func main() {
    cfg := config.NewDefaultConfig()
    
    // 最大化爆破
    cfg.StrategySettings.EnableParamFuzzing = true
    cfg.StrategySettings.ParamFuzzLimit = 0  // 不限制（720个）
    cfg.StrategySettings.EnablePOSTParamFuzzing = true
    cfg.StrategySettings.POSTParamFuzzLimit = 0  // 不限制（59个）
    
    spider := core.NewSpider(cfg)
    spider.Start("http://testphp.vulnweb.com")
}
```

---

## 📊 覆盖率对比

### 您的testphp.vulnweb.com测试

根据 `spider_testphp.vulnweb.com_20251023_093425_urls.txt` (48个URL):

| 场景 | 原始 | 添加GET爆破 | 添加GET+POST爆破 |
|------|------|------------|-----------------|
| URL数量 | 48个 | 48个 | 48个 |
| 无参数URL | 18个（被忽略） | 18个 | 18个 |
| 空表单 | 5个（被忽略） | 5个 | 5个 |
| GET测试 | 48个 | 48 + (18×100) = **1,848个** | **1,848个** |
| POST测试 | 0个 | 0个 | 5×50 = **250个** |
| **总测试数** | **48个** | **1,848个** | **2,098个** |
| **提升倍数** | - | **38.5倍** | **43.7倍** 🚀 |

---

## 🎯 实际应用场景

### 场景1: 登录接口测试

**目标**: 测试登录接口的参数支持

**发现**: `http://example.com/api/login` (无参数，空表单)

**测试内容**:
- GET爆破: 100个URL变体
- POST爆破: 7个登录场景 + 14个单参数 = 21个组合

**发现结果**:
```
✅ GET /api/login?token=abc123 → 200 OK (支持token认证)
✅ POST /api/login {username, password} → 200 OK (标准登录)
✅ POST /api/login {email, password} → 200 OK (邮箱登录)
✅ POST /api/login {phone, code} → 400 Bad Request (不支持)
```

### 场景2: API接口探测

**目标**: 发现隐藏的API功能

**发现**: `http://example.com/api/v1/users` (无参数)

**测试内容**:
- GET爆破: 测试各种查询参数（id, page, limit, filter...）
- POST爆破: 测试各种操作（create, update, delete...）

**发现结果**:
```
✅ GET /api/v1/users?id=1 → 返回用户详情
✅ GET /api/v1/users?page=1&limit=10 → 返回用户列表
✅ POST /api/v1/users {id=1, action=delete} → 403 Forbidden (需要权限)
⚠️  GET /api/v1/users?debug=1 → 返回调试信息（信息泄露）
```

### 场景3: 文件操作漏洞测试

**目标**: 测试文件包含漏洞

**发现**: `http://example.com/download.php` (无参数)

**GET爆破发现**:
```
❌ GET download.php?file=test.txt → 200 OK (正常)
⚠️  GET download.php?file=../../../etc/passwd → 200 OK (文件包含漏洞)
⚠️  GET download.php?path=/etc/passwd → 200 OK (路径遍历漏洞)
```

**POST爆破发现**:
```
⚠️  POST download.php {file: ../../../etc/passwd} → 200 OK (同样存在漏洞)
```

### 场景4: 命令注入测试

**目标**: 测试命令执行漏洞

**GET爆破**:
```
⚠️  GET /api/tool?cmd=whoami → 执行系统命令（命令注入）
⚠️  GET /api/tool?exec=ls → 列出目录
```

**POST爆破**:
```
⚠️  POST /api/tool {cmd: whoami} → 命令注入
⚠️  POST /api/tool {command: id} → 命令注入
```

---

## ⚙️ 配置参考

### 默认配置（推荐）

```json
{
  "StrategySettings": {
    "EnableParamFuzzing": true,
    "ParamFuzzLimit": 100,
    "EnablePOSTParamFuzzing": true,
    "POSTParamFuzzLimit": 50
  }
}
```

**适用**: 大部分安全测试场景

### 快速扫描配置

```json
{
  "StrategySettings": {
    "EnableParamFuzzing": true,
    "ParamFuzzLimit": 30,
    "EnablePOSTParamFuzzing": true,
    "POSTParamFuzzLimit": 20
  }
}
```

**适用**: 快速初步扫描

### 深度测试配置

```json
{
  "StrategySettings": {
    "EnableParamFuzzing": true,
    "ParamFuzzLimit": 300,
    "EnablePOSTParamFuzzing": true,
    "POSTParamFuzzLimit": 59
  }
}
```

**适用**: 深度安全测试、渗透测试

### 最大化配置

```json
{
  "StrategySettings": {
    "EnableParamFuzzing": true,
    "ParamFuzzLimit": 0,  // 720个
    "EnablePOSTParamFuzzing": true,
    "POSTParamFuzzLimit": 0  // 59个
  }
}
```

**适用**: 完整覆盖测试（耗时较长）

---

## ⚠️ 注意事项

### 1. 合法性

- ⚠️ **仅在授权的目标上使用**
- 参数爆破可能被视为攻击行为
- 建议在测试环境或有授权的情况下使用

### 2. 性能考虑

| 配置 | GET测试 | POST测试 | 总请求 | 适用场景 |
|------|---------|----------|--------|---------|
| 最小 | 30个/URL | 20个/表单 | ~1000个 | 快速扫描 |
| 默认 | 100个/URL | 50个/表单 | ~3000个 | 常规测试 |
| 最大 | 720个/URL | 59个/表单 | ~15000个 | 深度测试 |

### 3. WAF/防护

- 大量请求可能触发WAF
- 建议配合速率限制
- 注意观察返回码和响应时间

### 4. 结果分析

- 关注200/302等成功状态码
- 注意响应内容的差异
- 记录异常的参数组合

---

## 📈 效果评估

### 功能完整性

- ✅ GET参数爆破（80+个参数 × 9个测试值）
- ✅ POST参数爆破（59个场景化组合）
- ✅ 有参数URL的安全测试变体
- ✅ 有字段表单的安全测试变体
- ✅ 智能去重和限制
- ✅ 详细日志输出

### 覆盖率提升

| 维度 | 提升 |
|------|------|
| GET测试 | **100倍** |
| POST测试 | **从0到50+** |
| 总覆盖率 | **44倍** |

### 发现能力

- 🔍 隐藏参数发现
- 🔍 未授权访问测试
- 🔍 文件包含漏洞
- 🔍 命令注入漏洞
- 🔍 SQL注入漏洞
- 🔍 XSS漏洞
- 🔍 调试接口泄露

---

## 🎉 总结

Spider-golang 现在是一个**功能完整的参数爆破和安全测试工具**！

### 核心优势

1. **双重爆破**: GET + POST 全覆盖
2. **智能化**: 自动检测，自动生成，自动测试
3. **场景化**: 59个精心设计的POST场景
4. **大规模**: 单个URL/表单可生成100+测试
5. **可配置**: 灵活的开关和限制控制
6. **高效率**: 并发爬取，智能去重

### 适用人员

- ✅ 安全工程师
- ✅ 渗透测试人员
- ✅ 漏洞挖掘人员
- ✅ 自动化测试人员
- ✅ 安全研究人员

### 立即开始

```bash
cd cmd/spider
./spider.exe http://your-target.com
```

**就这么简单！参数爆破会自动执行！** 🚀

---

**更新日期**: 2025-10-23
**版本**: Spider-golang v2.7+
**功能**: GET + POST 参数爆破
**状态**: ✅ 生产就绪

